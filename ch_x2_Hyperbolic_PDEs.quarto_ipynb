{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "---\n",
        "jupyter: python3\n",
        "---\n",
        "\n",
        "# Hyperbolic Partial Differential Equations {#sec-x2}\n",
        "\n",
        "## The One-dimensional Wave Equation {#sec-x2-18}\n",
        "\n",
        "We will now begin to study the second major class of PDEs, $\\,$<font color=\"red\">**hyperbolic equations**</font>\n",
        "\n",
        "* **Vibrating-String Problem**\n",
        "\n",
        "  We consider the small vibrations of a string that is fastened at each end\n",
        "\n",
        "  ![](figures/pde02_figure01.jpg \"vibrating string\"){width=\"80%\" fig-align=\"center\"}\n",
        "\n",
        "* To mathematically describe the vibrations of this string, $\\,$we consider all the forces acting on a small section $\\Delta x$ of the string \n",
        "\n",
        "  ![](figures/pde02_figure02.jpg \"Small Segment of Vibrating String\"){width=\"70%\" fig-align=\"center\"}\n",
        "\n",
        "  If the horizontal component of tension is constant $T$, $\\,$then the tension acting on each side of the string segment is given by\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    T_1 \\cos\\alpha &\\approx T \\\\ \n",
        "    T_2 \\cos\\beta &\\approx T\n",
        "  \\end{aligned}$$\n",
        "\n",
        "* In the vertical component of Newton's second law, $\\,$the mass of this piece $\\,\\rho\\Delta x\\,$ times its acceleration $\\,u_{tt}$ will be equal to the net force on the piece:\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "   \\rho\\Delta x u_{tt} &= T_2 \\sin\\beta +T_1 \\sin\\alpha \\\\ \n",
        "   &\\Downarrow \\\\ \n",
        "   \\frac{\\rho\\Delta x}{T} u_{tt} &= \\frac{T_2 \\sin\\beta}{T_2 \\cos\\beta} \n",
        "     +\\frac{T_1 \\sin\\alpha}{T_1 \\cos\\alpha} = \\tan\\beta +\\tan\\alpha \\\\ \n",
        "   &= u_x(x+\\Delta x) -u_x(x) \\\\\n",
        "   &\\Downarrow \\\\\n",
        "   u_{tt} &=\\frac{T}{\\rho} \\frac{u_x(x+\\Delta x) -u_x(x)}{\\Delta x} \\\\\n",
        "   &\\Downarrow\\; c^2 = T/\\rho,\\;\\Delta x \\to 0 \\\\\n",
        "   u_{tt} &= c^2 u_{xx}\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  This is the <font color=\"blue\">wave equation</font> for $\\,u(x,t)\\,$ and <font color=\"green\">$\\,c$ is the speed of propagation of the wave</font> in the string\n",
        "\n",
        "## $\\,$D'Alembert Solution of the Wave Equation {#sec-x2-19}\n",
        "\n",
        "* If the student recalls the parabolic case, $\\,$we started  solving diffusion problems when the space variable was bounded (by separation of variables), $\\,$and then went on to solve the unbounded case (where <font color=\"red\">$-\\infty < x <\\infty$</font>) by the Fourier transform\n",
        "\n",
        "* In the hyperbolic case (wave equation), $\\,$we will do the opposite. $\\,$We start by solving the one-dimensional wave equation in free space:\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "  u_{tt} &=c^2 u_{xx} && -\\infty < x < \\infty,\\; 0 < t < \\infty \\\\ \n",
        "  \\begin{array}{r}\n",
        "    u(x, 0) \\\\\n",
        "    u_t(x, 0)\n",
        "  \\end{array} \n",
        "   &\n",
        "  \\begin{array}{c}\n",
        "    = f(x) \\\\\n",
        "    = g(x)\n",
        "  \\end{array} && -\\infty < x <\\infty \n",
        "\\end{aligned} \\tag{DA}\\label{eq:DA}$$ \n",
        "\n",
        "* We could solve this problem by using the Fourier transform (transforming $x$) or the Laplace transform (transforming $t$), $\\,$but we will introduce yet a new technique (<font color=\"red\">canonical coordinate</font>), $\\,$which will introduce the reader to several new and exciting ideas\n",
        "\n",
        "**STEP 1** $\\,$Replacing $\\,(x,t)$ by new canonical coordinates $(\\xi,\\eta)$\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u_{tt}&=c^2 u_{xx} \\\\ \n",
        " &\\Downarrow\\;\\color{red}{\\xi=x+ct,\\;\\eta=x-ct} \\\\ \n",
        " u_t&= u_\\xi \\xi_t+u_\\eta \\eta_t =c(u_\\xi -u_\\eta) \\\\\n",
        " u_{tt}&= c(u_{\\xi\\xi} -u_{\\eta\\xi})\\xi_t +c(u_{\\xi\\eta} -u_{\\eta\\eta})\\eta_t\\\\\n",
        " &=c^2(u_{\\xi\\xi}-2u_{\\xi\\eta}+u_{\\eta\\eta})\\\\\n",
        " u_x&=u_\\xi \\xi_x+u_\\eta \\eta_x=u_\\xi+u_\\eta \\\\ \n",
        " u_{xx}&= u_{\\xi\\xi}\\xi_x+u_{\\eta\\xi}\\xi_x+u_{\\xi\\eta}\\eta_x +u_{\\eta\\eta}\\eta_x\\\\\n",
        " &=u_{\\xi\\xi}+2u_{\\xi\\eta}+u_{\\eta\\eta}\\\\\n",
        " &\\Downarrow \\\\\n",
        " u_{\\xi\\eta}&=0\n",
        "\\end{aligned}$$\n",
        "\n",
        "**STEP 2** $\\,$Solving the Transformed Equations\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u_{\\xi\\eta}&= 0 \\\\ \n",
        " &\\Downarrow \\\\\n",
        " \\text{Integration } &\\text{with respect to }\\xi \\\\ \n",
        " &\\Downarrow \\\\\n",
        " u_{\\eta}(\\xi,\\eta)&=\\varphi(\\eta) \\\\\n",
        " &\\Downarrow \\\\\n",
        " \\text{Integration } &\\text{with respect to }\\eta \\\\ \n",
        " &\\Downarrow \\;\\;\\phi=\\int\\varphi\\,d\\eta \\\\\n",
        " u(\\xi,\\eta)=\\phi&(\\eta) +\\psi(\\xi) \\\\\n",
        "\\end{aligned}$$\n",
        "\n",
        "**STEP 3** $\\,$Transforming back to the Original Coordinates $\\,x\\,$ and $\\,t$\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u(\\xi,\\eta)&=\\phi(\\eta) +\\psi(\\xi) \\\\\n",
        " &\\Downarrow\\; \\xi=x+ct, \\;\\eta=x-ct \\\\\n",
        " u(x,t)=\\phi&(x-ct) +\\psi(x+ct)\n",
        "\\end{aligned}$$\n",
        "\n",
        "**NOTE** $\\,$This is the general solution of the wave equation, $\\,$and it is interesting in that it physically represents the sum of any two moving waves, $\\,$each moving in opposite directions with velocity $\\,c$\n",
        "\n",
        "**STEP 4** $\\,$Substituting the General Solution into the ICs\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u(x,t)=\\phi(x-&ct) +\\psi(x+ct) \\\\\n",
        " &\\Downarrow \\;\\scriptsize u(x,0)=f(x), \\;u_t(x,0)=g(x) \\\\\n",
        " \\scriptsize\\phi(x) +\\psi(x) \\; & \\scriptsize = f(x)\\\\\n",
        " \\scriptsize-c\\phi_x(x) +c\\psi_x(x) \\; &\\scriptsize = g(x) \\\\\n",
        " \\big\\Downarrow \\;&{\\scriptstyle \\text{integrating the 2}^{nd} \\text{equation} \\text{  from } x_0 \\text{ to } x} \\\\\n",
        " \\scriptsize\\phi(x) +\\psi(x) = &\\scriptsize \\, f(x)\\\\\n",
        " \\scriptsize-c\\phi(x) +c\\psi(x) = &\\scriptsize \\, \\int_{x_0}^x g(\\alpha)\\,d\\alpha +C \\\\\n",
        " &\\Downarrow \\\\\n",
        " \\scriptsize\\phi(x)=\\frac{1}{2}f(x) -\\,& \\scriptsize\\frac{1}{2c}\\int_{x_0}^x g(\\alpha)\\,d\\alpha -\\frac{C}{2c} \\\\\n",
        " \\scriptsize\\psi(x)=\\frac{1}{2}f(x) +\\,& \\scriptsize\\frac{1}{2c}\\int_{x_0}^x g(\\alpha)\\,d\\alpha +\\frac{C}{2c} \\\\\n",
        "   &\\Downarrow \\\\\n",
        "\\end{aligned}$$\n",
        "\n",
        "$$\\color{red}{\\begin{aligned}\n",
        " u(x,t) =\\frac{1}{2} \\left[ f(x -ct)\\right. &+ \\left. f(x +ct) \\right] \n",
        "   +\\frac{1}{2c} \\int_{x-ct}^{x+ct} g(\\alpha)\\,d\\alpha\n",
        "\\end{aligned}}\\tag{DAS}\\label{eq:DAS}$$ \n",
        "\n",
        "This is what we were aiming for, $\\,$and it is called the **D'Alembert solution** to \\eqref{eq:DA}\n",
        "\n",
        "* **Motion of a Simple Square Wave**\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    u(x,0)&=\n",
        "    \\begin{cases}\n",
        "      1 & \\;-1 < x < 1 \\\\ \n",
        "      0 & \\text{everywhere else}  \n",
        "    \\end{cases} \\\\ \n",
        "    u_t(x,0)&=0 \n",
        "  \\end{aligned}$$ \n",
        "\n",
        "  ![](figures/pde02_figure03.jpg \"Initial Wave Decomposed into Two Traveling Waves\"){width=\"60%\" fig-align=\"center\"}\n",
        "\n",
        "* **Initial Velocity Given**\n",
        "\n",
        "  Suppose now the initial position of the string is at equilibrium and we impose an initial velocity (as in a piano string) of $\\,\\sin x$\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "   u(x,0)&= 0\\\\ \n",
        "   u_t(x,0)&=\\sin x \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  Here, $\\,$the solution would be\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "   u(x,t) &= \\frac{1}{2c} \\int_{x-ct}^{x+ct} \\sin\\xi \\, d\\xi\\\\ \n",
        "    &=\\frac{1}{2c} \\left[ \\cos(x -ct) -\\cos(x +ct)\\right] \\\\\n",
        "    &=\\frac{1}{c} \\sin x \\cdot \\sin ct\n",
        "  \\end{aligned}$$\n",
        "\n",
        "$~$"
      ],
      "id": "1b3bb25c"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "import numpy as np\n",
        "import matplotlib.pyplot as plt\n",
        "from matplotlib import animation, rc\n",
        "from IPython.display import HTML\n",
        "\n",
        "plt.rcParams['font.size'] = 12\n",
        "plt.rcParams['xtick.direction'] = 'in'\n",
        "plt.rcParams['ytick.direction'] = 'in'"
      ],
      "id": "ee0654e1",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "fig = plt.figure(figsize=(6, 4))\n",
        "ax = plt.axes(xlim=(-6.0*np.pi, 6.0*np.pi), ylim=(-1.5, 1.5))\n",
        "\n",
        "ax.set_xticks([-6.0*np.pi,-3.0*np.pi, 0, 3.0*np.pi, 6.0*np.pi])\n",
        "ax.set_xticklabels([r'$-6\\pi$',r'$-3\\pi$','$0$',r'$3\\pi$',r'$6\\pi$'])\n",
        "ax.set_yticks([-1.2, -0.6, 0, 0.6, 1.2])\n",
        "ax.set_xlabel('$x$')\n",
        "ax.set_ylabel('$u(x,t)$')\n",
        "\n",
        "plt.close()"
      ],
      "id": "3cbc6b41",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | fig-cap: '<center><font size=\"3px\">Initial Velocity Given: $\\;u_t(x,0)=\\sin t$</font></center>'\n",
        "time_text = ax.text(-1.5, 1.3, '')\n",
        "line, = ax.plot([], [], lw=2)\n",
        "def init():\n",
        "    time_text.set_text('t = 0.0')\n",
        "    line.set_data([], [])\n",
        "    return (line,)\n",
        "\n",
        "c = 1\n",
        "def animate(t):\n",
        "    time_text.set_text(f't = {t:3.1f}')\n",
        "    x = np.linspace(-6.0*np.pi, 6.0*np.pi, 300)\n",
        "    u = 1.0/(2.0*c)*(np.cos(x -c*t) -np.cos(x +c*t))\n",
        "    line.set_data(x, u)\n",
        "    return (line,)\n",
        "\n",
        "tt = list(np.linspace(0, 2.0*np.pi/c, 100))\n",
        "anim = animation.FuncAnimation(fig, animate, \n",
        "        init_func=init, frames=tt, interval=200, blit=True) \n",
        "HTML('<center>' + anim.to_html5_video() + '</center>')"
      ],
      "id": "5f907482",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "## $\\,$More on the D'Alembert Solution {#sec-x2-20}\n",
        "\n",
        "* We proved that in the last section the solution of the pure initial-value problem\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    u_{tt} &=c^2 u_{xx} && -\\infty < x < \\infty,\\; 0 < t < \\infty \\\\ \n",
        "    \\begin{array}{r}\n",
        "      u(x, 0) \\\\\n",
        "      u_t(x, 0)\n",
        "    \\end{array} \n",
        "    &\n",
        "    \\begin{array}{c}\n",
        "      = f(x) \\\\\n",
        "      = g(x)\n",
        "    \\end{array} && -\\infty < x <\\infty \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  is given by\n",
        "\n",
        "  $$ u(x,t) =\\frac{1}{2} \\left[\\, f(x -ct) +f(x +ct) \\right] +\\frac{1}{2c} \\int_{x-ct}^{x+ct} g(\\xi)\\,d\\xi $$ \n",
        "\n",
        "  We now present an interpretation of this solution in the $\\,xt$-plane at the two specific cases\n",
        "\n",
        "**CASE 1** <font color=\"red\">$\\,$ Initial Position Given; $\\,$ Initial Velocity Zero</font>\n",
        "\n",
        "* Let's consider the following initial condition\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    u(x,0) &=f(x) \\\\ \n",
        "    u_t(x,0) &=0 \n",
        "  \\end{aligned},\\quad -\\infty < x < \\infty$$\n",
        "\n",
        "  the D'Alembert solution is\n",
        "\n",
        "  $$ u(x,t) =\\frac{1}{2} \\left[ f(x -ct) +f(x +ct) \\right] $$\n",
        "\n",
        "  and <font color=\"blue\">the solution $u(x_0,t_0)$ can be interpreted as being the average of the initial displacement $\\,f(x)$ at the points $(x_0-ct_0,0)$ and $(x_0 +ct_0,0)$ found by backtracking along the lines</font>\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "   x -ct&= x_0 -ct_0\\\\ \n",
        "   x +ct&= x_0 +ct_0 \n",
        "  \\end{aligned}\\quad\\color{red}{\\text{characteristic curves}}$$\n",
        "\n",
        "  ![](figures/pde02_figure04.jpg \"xt-plane interpretation\"){width=\"80%\" fig-align=\"center\"}\n",
        "\n",
        "* For example, $\\,$using this interpretation, $\\,$the initial condition\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "   u(x,0) &= \n",
        "   \\begin{cases}\n",
        "     1 & \\;-1 < x < 1 \\\\ \n",
        "     0 & \\text{everywhere else} \n",
        "   \\end{cases} \\\\ \n",
        "   u_t(x,0) &=0 \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  would give us the solution in the $\\,xt$-plane shown in figure\n",
        "\n",
        "  ![](figures/pde02_figure05.jpg \"solution in xt-plane\"){width=\"80%\" fig-align=\"center\"}\n",
        "\n",
        "**CASE 2** <font color=\"red\">$\\,$Initial Displacement Zero; $\\,$ Velocity Arbitrary</font>\n",
        "\n",
        "* Consider now the IC\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "   u(x,0) &=0 \\\\ \n",
        "   u_t(x,0) &=g(x) \n",
        "  \\end{aligned}, \\quad -\\infty < x < \\infty$$\n",
        "\n",
        "  the solution is\n",
        "\n",
        "  $$ u(x,t) =\\frac{1}{2c} \\int_{x -ct}^{x +ct} g(\\xi)\\,d\\xi $$\n",
        "\n",
        "  and, $\\,$hence, $\\,$<font color=\"blue\">the solution $\\,u(x_0, t_0)\\,$ can be interpreted as integrating the initial velocity between $x_0 -ct_0$ and $x_0 +ct_0$ on the initial line $t=0$</font>\n",
        "\n",
        "* Again, $\\,$using this interpretation, $\\,$the solution to the initial-value problem\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "     u(x,0) &= 0 \\quad -\\infty<x<\\infty \\\\ \n",
        "     u_t(x,0) &= \\begin{cases} 1 & \\;-1 < x < 1 \\\\ 0 & \\text{everywhere else} \n",
        "    \\end{cases}\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  has a solution in the $\\,tx$-plane in figure\n",
        "\n",
        "  ![](figures/pde02_figure07.jpg \"solution of initial velocity in xt-plane\"){width=\"80%\" fig-align=\"center\"}\n",
        "\n",
        "* To find the displacement, $\\,$we compute the D'Alembert solution\n",
        "\n",
        "$$\\scriptsize \\begin{aligned}\n",
        " u(x,t) &=\\frac{1}{2c}\\int_{x-ct}^{x+ct} g(\\xi)\\,d\\xi & \\\\ \n",
        " &= \\frac{1}{2c} \\int_{x-ct}^{x+ct} 0\\, d\\xi=0, & (x,t) \\in \\text{Region 1}\\\\ \n",
        " &= \\frac{1}{2c} \\int_{-1}^{x+ct} 1\\, d\\xi=\\frac{1+x+ct}{2c}, & (x,t) \\in \\text{Region 2}\\\\ \n",
        " &= \\frac{1}{2c} \\int_{-1}^{1} 1\\, d\\xi=\\frac{1}{c}, & (x,t) \\in \\text{Region 3}\\\\ \n",
        " &= \\frac{1}{2c} \\int_{x-ct}^{1} 1\\, d\\xi=\\frac{1-x+ct}{2c}, & (x,t) \\in \\text{Region 4}\\\\ \n",
        " &= \\frac{1}{2c} \\int_{x-ct}^{x+ct} 0\\, d\\xi=0, & (x,t) \\in \\text{Region 5}\\\\ \n",
        " &= \\frac{1}{2c} \\int_{x-ct}^{x+ct} 1\\, d\\xi=t, & (x,t) \\in \\text{Region 6}\n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$"
      ],
      "id": "693ef234"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "fig = plt.figure(figsize=(6, 4))\n",
        "ax = plt.axes(xlim=(-15, 15), ylim=(-0.1, 1.5))\n",
        "\n",
        "ax.set_xticks([-15, -10, -5, 0, 5, 10, 15])\n",
        "ax.set_yticks([0, 0.5, 1.0, 1.5])\n",
        "ax.set_xlabel('$x$')\n",
        "ax.set_ylabel('$u(x,t)$')\n",
        "\n",
        "plt.close()\n",
        "\n",
        "time_text = ax.text(-2, 1.3, '')\n",
        "line, = ax.plot([], [], lw=2)\n",
        "def init():\n",
        "    time_text.set_text('t = 0.0')\n",
        "    line.set_data([], [])\n",
        "    return (line,)"
      ],
      "id": "353b3be2",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "c = 1\n",
        "def animate(t):\n",
        "    time_text.set_text(f't = {t:3.1f}')    \n",
        "    xx = np.linspace(-15, 15, 300)   \n",
        "    uu = np.zeros_like(xx)\n",
        "    \n",
        "    for i, x in enumerate(xx):\n",
        "        ch1 = x +c*t\n",
        "        ch2 = x -c*t\n",
        "        if ch1 <-1.0 or ch2 > 1.0:\n",
        "            uu[i] = 0.0\n",
        "        elif t < 1.0 /c:\n",
        "            if ch2 <-1.0:\n",
        "                uu[i] = (1.0 +ch1) /(2.0*c)\n",
        "            elif ch1 < 1.0:\n",
        "                uu[i] = t\n",
        "            else:\n",
        "                uu[i] = (1.0 -ch2) /(2.0*c)           \n",
        "        else:\n",
        "            if ch1 < 1.0:\n",
        "                uu[i] = (1.0 +ch1) /(2.0*c)\n",
        "            elif ch2 <-1.0:\n",
        "                uu[i]=1.0 /c\n",
        "            else:\n",
        "                uu[i] = (1.0 -ch2) /(2.0*c) \n",
        "                       \n",
        "    line.set_data(xx, uu)\n",
        "    return (line,)"
      ],
      "id": "a989f12d",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | fig-cap: '<center><font size=\"3px\">Initial Velocity Given: $\\;u_t(x,0)=\\begin{cases} 1 & \\;-1 < x < 1 \\\\ 0 & \\text{everywhere else} \\end{cases}$</font></center>'\n",
        "tt = list(np.linspace(0, 20, 50))\n",
        "anim = animation.FuncAnimation(fig, animate, init_func=init, \n",
        "    frames=tt, interval=300, blit=True)\n",
        "\n",
        "HTML('<center>' + anim.to_html5_video() + '</center>')"
      ],
      "id": "c0927c95",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "* **Solution of the Semi-Infinite String via the D'Alembert Formula** \n",
        "\n",
        "  * In the remainder of the section, $\\,$we will solve the initial-boundary-value problem for the semi-infinite string\n",
        "\n",
        "    $$\n",
        "    \\begin{aligned}\n",
        "      u_{tt} \n",
        "       &=c^2 u_{xx} \n",
        "       && \\color{red}{0 < x < \\infty}, \\; 0 < t < \\infty \\\\\n",
        "      u(0, t) &= 0 && 0 < t < \\infty \\\\ \n",
        "     \\begin{array}{r}\n",
        "        u(x, 0) \\\\\n",
        "        u_t(x, 0)\n",
        "      \\end{array} \n",
        "      &\n",
        "      \\begin{array}{c}\n",
        "        = f(x) \\\\\n",
        "        = g(x)\n",
        "      \\end{array} && 0 < x <\\infty \n",
        "    \\end{aligned}$$\n",
        "\n",
        "  * We proceed in a manner similar to that used with the infinite string, $\\,$which is to find the general solution to the PDE\n",
        "\n",
        "    $$ u(x,t) = \\phi(x -ct) +\\psi(x +ct) \\tag{GS}\\label{eq:GS}$$ \n",
        "\n",
        "    If we now substitute this general solution into the initial conditions, $\\,$we arrive at\n",
        "\n",
        "    $${\\begin{aligned}\n",
        "       \\phi(x - ct)=\\frac{1}{2}f(x -ct) \\,-\\,&\\frac{1}{2c}\\int_{x_0}^{x -ct} \n",
        "          g(\\xi)\\,d\\xi -\\frac{C}{2c} \\\\\n",
        "       \\psi(x +ct)=\\frac{1}{2}f(x +ct) \\,+\\,&\\frac{1}{2c}\\int_{x_0}^{x +ct} \n",
        "          g(\\xi)\\,d\\xi +\\frac{C}{2c} \\\\\n",
        "      \\end{aligned}} \\tag{IM}\\label{eq:IM}$$ \n",
        "\n",
        "  * We now have a problem we didn't encounter when dealing with the infinite string. $\\,$Since we are looking for the solution $\\,u(x,t)\\,$ <font color=\"blue\">everywhere in the first quadrant $(x>0,\\;t>0)\\,$ of the $\\,tx$ plane</font>, $\\,$it is obvious that we must find\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "      \\phi(x -ct)\n",
        "        &\\;\\;\\; \\color{red}{\\text{for all } \n",
        "        -\\infty < x -ct < \\infty} \\\\ \n",
        "      \\psi(x +ct)&\\;\\;\\; \\text{for all } \n",
        "       \\phantom{xxx} 0 < x +ct < \\infty \n",
        "    \\end{aligned}$$\n",
        "\n",
        "  * Unfortunately, $\\,$the first equation only gives us $\\,\\phi(x -ct)\\,$ for $\\,x -ct \\geq 0$, $\\,$since our initial data $\\,f(x)$ and $g(x)$ are only known for positive arguments\n",
        "\n",
        "  * <font color=\"blue\">As long as $x -ct \\geq 0$, $\\,$we have no problem</font>, $\\,$since we can substitute \\eqref{eq:IM} into the general solution \\eqref{eq:GS} to get\n",
        "\n",
        "    $$ {u(x,t) =\\frac{1}{2} \\left[ f(x -ct) +f(x +ct) \\right] +\\frac{1}{2c} \\int_{x-ct}^{x+ct} g(\\xi)\\,d\\xi,\\;\\;\\; x \\geq ct} $$\n",
        "\n",
        "    The question is, $\\,$<font color=\"blue\">what to do when $x < ct$?</font>\n",
        "\n",
        "  * <font color=\"blue\">When $x < ct$</font>, $\\,$substituting the general solution \\eqref{eq:GS} into <font color=\"blue\">the BC $\\,u(0,t)=0\\,$ </font>gives\n",
        "\n",
        "    $$\\color{blue}{\\phi(-ct)=-\\psi(ct)}$$\n",
        "\n",
        "    and, $\\,$hence, $\\,$by functional substitution\n",
        "\n",
        "    $$ {\\phi(x -ct)={\\color{red}{-}}\\frac{1}{2}f({\\color{red}{ct -x}}) {\\color{red}{-}}\\frac{1}{2c}\\int_{x_0}^{{\\color{red}{ct -x}}} g(\\xi)\\,d\\xi {\\color{red}{-}}\\frac{C}{2c}} $$\n",
        "\n",
        "  * Substituting this value of $\\phi$ into the general solution \\eqref{eq:GS} gives\n",
        "\n",
        "    $$ {u(x,t) =\\frac{1}{2} \\left[ f(x +ct) -f(ct -x) \\right] +\\frac{1}{2c} \\int_{ct -x}^{x+ct} g(\\xi)\\,d\\xi,\\;\\;\\;0<x<ct} $$\n",
        "\n",
        "  * For $x \\geq ct$, $\\,$the solution is the same as the D'Alembert solution for the infinite wave, <font color=\"red\">while for $x < ct$, $\\,$the solution $u(x,t)$ is modified as a result of the wave reflecting from the boundary (The sign of the wave is changed when it's reflected)</font>\n",
        "\n",
        "  * The straight lines\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "      x +ct &= \\text{constant}\\\\ \n",
        "      x -ct &= \\text{constant} \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    are known as <font color=\"red\">**characteristics**</font>, $\\,$and it is along these lines that disturbances are propagated. $\\,$<font color=\"red\">Characteristics are generally associated with hyperbolic equations</font>\n",
        "\n",
        "![](figures/pde02_figure08.jpg \"solution of semi-infinite string in xt-plane\"){width=\"80%\" fig-align=\"center\"}\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$Solve the semi-infinite string problem\n",
        "\n",
        "$~$\n",
        "\n",
        "$$\n",
        "  \\begin{aligned}\n",
        "    u_{tt} &=c^2 u_{xx} && 0 < x < \\infty,\\; 0 < t < \\infty \\\\\n",
        "    u(0,t) &=0 && 0 < t < \\infty \\\\ \n",
        "    \\begin{array}{r}\n",
        "      u(x, 0) \\\\\n",
        "      u_t(x, 0)\n",
        "    \\end{array} \n",
        "    &\\,\n",
        "    \\begin{array}{l}\n",
        "      = f(x) \\\\\n",
        "      = 0\n",
        "    \\end{array} && 0 < x <\\infty \n",
        "  \\end{aligned}$$\n",
        "\n",
        "![](figures/pde02_figure09.jpg \"Example initial condition\"){width=\"70%\" fig-align=\"center\"}\n",
        "\n",
        "$~$"
      ],
      "id": "e3c879ac"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "fig = plt.figure(figsize=(6, 4))\n",
        "ax = plt.axes(xlim=(0, 5), ylim=(-1.0, 1.5))\n",
        "\n",
        "ax.set_xticks([0, 2.5, 5])\n",
        "ax.set_yticks([-1.0, -0.5, 0.0, 0.5, 1.0, 1.5])\n",
        "ax.set_xlabel('$x$')\n",
        "ax.set_ylabel('$u(x,t)$')\n",
        "\n",
        "plt.close()\n",
        "\n",
        "time_text = ax.text(2.2, 1.3, '')\n",
        "line, = ax.plot([], [], lw=2)\n",
        "def init():\n",
        "    time_text.set_text('t = 0.0')\n",
        "    line.set_data([], [])\n",
        "    return (line,)"
      ],
      "id": "0fe4131f",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "c = 1\n",
        "def f_i(x):\n",
        "    if x >= 1 and x <= 2:\n",
        "        u = 1.0\n",
        "    else:\n",
        "        u = 0.0\n",
        "    return u\n",
        "    \n",
        "def animate(t):\n",
        "    time_text.set_text(f't = {t:3.1f}')        \n",
        "    xx = np.linspace(0, 5, 400)   \n",
        "    uu = np.zeros_like(xx)\n",
        "    \n",
        "    for i, x in enumerate(xx):\n",
        "        ch1 = x +c*t\n",
        "        ch2 = x -c*t\n",
        "        if ch2 >= 0:\n",
        "            uu[i] = 0.5*(f_i(ch1) +f_i(ch2))\n",
        "        else:\n",
        "            uu[i] = 0.5*(f_i(ch1) -f_i(-ch2))\n",
        "                       \n",
        "    line.set_data(xx, uu)\n",
        "    return (line,)"
      ],
      "id": "086a7188",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | fig-cap: '<center><font size=\"3px\">Semi-infinite String</font></center>'\n",
        "tt = list(np.linspace(0, 7, 100))\n",
        "anim = animation.FuncAnimation(fig, animate, \n",
        "        init_func=init, frames=tt, interval=750, blit=True)\n",
        "HTML('<center>' + anim.to_html5_video() + '</center>')"
      ],
      "id": "1ed0448e",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "**Example** $\\,$Solve the semi-infinite string problem\n",
        "\n",
        "$$\n",
        "  \\begin{aligned}\n",
        "    u_{tt} &=c^2 u_{xx} && 0 < x < \\infty,\\; 0 < t < \\infty \\\\\n",
        "    u_x(0,t) & =0 && 0 < t < \\infty \\\\ \n",
        "    \\begin{array}{r}\n",
        "      u(x, 0) \\\\\n",
        "      u_t(x, 0)\n",
        "    \\end{array} \n",
        "    &\\;\n",
        "    \\begin{array}{l}\n",
        "      = f(x) \\\\\n",
        "      = 0\n",
        "    \\end{array} && 0 < x <\\infty \n",
        "  \\end{aligned}$$\n",
        "\n",
        "in a manner analogous to the way the semi-infinite string problem was solved in the section\n",
        "\n",
        "**Solution** $\\,$For $x \\geq ct$, $\\,$the solution is the same as the D'Alembert solution for the infinite wave, <font color=\"red\"> $\\,$while for $x < ct$, $\\,$the solution $u(x,t)$ is modified as a result of the wave reflecting from the boundary</font>\n",
        "\n",
        "  $$ {u(x,t) =\\frac{1}{2} \\left[ f(x +ct) +f(ct -x) \\right] +\\frac{1}{2c} \\left[ \\int_0^{ct -x} g(\\xi)\\,d\\xi + \\int_0^{x +ct} g(\\xi)\\,d\\xi \\right] ,\\;\\; 0 < x < ct} $$\n",
        "\n",
        "$~$\n",
        "\n",
        "* **The Nonhomogeneous Wave Equation**\n",
        "\n",
        "  * We consider now the pure nonhomogeneous wave equation:\n",
        "\n",
        "    $$\n",
        "    \\begin{aligned}\n",
        "    u_{tt} &\\! =c^2 u_{xx} +\\color{red}{F(x, t)} \n",
        "      && -\\infty < x < \\infty,\\; 0 < t < \\infty \\\\ \n",
        "    \\begin{array}{r}\n",
        "      u(x, 0) \\\\\n",
        "      u_t(x, 0)\n",
        "    \\end{array} \n",
        "    &\n",
        "    \\begin{array}{c}\n",
        "      = 0 \\\\\n",
        "      = 0\n",
        "    \\end{array} && -\\infty < x <\\infty \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    which includes the forcing term $F(x, t)$, $~$but zero initial conditions\n",
        "\n",
        "  * We again make the change of variables $\\,\\xi=x +ct\\,$ and $\\,\\eta=x -ct$.\n",
        "$\\,$The differential equation then becomes\n",
        "\n",
        "    $$\n",
        "    \\begin{aligned}\n",
        "      & u_{\\xi\\eta} = \\color{red}{-\\frac{1}{4c^2} F(\\xi, \\eta)} \\\\ \\\\\n",
        "      &\\color{blue}\n",
        "      {\\left.\\begin{matrix}\n",
        "        u = 0\\\\ \n",
        "        u_\\xi = u_\\eta\n",
        "        \\end{matrix} \\;\\;\\right\\} \\;\\text{ at } \\xi=\\eta \\;\\; \\leftarrow \n",
        "       \\left.\\begin{matrix}\n",
        "         u = 0 \\\\\n",
        "         u_t = 0\n",
        "       \\end{matrix} \\;\\;\\right\\} \\text{ at } t=0}\n",
        "    \\end{aligned}$$\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "   \\\\[5pt]\n",
        "   &\\Downarrow \n",
        "     {\\scriptstyle\\text{ integrating with respect to } \n",
        "      \\xi \\text{ and } \\eta, \\text{ respectively} }\\\\[5pt] \n",
        "   u_\\eta \\;&{\\scriptsize= -\\frac{1}{4c^2} \n",
        "    \\int_\\eta^\\xi F\\left(\\bar{\\xi}, \\eta \\right) \n",
        "     \\,d\\bar{\\xi} +c_1}, \\:\\:\n",
        "   u_\\xi \\;{\\scriptsize= -\\frac{1}{4c^2} \n",
        "     \\int_\\xi^\\eta F\\left(\\xi, \\bar{\\eta} \\right) \n",
        "      \\,d\\bar{\\eta}  +c_1} \\\\[5pt] \n",
        "   &\\Downarrow \n",
        "   {\\scriptstyle\\text{ integrating with respect to } \n",
        "    \\eta \\text{ and } \\xi, \\text{ respectively}}\\\\[5pt]\n",
        "    u \\;&{\\scriptsize= -\\frac{1}{4c^2} \\int_\\eta^\\xi \n",
        "      \\left[ \\int_{\\bar{\\eta}}^\\xi F\\left( \\bar{\\xi}, \n",
        "       \\bar{\\eta} \\right) \\,d\\bar{\\xi} \\right ] \n",
        "        \\,d\\bar{\\eta} +c_1 \\eta +c_2} \\\\ \n",
        "        \\;&{\\scriptsize= -\\frac{1}{4c^2} \\int_\\xi^\\eta \n",
        "         \\left[ \\int_{\\bar{\\xi}}^\\eta F\\left( \n",
        "          \\bar{\\xi}, \\bar{\\eta} \\right) \n",
        "          \\,d\\bar{\\eta} \\right ] \\,d\\bar{\\xi}\n",
        "          +c_1 \\xi +c_3}\n",
        "   \\end{aligned}$$\n",
        "\n",
        "  * We let $\\,\\bar{\\xi}=\\beta +c\\tau\\;$ and $\\,\\bar{\\eta}=\\beta -c\\tau$, $\\,$($t \\ge \\tau$, $\\,\\beta=x$). $\\,$The domain of integration $\\,\\eta \\leq \\bar{\\eta} \\leq \\bar{\\xi} \\leq \\xi\\;$ becomes\n",
        "\n",
        "    $$\n",
        "    \\begin{aligned}\n",
        "      \\eta \\leq \\beta -c\\tau &\\leq \\beta +c\\tau \\leq \\xi \\\\ \n",
        "      &\\Downarrow \\\\ \n",
        "      \\eta +c\\tau \\leq &\\;\\beta \\leq\\xi -c \\tau \\\\ \n",
        "      0 \\leq &\\;\\tau \\leq \\frac{1}{2c} (\\xi -\\eta) \n",
        "    \\end{aligned}$$\n",
        "\n",
        "  * The transformation from $\\,(\\bar{\\xi}, \\,\\bar{\\eta})\\,$ to $\\,(\\beta, \\,\\tau)\\,$ gives the solution formula\n",
        "\n",
        "    $$\n",
        "    \\begin{aligned}\n",
        "     u &= -\\frac{1}{4c^2} \\int_\\eta^\\xi \n",
        "     \\left[ \\int_{\\bar{\\eta}}^\\xi F\\left( \\bar{\\xi}, \\bar{\\eta} \\right) \n",
        "     \\,d\\bar{\\xi} \\right ] \\,d\\bar{\\eta} \\\\[5pt]\n",
        "    &\\big\\Downarrow {\\scriptstyle \\;\\;d\\bar{\\xi}\\,d\\bar{\\eta} \\,=\\,  \\begin{vmatrix}\n",
        "    \\frac{\\partial \\bar{\\xi}}{\\partial \\beta}& \\frac{\\partial \\bar{\\xi}}{\\partial \\tau} \\\\ \n",
        "    \\frac{\\partial \\bar{\\eta}}{\\partial \\beta}& \\frac{\\partial \\bar{\\eta}}{\\partial \\tau} \n",
        "    \\end{vmatrix}  \\,d\\beta\\,d\\tau \\,=\\, -2c \\,d\\beta\\,d\\tau}\\\\[5pt]\n",
        "    &=\\frac{1}{2c} \\int_0^{(\\xi -\\eta)/2c} \\left[ \\int_{\\eta +c\\tau}^{\\xi -c\\tau} F\\left( \\beta,\\tau \\right) \\,d\\beta \\right ] \\,d\\tau \\\\[5pt]\n",
        "    &\\Downarrow {\\scriptstyle  \\;\\xi=x +ct, \\;\\eta=x -ct} \\\\\n",
        "    {\\color{red}{u}}\\; &{\\color{red}{= \\frac{1}{2c} \\int_0^t \\left[ \\int_{x -c(t -\\tau)}^{x +c(t -\\tau)} F\\left( \\beta,\\tau \\right) \\,d\\beta \\right ] \\,d\\tau}}\n",
        "    \\end{aligned}\n",
        "    $$\n",
        "\n",
        "$~$\n",
        "\n",
        "## The Wave Equation in Two and Three Dimensions (Free Space) {#sex-x2-21}\n",
        "\n",
        "The problem of this section is to generalize the D'Alembert solution to two and three dimensions\n",
        "\n",
        "* **Waves in Three Dimensions**\n",
        "\n",
        "  We start by considering spherical waves in three dimensions that have given ICs; $\\,$that is, $\\,$we would like to solve the initial value problem\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    u_{tt} &=c^2(u_{xx} +u_{yy} +u_{zz}),\\quad \n",
        "    \\begin{cases}\n",
        "      -\\infty < x <\\infty \\\\ \n",
        "      -\\infty < y <\\infty \\\\ \n",
        "      -\\infty < z <\\infty\n",
        "    \\end{cases} \\\\ \n",
        "    u(&x,y,z,0)=\\phi(x,y,z) \\\\ \n",
        "    u_t(&x,y,z,0)=\\psi(x,y,z) \n",
        "  \\end{aligned} \\tag{3D}\\label{eq:3D}$$\n",
        "\n",
        "  * To solve this problem, $\\,$we first solve the simpler one (set $\\phi=0$)\n",
        "\n",
        "    $$\\color{red}{\\begin{aligned}\n",
        "      u_{tt}&=c^2(u_{xx} +u_{yy} +u_{zz}),\\quad (x,y,z) \\in \\mathbb{R}^3\\\\\n",
        "      u(&x,y,z,0)=0 \\\\ \n",
        "      u_t(&x,y,z,0)=\\psi(x,y,z) \n",
        "    \\end{aligned}} \\tag{3Dv}\\label{eq:3Dv}$$\n",
        "\n",
        "    This problem can be solved by the Fourier transform\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "      \\mathcal{F}(u)\n",
        "        &=\\frac{1}{(2\\pi)^{3/2}}\\iiint_{-\\infty}^\\infty \n",
        "          u(x,y,z,t) e^{-i(\\omega_1 x+\\omega_2 y+\\omega_3 z)}\\,dx\\,dy\\,dz \n",
        "          =U(\\omega_1,\\omega_2,\\omega_3,t)\\\\ \n",
        "      \\mathcal{F}(\\psi)&=\\frac{1}{(2\\pi)^{3/2}}\\iiint_{-\\infty}^\\infty \n",
        "        \\psi(x,y,z) e^{-i(\\omega_1 x+\\omega_2 y+\\omega_3 z)}\\,dx\\,dy\\,dz \n",
        "        =\\Psi(\\omega_1,\\omega_2,\\omega_3)\n",
        "    \\end{aligned}$$\n",
        "\n",
        "  $$\\scriptsize \\begin{aligned}\n",
        "  &\\Downarrow\\;\\; \\mathcal{F}^{-1} \\\\ \\\\\n",
        "  u(x,y,z,t)= \\frac{1}{(2\\pi)^{3/2}} \n",
        "    \\lim_{L\\to\\infty} \\underset{\\omega_1^2 +\\omega_2^2 +\\omega_3^2 < L^2}{\\iiint}\n",
        "    \\Psi(\\omega_1,\\omega_2,\\omega_3) &\n",
        "    \\frac{\\sin ct \\sqrt{ \\omega_1^2 +\\omega_2^2 +\\omega_3^2 }}{c\\sqrt{\\omega_1^2 \n",
        "    +\\omega_2^2 +\\omega_3^2 }} \\,e^{i(\\omega_1 x +\\omega_2 y +\\omega_3 z)}\\,d\\omega_1 \\,d\\omega_2 \\,d\\omega_3 \\\\ \n",
        "  = \\frac{1}{(2\\pi)^{3/2}} \n",
        "  \\iiint_{-\\infty}^\\infty \\psi(\\xi,\\eta,\\zeta)\\;\n",
        "    {\\tiny \\left[ \\frac{1}{(2\\pi)^{3/2}}  \\lim_{L\\to\\infty} \n",
        "      \\underset{\\omega_1^2 +\\omega_2^2 +\\omega_3^2 < L^2}{\\iiint} \\right. } &\n",
        "    {\\tiny \\left. e^{-i\\left[\\omega_1 (\\xi-x) +\\omega_2 (\\eta-y) +\\omega_3 (\\zeta-z) \\right]} \\;\n",
        "    \\frac{\\sin ct \\sqrt{ \\omega_1^2 +\\omega_2^2 +\\omega_3^2 }}{c\\sqrt{\\omega_1^2 +\\omega_2^2 +\\omega_3^2 }}\\,\n",
        "    \\,d\\omega_1 \\,d\\omega_2 \\,d\\omega_3 \\,\\right] } \\,d\\xi \\,d\\eta \\,d\\zeta \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  * We introduce spherical coordinates $(\\varrho,\\varphi,\\vartheta)$ in the $(\\omega_1,\\omega_2,\\omega_3)$ space with the north pole $\\varphi=0$ in the direction of the vector $\\left \\langle \\xi-x,\\eta-y,\\zeta-z \\right \\rangle$. $\\,$Then the integral in $(\\omega_1,\\omega_2,\\omega_3)$ becomes\n",
        "\n",
        "    $$\\scriptsize\\begin{aligned}\n",
        "      \\frac{1}{(2\\pi)^{3/2}}  \\lim_{L\\to\\infty} \n",
        "      \\underset{\\omega_1^2 +\\omega_2^2 +\\omega_3^2 < L^2}{\\iiint} \n",
        "      &e^{-i\\left[\\omega_1 (\\xi-x) +\\omega_2 (\\eta-y) \n",
        "      +\\omega_3 (\\zeta-z)\\right]}\\;\n",
        "      \\frac{\\sin ct \\sqrt{ \\omega_1^2 +\\omega_2^2 +\\omega_3^2 }}{c\\sqrt{\\omega_1^2 +\\omega_2^2 +\\omega_3^2 }}\\,\n",
        "      \\,d\\omega_1 \\,d\\omega_2 \\,d\\omega_3 \\\\ \n",
        "      &\\;\\;\\Downarrow \\; \n",
        "        {\\tiny r=|\\mathbf{r}|=\\sqrt{(\\xi-x)^2 +(\\eta -y)^2 +(\\zeta -z)^2},\\;\\; \n",
        "          \\varrho =|\\boldsymbol{\\varrho}| \n",
        "      = \\sqrt{\\omega_1^2 +\\omega_2^2 +\\omega_3^2} }\\\\ \n",
        "        &=\\frac{1}{(2\\pi)^{3/2}} \\lim_{L\\to\\infty} \n",
        "        \\int_0^L \\int_0^{2\\pi}  \\int_0^\\pi \n",
        "      \\;e^{-ir \\varrho\\cos \\varphi} \\;\\frac{\\sin ct \\varrho}{c\\varrho}\\; \n",
        "      \\varrho^2 \\sin\\varphi \\,d\\varphi\\,d\\vartheta\\,d\\varrho \\\\\n",
        "        &\\;\\;\\Downarrow \n",
        "        \\; {\\tiny \\alpha=\\cos\\varphi, \\;d\\alpha=-\\sin\\varphi d\\varphi } \\\\ \n",
        "        &=\\frac{1}{(2\\pi)^{3/2}} \n",
        "        \\lim_{L\\to\\infty} \\frac{2\\pi}{c} \\int_0^L \\; \\varrho \\sin ct\\varrho \n",
        "      \\underbrace{\\left[ \\frac{e^{-ir\\varrho \\alpha}}{-ir\\varrho} \n",
        "        \\right]_{-1}^1 }_{\\frac{2}{r\\varrho}\\sin r\\varrho} \\,d\\varrho \\\\ \n",
        "        &=\\frac{1}{(2\\pi)^{3/2}} \\lim_{L\\to\\infty} \\frac{4\\pi}{cr} \\int_0^L  \n",
        "        \\;\\sin ct \\varrho \\cdot \\sin r\\varrho \\,d\\varrho\n",
        "    \\end{aligned}$$\n",
        "\n",
        "  * To treat the integration with respect to $\\xi$, $\\,\\eta$, and $\\,\\zeta$, $~$we introduce spherical coordinates $(r,\\phi,\\theta)$ in the $(\\xi,\\eta,\\zeta)$ space with their origin at $(x,y,z)$, $\\,$so that\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    \\xi-x &=r\\sin\\phi \\cos\\theta \\\\ \n",
        "    \\eta-y&=r\\sin\\phi \\sin\\theta \\\\ \n",
        "    \\zeta-z&=r\\cos\\phi \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    Then the solution becomes\n",
        "\n",
        "    $$\\scriptsize\\begin{aligned}\n",
        "    {\\normalsize\\color{red}{u(x,y,z,t)}}\n",
        "    &= {\\tiny \\frac{4\\pi}{(2\\pi)^3 c} \\lim_{L\\to \\infty} \\int_0^\\infty \\int_0^{2\\pi} \\int_0^\\pi  \n",
        "      \\;\\psi(x +r\\sin\\phi\\cos\\theta,y +r\\sin\\phi\\sin\\theta, z+r\\cos\\phi)\\; \\frac{1}{r}\\;\\left[ \\int_0^L  \n",
        "      \\sin ct \\varrho \\sin r\\varrho\\, d\\varrho \\right] r^2\\sin\\phi \\, d\\phi \\, d\\theta \\,dr }\\\\\n",
        "      &= {\\tiny \\frac{1}{2\\pi^2 c} \\lim_{L\\to \\infty} \\int_0^L \\sin ct\\varrho \\left[\\int_0^\\infty \\sin r\\varrho \n",
        "      \\underbrace{\\left( \\int_0^{2\\pi} \\int_0^\\pi  \\psi(x +r\\sin\\phi\\cos\\theta,y +r\\sin\\phi\\sin\\theta, z+r\\cos\\phi) \n",
        "      \\,r\\,\\sin\\phi \\,d\\phi\\,d\\theta  \\right) }_{g(r)} dr \\right] d\\varrho } \\\\ \n",
        "      &= {\\tiny \\frac{1}{2\\pi^2 c} \\frac{\\pi}{2} \\int_0^\\infty \\sin ct \\varrho \\;\\underbrace{\\left[\\frac{2}{\\pi} \\int_0^\\infty \n",
        "      \\sin r\\varrho \\,g(r)\\,dr \\right]}_{G(\\varrho)} d\\varrho  \n",
        "      = \\frac{1}{4\\pi c} \\underbrace{\\int_0^\\infty \\sin ct \\varrho \\;G(\\rho)\\,d\\varrho}_{g(ct)} } \\\\ \n",
        "      &= {\\tiny \\frac{t}{4\\pi (ct)^2} \\int_0^{2\\pi}\\int_0^\\pi  \\psi(x +ct\\sin\\phi\\cos\\theta,y +ct\\sin\\phi\\sin\\theta, z+ct\\cos\\phi) \n",
        "      \\,(ct)^2\\sin\\phi \\,d\\phi \\,d\\theta  }\n",
        "      = {\\normalsize\\color{red}{t\\bar{\\psi}}}\n",
        "    \\end{aligned}$$\n",
        "\n",
        "    <font color=\"blue\"> where $\\bar{\\psi}$ is the average of the initial disturbance $\\psi$ over the surface of the sphere of radius $\\,ct\\,$ centered at $(x,y,z)$</font>\n",
        "\n",
        "  * The interpretation of this solution is that the initial disturbance $\\,\\psi\\,$ radiates outward spherically (velocity $c$) at each point, $\\,$so that after so many seconds, $\\,$the point $\\,(x,y,z)$ will be influenced by those initial disturbances on a sphere (of radius $\\,ct$) around that point\n",
        "\n",
        "    ![](figures/pde02_figure19.jpg \"solution as the average of initial disturbances on a sphere\"){width=\"80%\" fig-align=\"center\"}\n",
        "\n",
        "  * Now, $\\,$to finish the problem, $\\,$what about the other half; $\\,$that is\n",
        "\n",
        "    $$\\color{red}{\\begin{aligned}\n",
        "    u_{tt}&=c^2(u_{xx} +u_{yy} +u_{zz}),\\quad (x,y,z) \\in \\mathbb{R}^3 \\\\ \n",
        "    u(&x,y,z,0)=\\phi(x,y,z) \\\\ \n",
        "    u_t(&x,y,z,0)=0 \n",
        "    \\end{aligned}} \\tag{3Dp}\\label{eq:3Dp}$$\n",
        "\n",
        "    This is easy: $\\,$A famous theorem developed by *Stokes* says all we have to do to solve this problem is to change the ICs to $\\,v=0$, $\\,v_t=\\phi$, $\\,$and then differentiate this solution with respect to time:\n",
        "\n",
        "    $$ v=\\int_0^t u\\,dt,\\;v_t=u, \\;u_{tt}=\\frac{\\partial}{\\partial t} v_{tt}, \\;u_{xx}=\\frac{\\partial}{\\partial t} v_{xx}$$\n",
        "\n",
        "  * In other words, $\\,$we solve\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    v_{tt}&=c^2(v_{xx} +v_{yy} +v_{zz}),\\quad (x,y,z) \\in \\mathbb{R}^3 \\\\ \n",
        "    v(&x,y,z,0)=0 \\\\ \n",
        "    v_t(&x,y,z,0)=\\phi(x,y,z) \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    to get $v=t\\bar{\\phi}\\,$ and then differentiate with respect to time. $\\,$This gives us the solution \n",
        "    \n",
        "    $$\\color{red}{u=\\frac{\\partial}{\\partial t} \\left[ t\\bar{\\phi} \\right]}$$\n",
        "    \n",
        "    to problem \\eqref{eq:3Dp}\n",
        "\n",
        "  * We now have the solution to our general three-dimensional problem \\eqref{eq:3D}. $\\,$It's just\n",
        "\n",
        "    $$ \\color{red}{u(x,y,z,t)=\\frac{\\partial}{\\partial t} \\left[ t\\bar{\\phi} \\right]+t\\bar{\\psi}}$$\n",
        "\n",
        "    where $\\,\\bar{\\phi}\\,$ and $\\,\\bar{\\psi}\\,$ are the averages of the functions $\\,\\phi\\,$ and $\\,\\psi\\,$ over the sphere of radius $\\,ct\\,$ centered at $\\,(x,y,z)$\n",
        "\n",
        "    $~$\n",
        "\n",
        "    ![](figures/pde02_figure20.jpg \"diagram showing how initial disturbances affect a point\"){width=\"60%\" fig-align=\"center\"}\n",
        "\n",
        "  * Suppose now the initial disturbances $\\,\\phi\\,$ and $\\,\\psi\\,$ are zero except for a small sphere. $\\,$As time increases, $\\,$the radius of the sphere around $(x,y,z)$ increases with velocity $\\,c$\n",
        "\n",
        "  * and so after $\\,t_2$ seconds, $\\,$it will finally intersect the initial disturbance region, $\\,$and, $\\,$hence, $\\,u(x,y,z,t)\\,$ becomes nonzero\n",
        "\n",
        "  * For $\\,t_2 < t < t_3$, $\\,$the solution at $\\,(x,y,z)\\,$ will be nonzero, $\\,$since the sphere intersects the disturbance region\n",
        "\n",
        "  * but when $\\,t=t_3$, $\\,$the solution at $\\,(x,y,z)\\,$ abruptly becomes zero again. $\\,$In other words, $\\,$the wave disturbance originating from the initial-disturbance region has a sharp trailing edge. $\\,$This general principle is known as **Huygen's principle** for the three dimensions, $\\,$and $\\,$it is the reason why sound waves in three dimensions stimulate our ears but die off instanteously when the wave has passed\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$Illustrate by picture and words the spherical wave solution of the three-dimensional problem\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u_{tt}&=c^2(u_{xx} +u_{yy} +u_{zz}), \\quad\n",
        "\\begin{cases}\n",
        " -\\infty < x <\\infty \\\\ \n",
        " -\\infty < y <\\infty \\\\ \n",
        " -\\infty < z <\\infty\n",
        "\\end{cases} \\\\ \n",
        " u(&x,y,z,0)=0 \\\\ \n",
        " u_t(&x,y,z,0)=\n",
        " \\begin{cases}\n",
        " \\;1 & x^2+y^2+z^2 \\leq 1 \\\\ \n",
        " \\;0 & \\text{elsewhere} \n",
        "\\end{cases} \n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Two-Dimensional Wave Equation**\n",
        "\n",
        "  To solve the two-dimensional problem\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    u_{tt}&=c^2(u_{xx} +u_{yy}),\\quad\n",
        "    \\begin{cases}\n",
        "    -\\infty < x <\\infty \\\\ \n",
        "    -\\infty < y <\\infty\n",
        "    \\end{cases} \\\\ \n",
        "    u(&x,y,0)=\\phi(x,y) \\\\ \n",
        "    u_t(&x,y,0)=\\psi(x,y) \n",
        "  \\end{aligned} \\tag{2D}\\label{eq:2D}$$\n",
        "\n",
        "  we merely let the initial disturbances $\\,\\phi\\,$ and $\\,\\psi\\,$ in the three-dimensional problem depend on only the two variables $\\,x\\,$ and $\\,y$. $\\,$Doing this, the three-dimensional formula\n",
        "\n",
        "  $$ u = \\frac{\\partial}{\\partial t} [t\\bar{\\phi}] +t\\bar{\\psi} $$\n",
        "\n",
        "  for $\\,u\\,$ will describe <font color=\"red\">cylindrical waves</font> and, $\\,$hence, $\\,$give us the solution for the two-dimensional problem\n",
        "\n",
        "  * This technique is called the method of descent. $\\,$Carrying out the computations, $\\,$we get\n",
        "\n",
        "    $$\\scriptstyle\\begin{aligned}\n",
        "    \\bar{\\psi}(x,y,t) &= \\frac{1}{4\\pi (ct)^2} \\color{red}{\\int_0^{2\\pi}  \\int_{0}^\\pi} \n",
        "      \\psi(x +ct\\sin\\phi\\cos\\theta,y+ct\\sin\\phi\\sin\\theta)\\, \\color{red}{(ct)^2 \\sin\\phi \\, d\\phi \\, d\\theta} \\;\\;\\leftarrow \\text{spherical surface}\\\\\n",
        "    &\\Downarrow \\;\\; {\\tiny r = ct \\,\\sin \\phi, \\; \\,dr =ct \\, \\cos\\phi \\,d\\phi\\;\\;\\rightarrow\\;\\; \\int_0^{\\pi} ct \\sin\\phi\\,d\\phi = 2\\int_0^{ct}\\frac{r}{\\sqrt{(ct)^2 -r^2}} dr } \\\\\n",
        "    &= \\frac{1}{2\\pi ct} \\, \\color{red}{\\int_0^{2\\pi} \\int_0^{ct}} \\psi(x +r\\cos\\theta, y+r\\sin\\theta)\\,\\frac{1}{\\sqrt{(ct)^2 -r^2}}\\,\\color{red}{r\\,dr\\,d\\theta} \\;\\;\\leftarrow \\text{circle interior}\\\\\n",
        "    \\bar{\\phi}(x,y,t) &= \\frac{1}{2\\pi ct} \\, \\color{red}{\\int_0^{2\\pi} \\int_0^{ct}} \n",
        "    \\phi(x +r\\cos\\theta, y+r\\sin\\theta)\\,\\frac{1}{\\sqrt{(ct)^2 -r^2}}\\,\\color{red}{r\\,dr\\,d\\theta}\n",
        "    \\end{aligned}$$\n",
        "\n",
        "    Note that in this solution, $\\,$the two integrals of the initial conditions $\\,\\phi\\,$ and $\\,\\psi\\,$ are integrated over the interior of a circle with center $\\,(x,y)\\,$ and radius $\\,ct$. $\\,$We see that initial disturbances give rise to sharp leading waves, $\\,$but not to sharp trailing waves. $\\,$Thus, Huygen's principle doesn't hold in two dimensions\n",
        "\n",
        "* **One-Dimensional Wave Equation**\n",
        "\n",
        "  Finally, $\\,$if we assume the initial conditions $\\,\\phi\\,$ and $\\,\\psi\\,$ depend only on one variable, $\\,$this gives rise to plane waves and, $\\,$hence, $\\,$the preceding equation descends one more dimension \n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  \\bar{\\psi}(x,t) &= {\\tiny \\frac{1}{2\\pi ct} \\, \\int_0^{2\\pi} \\int_0^{ct} \n",
        "    \\frac{\\psi(x +r\\cos\\theta)}{\\sqrt{(ct)^2 -r^2}}\\,r\\,dr\\,d\\theta }\\\\\n",
        "  &\\Downarrow {\\tiny r^2=x^2 + y^2, \\; (ct)^2 -x^2 = \\alpha^2 }\\\\\n",
        "  &={\\tiny \\frac{1}{2\\pi ct}\\, \\int_{x -ct}^{x +ct} \\underbrace{\\int_{-\\alpha}^{\\alpha} \n",
        "    \\frac{1}{\\sqrt{\\alpha^2 -y^2}}\\,dy}_{ \\pi} \\;\\psi(x) \\,dx }\n",
        "  = \\frac{1}{2ct} \\int_{x-ct}^{x+ct} \\psi(x)\\,dx \\\\\n",
        "  \\bar{\\phi}(x,t) &= \\frac{1}{2ct} \\int_{x-ct}^{x+ct} \\phi(x)\\,dx\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  to the well-known D'Alembert solution. $\\,$Note in the D'Alembert solution, $\\,$the initial position $\\,\\phi\\,$ gives rise to sharp trailing edges, $\\,$but the initial velocity $\\,\\psi\\,$ does not. $\\,$In other words, $\\,$one dimension is a little unusual in that the initial position satisfies Huygen's principle, $\\,$but the initial velocity does not\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$What is the two dimensional solution of the analogous cylindrical-wave problem\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u_{tt}&=c^2(u_{xx} +u_{yy}),\\quad\n",
        "\\begin{cases}\n",
        " -\\infty < x <\\infty \\\\ \n",
        " -\\infty < y <\\infty\n",
        "\\end{cases} \\\\ \n",
        " u(&x,y,0)=0 \\\\ \n",
        " u_t(&x,y,0)=\n",
        " \\begin{cases}\n",
        " \\;1 & x^2+y^2 \\leq 1 \\\\ \n",
        " \\;0 & \\text{elsewhere} \n",
        "\\end{cases} \n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Boundary Conditions Associated with the Wave Equation {#sec-x2-22}\n",
        "\n",
        "The purpose of this section is to discuss some of the various types of BCs that are associated with physical problems of wave motions. $\\,$Here, $\\,$we will stick to one-dimensional problems where the BCs (linear ones) are generally groupded into one of three kinds\n",
        "\n",
        "* **First Kind: $\\,$Controlled End Points**\n",
        "\n",
        "  We are now involved with problems like\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    u_{tt} &=c^2 u_{xx} && \\color{red}{0 < x < 1},\\;\\; 0 < t < \\infty \\\\ \\\\\n",
        "    \\begin{array} {r}\n",
        "      u(0, t) \\\\ u(1,t)\n",
        "    \\end{array}\n",
        "    &\n",
        "    \\begin{array} {r}\n",
        "      =g_1(t) \\\\ =g_2(t)\n",
        "    \\end{array}\n",
        "    && 0 < t < \\infty \\\\ \\\\\n",
        "    \\begin{array} {r}\n",
        "      u(x, 0) \\\\ u_t(x, 0)\n",
        "    \\end{array}\n",
        "    &\n",
        "    \\begin{array} {r}\n",
        "      =f(x) \\\\ =g(x)\n",
        "    \\end{array}\n",
        "    && 0 \\leq x \\leq L\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  where we control the end points so that they move in a given manner\n",
        "\n",
        "  ![](figures/pde02_figure10.jpg \"1st kind BC\"){width=\"70%\" fig-align=\"center\"}\n",
        "\n",
        "  A typical problem of this kind would involve suddenly twisting (at $t=1$) the right end of a fastened rod so many degrees and observing the resulting tortional vibration\n",
        "\n",
        "  ![](figures/pde02_figure11.jpg \"tortional vibration\"){width=\"80%\" fig-align=\"center\"}\n",
        "\n",
        "* **Second Kind: $\\,$Force Given on the Boundaries** \n",
        "\n",
        "  In as much as the vertical forces on the string at the left and right ends are given by $\\,Tu_x(0,t)\\,$ and $\\,Tu_x(1,t)$, $\\,$respectively, $\\,$by allowing the ends of the string to slide vertically on frictionless sleeves, $\\,$the boundary conditions become\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  u_x(0,t)&=0 \\\\ \n",
        "  u_x(1,t)&=0\n",
        "  \\end{aligned}, \\quad 0 < t < \\infty$$\n",
        "\n",
        "  ![](figures/pde02_figure12.jpg \"free BC\"){width=\"70%\" fig-align=\"center\"}\n",
        "\n",
        "  If a vertical force $f(t)$ is applied at the end $x=1$, $\\,$then the BC would be \n",
        "\n",
        "  $$u_x(1,t)=\\frac{1}{T}\\,f(t)$$\n",
        "\n",
        "* **Third Kind: $\\,$Elastic Attachment on the Boundaries**\n",
        "\n",
        "  Consider finally a violin string whose ends are attached to an elastic arrangement like the one shown in figure\n",
        "\n",
        "  ![](figures/pde02_figure13.jpg \"elastic attachment\"){width=\"60%\" fig-align=\"center\"}\n",
        "\n",
        "  Here, $\\,$the spring attachments at each end give rise to vertical forces proportional to the displacements $\\,-u(0,t)\\,$ and $\\,-u(1,t)$\n",
        "\n",
        "  Setting the vertical tensions of the spring at the two ends $\\,-Tu_x(0,t)\\,$ and $\\,Tu_x(1,t)\\,$ equal to these displacements (multiplied by the spring constant $h$) gives us our desired BCs\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  -T u_x(0,t) &= -hu(0,t)\\\\ \n",
        "  Tu_x(1,t) &= -hu(1,t) \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  We can rewrite these two homogeneous BCs as\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  u_x(0,t) -\\frac{h}{T} u(0,t) &=0\\\\ \n",
        "  u_x(1,t) +\\frac{h}{T} u(1,t) &=0 \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  If the two spring attachments are displaced according to the functions $\\,\\theta_1(t)\\,$ and $\\,\\theta_2(t)$, $\\,$we would have the nonhomogeneous BCs\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  u_x(0,t) &=\\frac{h}{T} \\left[u(0,t) -\\theta_1(t) \\right]\\\\ \n",
        "  u_x(1,t) &=-\\frac{h}{T} \\left[u(1,t) -\\theta_2(t) \\right] \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  ![](figures/pde02_figure14.jpg \"nonhomogeneous elastic attachment\"){width=\"80%\" fig-align=\"center\"}\n",
        "\n",
        "$~$\n",
        "\n",
        "**NOTE** $\\,$What is the general nature of BC\n",
        "\n",
        "$$ u_x(0,t) =\\frac{h}{T} \\left[u(0,t) -\\theta_1(t) \\right]$$\n",
        "\n",
        "when $~h \\to \\infty$ and $~h \\to 0$\n",
        "\n",
        "$~$\n",
        "\n",
        "## The Finite Vibrating String (Standing Waves) {#sec-x2-23}\n",
        "\n",
        "* So far, $\\,$we have studied the wave equation $\\,u_{tt}=c^2 u_{xx}\\,$ <font color=\"red\">for the unbounded domain</font> and have found D'Alembert solutions to be certain <font color=\"red\">*traveling waves* (moving in opposite directions)</font>\n",
        "\n",
        "* When we study the same wave equation <font color=\"red\">in a bounded region of space $0 < x < L$</font>, $\\,$we find that the waves no longer appear to be moving due to their repeated interaction with the boundaries and, in fact, often appear to be what are known as <font color=\"red\">*standing waves*</font>\n",
        "\n",
        "* **Separation of Variables Solution to the Finite Vibrating String**\n",
        "\n",
        "  Consider what happens when a guitar string (fixed at both ends $x=0,\\,L$) described by the simple hyperbolic IBVP is set in motion\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    u_{tt} &=c^2 u_{xx} && \\color{red}{0 < x < L},\\;\\; 0 < t < \\infty \\\\ \\\\\n",
        "    \\begin{array} {r}\n",
        "      u(0, t) \\\\ u(1,t)\n",
        "    \\end{array}\n",
        "    &\\;\n",
        "    \\begin{array} {r}\n",
        "      =0 \\\\ =0\n",
        "    \\end{array}\n",
        "    && 0 < t < \\infty \\\\ \\\\\n",
        "    \\begin{array} {r}\n",
        "      u(x, 0) \\\\ u_t(x, 0)\n",
        "    \\end{array}\n",
        "    &\\;\n",
        "    \\begin{array} {r}\n",
        "      =f(x) \\\\ =g(x)\n",
        "    \\end{array}\n",
        "    && 0 \\leq x \\leq L\n",
        "  \\end{aligned} \\tag{FS}\\label{eq:FS}$$\n",
        "\n",
        "  * What happens is that the traveling wave solution to the PDE and IC keeps reflecting from the boundaries in such a way that the wave motion does not to be moving, $\\,$but, $\\,$in fact, appears to be vibrating in one position:\n",
        "\n",
        "    ![](figures/pde02_figure15.jpg \"Standing Waves\"){width=\"60%\" fig-align=\"center\"}\n",
        "\n",
        "  * We start by seeking standing-wave solutions to the PDE; $\\,$that is solutions of the form\n",
        "\n",
        "    $$u(x,t)=X(x)T(t)$$\n",
        "\n",
        "    Substituting this expression into the wave equation and separating variables gives us the two ODEs\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "      \\frac{\\;\\;T''}{c^2 T} \n",
        "      &= \\frac{\\;\\;X''}{X} = - \\lambda <0\\\\\n",
        "      &\\Downarrow \\\\\n",
        "      T'' +c^2\\lambda T &=0\\\\ \n",
        "      X'' +\\lambda X &=0 \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    in which only positive values of $\\lambda$ give feasible (nonzero and bounded) solutions\n",
        "\n",
        "  * The solutions of these two ODEs yield\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    T(t) &= a \\cos c\\sqrt{\\lambda} t +b\\sin c\\sqrt{\\lambda}t\\\\ \n",
        "    X(x)&=d \\cos \\sqrt{\\lambda}x +e\\sin\\sqrt{\\lambda}x \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    Plugging this equation into $u(0,t)=u(L,t)=0\\,$ gives\n",
        "\n",
        "    $$\\scriptsize\n",
        "    \\begin{aligned}\n",
        "      u(0,t) \n",
        "      & = d \\cdot \\,T(t)=0 \\;\\;\\Rightarrow \\;\\; T(t) \\neq 0,\\;\\;d=0\\\\ \n",
        "      u(L,t)\n",
        "      & = e\\sin\\sqrt{\\lambda}L \\cdot T(t)=0\\;\\; \\Rightarrow T(t) \\neq 0,\\;\\; e\\neq0, \\;\\sin\\sqrt{\\lambda}L=0\\;\\;\\\\ \n",
        "    &\\normalsize\\Rightarrow \\;\\;\\lambda_n=\\left( \\frac{n\\pi}{L}\\right)^2,\\;\\;n=1,2,3,\\cdots\n",
        "    \\end{aligned}$$\n",
        "\n",
        "    Hence, $\\,$we have now found a sequence of simple vibrations (which we subscript with $n$)\n",
        "\n",
        "    $$ \\begin{aligned} u_n(x,t)&= T_n(t)X_n(x) \\\\=&\\left[ a_n \\cos\\frac{n\\pi c t}{L} +b_n \\sin \\frac{n\\pi c t}{L} \\right]\\,\\sin \\frac{n\\pi x}{L}, \\;\\;n=1,2,3,\\cdots \\end{aligned}$$\n",
        "\n",
        "  * All of which satisfy the wave equation and the BCs, $\\,$and constitute a family of standing waves. $\\,$Since any sum of these vibrations is also a solution to the PDE and BCs (since the PDE and BCs are linear and homogeneous), $\\,$we add them together in such a way that the resulting sum also agrees with the ICs. $\\,$Substituting the sum\n",
        "\n",
        "    $$ u(x,t)= \\sum_{n=1}^\\infty \\left[ a_n \\cos\\frac{n\\pi c t}{L} +b_n \\sin \\frac{n\\pi c t}{L} \\right]\\,\\sin \\frac{n\\pi x}{L}$$ \n",
        "\n",
        "    into the ICs\n",
        "\n",
        "    $$u(x,0)=f(x), \\;\\; u_t(x,0)=g(x)$$\n",
        "\n",
        "    gives the two equations\n",
        "    $$ \\sum_{n=1}^\\infty a_n \\sin \\frac{n\\pi x}{L}=f(x), \\;\\; \n",
        "    \\sum_{n=1}^\\infty b_n \\frac{n\\pi c}{L}\\sin\\frac{n\\pi x}{L}=g(x)$$\n",
        "\n",
        "  * and using the orthogonality condition\n",
        "\n",
        "    $$\\int_0^L \\sin \\frac{m\\pi x}{L}\\, \\sin \\frac{n\\pi x}{L}\\,dx=\\begin{cases}\n",
        "    \\;\\;0& m \\neq n \\\\ \n",
        "    L/2& m = n\n",
        "    \\end{cases}$$\n",
        "\n",
        "    we can find the coefficients $\\,a_n\\,$ and $\\,b_n$\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    a_n&= \\frac{2}{L} \\int_0^L f(x)\\, \\sin \\frac{n\\pi x}{L}\\,dx\\\\\n",
        "    b_n&= \\frac{2}{n\\pi c} \\int_0^L g(x)\\, \\sin \\frac{n\\pi x}{L}\\,dx \n",
        "    \\end{aligned}$$\n",
        "\n",
        "**NOTE**\n",
        "\n",
        "$$\\scriptsize\\begin{aligned}\n",
        "\\normalsize u(x,t) \\;&\\normalsize= \\sum_{n=1}^\\infty \\left[ a_n \\cos\\frac{n\\pi c t}{L} +b_n \\sin \\frac{n\\pi c t}{L} \\right]\\,\\sin \\frac{n\\pi x}{L}\\\\[5pt]\n",
        " &= \\frac{1}{2} \\sum_{n=1}^\\infty a_n\\left[\\sin \\frac{n\\pi}{L} (x+ct) +\\sin \\frac{n\\pi}{L} (x-ct)\\right ] \n",
        "\\\\&\\quad-\\frac{1}{2} \\sum_{n=1}^\\infty b_n\\left[\\cos \\frac{n\\pi}{L} (x+ct) -\\cos \\frac{n\\pi}{L} (x-ct)\\right ]\\\\[5pt] \n",
        " &\\;\\;\\Big\\Downarrow \\;\\; {\\tiny\\sum_{n=1}^\\infty a_n \\sin \\frac{n\\pi x}{L}=f(x), \\;\\;\\sum_{n=1}^\\infty b_n \\frac{n\\pi c}{L}\\sin\\frac{n\\pi x}{L}=g(x) \\;\\rightarrow\\, -\\sum_{n=1}^\\infty b_n\\, c\\cos \\frac{n\\pi x}{L} +\\sum_{n=1}^\\infty b_n c=\\int^x_0 g(\\alpha) d\\alpha} \\\\[5pt]\n",
        " &\\normalsize= \\frac{1}{2}\\left[ f(x+ct) +f(x-ct)\\right] +\\frac{1}{2c} \\int_{x-ct}^{x+ct} g(\\alpha)\\,d\\alpha \n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$Find the solution to the vibrating-string problem \\eqref{eq:FS} if the ICs are given by\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u(x,0) &= \\sin \\frac{\\pi x}{L} +0.5 \\sin\\frac{3\\pi x}{L}\\\\ \n",
        " u_t(x,0) &= 0\n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$What is the solution of the vibrating-string problem \\eqref{eq:FS} if the ICs are\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u(x,0)&= 0\\\\ \n",
        " u_t(x,0)&= \\sin\\frac{3\\pi x}{L}\n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$Solve the damped vibrating-string problem\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "  u_{tt} &=c^2 u_{xx} -\\beta u_t && \\color{red}{0 < x < 1},\\;\\; 0 < t < \\infty \\\\ \\\\\n",
        "  \\begin{array} {r}\n",
        "    u(0, t) \\\\ u(1,t)\n",
        "  \\end{array}\n",
        "   &\n",
        "  \\begin{array} {r}\n",
        "    =0 \\\\ =0\n",
        "  \\end{array}\n",
        "  && 0 < t < \\infty \\\\ \\\\\n",
        "  \\begin{array} {r}\n",
        "    u(x, 0) \\\\ u_t(x, 0)\n",
        "  \\end{array}\n",
        "   &\n",
        "  \\begin{array} {r}\n",
        "    =f(x) \\\\ =0\\phantom{(x)}\n",
        "  \\end{array}\n",
        "  && 0 \\leq x \\leq 1\n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Solution of Nonhomogeneous Wave Equation via the Finite Transform {#sec-x2-24}\n",
        "\n",
        "* Consider the nonhomogeneous wave equation\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    u_{tt} &=c^2 u_{xx} +\\sin\\pi x && 0 < x < 1,\\;\\; 0 < t < \\infty \\\\ \\\\\n",
        "    \\begin{array} {r}\n",
        "      u(0, t) \\\\ u(1,t)\n",
        "    \\end{array}\n",
        "    &\n",
        "    \\begin{array} {r}\n",
        "      =0 \\\\ =0\n",
        "    \\end{array}\n",
        "    && 0 < t < \\infty \\\\ \\\\\n",
        "    \\begin{array} {r}\n",
        "      u(x, 0) \\\\ u_t(x, 0)\n",
        "    \\end{array}\n",
        "    &\n",
        "    \\begin{array} {r}\n",
        "      =1 \\\\ =0\n",
        "    \\end{array}\n",
        "    && 0 \\leq x \\leq 1\n",
        "  \\end{aligned}$$\n",
        "\n",
        "**STEP 1** $\\,$ Determine the transform\n",
        "\n",
        "Since the $x$-variable ranges from $0$ to $1$, $\\,$we use a finite transform. $\\,$Also, $\\,$you will see why, $\\,$in this case, we use the sine transform. $\\,$We could solve this problem with the Laplace transform by transforming $\\,t$\n",
        "\n",
        "**STEP 2** $\\,$ Carry out the transformation\n",
        "\n",
        "$$\\begin{aligned}\n",
        " \\mathcal{F}_s [u_{tt}]&= c^2\\mathcal{F}_s [u_{xx}] +\\mathcal{F}_s [\\sin\\pi x] \\\\ \n",
        " &\\Downarrow \\\\ \n",
        " \\frac{d^2 U_n(t)}{dt^2}&= -(n\\pi c)^2 U_n(t) +2n\\pi c^2\\left[ u(0,t) -(-1)^n u(1,t) \\right] +S_n(t) \\\\\n",
        " &\\Downarrow\\; u(0,t)=0, \\;\\;u(1,t)=0 \\\\\n",
        " \\frac{d^2 U_n(t)}{dt^2}&= -(n\\pi c)^2 U_n(t) +S_n(t)\n",
        "\\end{aligned}$$\n",
        "\n",
        "where\n",
        "\n",
        "$$ S_n(t) = 2 \\int_0^1 \\sin \\pi x \\, \\sin n\\pi x \\,dx =\n",
        "\\begin{cases}\n",
        " 1 & n=1 \\\\ \n",
        " 0 & n=2,3,\\cdots\n",
        "\\end{cases}$$\n",
        "\n",
        "If we now transform the initial conditions, $\\,$we will arrive at the initial conditions for our ODE\n",
        "\n",
        "$$\\begin{aligned}\n",
        " \\mathcal{F}_s [u(x,0)]&= U_n(0) =\n",
        " \\begin{cases}\n",
        " \\displaystyle \\frac{4}{n\\pi} & n=1,3,\\cdots \\\\ \n",
        " \\;\\,0 & n=2,4,\\cdots \n",
        "\\end{cases}\\\\ \n",
        " \\mathcal{F}_s [u_t(x,0)]&= \\frac{dU_n(0)}{dt} =0\n",
        "\\end{aligned}$$ \n",
        "\n",
        "So, $\\,$solving our new initial-value problem, $\\,$we have\n",
        "\n",
        "$$\\begin{aligned}\n",
        " U_1(t)&= \\left( \\frac{4}{\\pi} -\\frac{1}{\\pi^2} \\right) \\,\\cos\\pi c t +\\frac{1}{\\pi^2}\\\\ \n",
        " U_n(t) &= \\begin{cases}\n",
        " \\quad\\;\\; 0 & n=2,4,\\cdots \\\\ \n",
        " \\displaystyle \\frac{4}{n\\pi}\\cos n\\pi c t & n=3,5,\\cdots \n",
        "\\end{cases} \n",
        "\\end{aligned}$$\n",
        "\n",
        "Hence, $\\,$the solution $\\,u(x,t)$ of the problem is\n",
        "\n",
        "$$ u(x,t)=\\left[ \\left( \\frac{4}{\\pi} -\\frac{1}{\\pi^2} \\right) \\,\\cos\\pi c t +\\frac{1}{\\pi^2} \\right]\\,\\sin \\pi x \n",
        "+\\frac{4}{\\pi} \\sum_{n=1}^\\infty \\frac{1}{2n +1} \\cos(2n +1)\\pi c t \\, \\sin(2n +1)\\pi x$$\n",
        "\n",
        "## The Vibrating Drumhead (Wave Equation in Polar Coordinates) {#sec-x2-25}\n",
        "\n",
        "* The problem is to find $\\,u(r,\\theta,t)$ (which stands for the height of the drumhead from the plane) that satisfies\n",
        "\n",
        "  $$\\color{red}{\\begin{aligned}\n",
        "  u_{tt} &= c^2 \\left( u_{rr} +\\frac{1}{r} u_r +\\frac{1}{r^2} u_{\\theta\\theta} \\right) && \\\\ \n",
        "  u(1, \\theta, t) &= 0 && 0 < t < \\infty \\\\ \n",
        "  u(r, \\theta, 0) &= f(r,\\theta) && 0 < r < 1\\\\ \n",
        "  u_t(r, \\theta, 0) &= g(r,\\theta) &&\n",
        "  \\end{aligned}}$$\n",
        "\n",
        "  We will look for solutions of the form\n",
        "\n",
        "  $$\\color{blue}{u(r,\\theta,t)=U(r,\\theta)T(t)}$$\n",
        "\n",
        "  This gives the shape $\\,U(r,\\theta)$ of the vibrations times the oscillatory factor $\\,T(t)$\n",
        "\n",
        "* Carrying out this substitution, $\\,$we arrive at the two equations\n",
        "\n",
        "  $$\\scriptsize\\begin{aligned}\n",
        "  { u_{tt}} &{ = c^2 \\left( u_{rr} +\\frac{1}{r} u_r +\\frac{1}{r^2} u_{\\theta\\theta} \\right)}\\\\ \n",
        "  &\\Downarrow \\\\ \n",
        "  { UT''} &= { c^2 \\left( U_{rr} +\\frac{1}{r}U_r +\\frac{1}{r^2}U_{\\theta\\theta} \\right) T}  \\\\\n",
        "  &\\Downarrow \\\\ \n",
        "  { \\frac{\\;\\;T''}{c^2T}} &={\\frac{\\displaystyle U_{rr} +\\frac{1}{r}U_r +\\frac{1}{r^2}U_{\\theta\\theta}}{U} =-\\lambda < 0} \\\\\n",
        "  &\\Downarrow \\\\\n",
        "  \\normalsize\\color{red}{T''} &\\normalsize\\color{red}{+ c^2 \\lambda T =0} && \\text{Simple Harmonic Motion}\\\\\n",
        "  \\normalsize\\color{red}{U_{rr}} &\\normalsize\\color{red}{+\\frac{1}{r}U_r +\\frac{1}{r^2}U_{\\theta\\theta} +\\lambda U=0} && \\text{Helmholtz Equation}\n",
        "  \\end{aligned}$$\n",
        "\n",
        "* For the next step, $\\,$we want to solve the Helmholtz equation, $\\,$but, $\\,$first, $\\,$it needs a boundary condition. $\\,$To find it, $\\,$we substitute $\\,u(r,\\theta,t)=U(r,\\theta)T(t)$ $\\,$into the boundary condition of the drumhead to get\n",
        "\n",
        "  $$\\color{red}{u(1,\\theta,t)=U(1,\\theta)T(t)=0 \\;\\;\\Rightarrow\\;\\;U(1,\\theta)=0}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Solution of the Helmholtz Eigenvalue Problem**\n",
        "\n",
        "  * To solve\n",
        "\n",
        "    $$\\color{blue}{\\begin{aligned}\n",
        "    &U_{rr} +\\frac{1}{r}U_r +\\frac{1}{r^2}U_{\\theta\\theta} +\\lambda U=0\\\\ \n",
        "    &U(1,\\theta)=0 \n",
        "    \\end{aligned}}$$\n",
        "\n",
        "    we let\n",
        "\n",
        "    $$\\color{red}{U(r,\\theta)=R(r)\\Theta(\\theta)}$$\n",
        "\n",
        "    and plug it into the Helmholtz BVP\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    U_{rr} +\\frac{1}{r}U_r &+\\frac{1}{r^2}U_{\\theta\\theta} +\\lambda U=0\\\\ \n",
        "    &\\Downarrow U(r,\\theta)=R(r)\\Theta(\\theta)\\\\\n",
        "    R''\\Theta +\\frac{1}{r}R' \\Theta &+\\frac{1}{r^2}R \\Theta'' +\\lambda R\\Theta = 0 \\\\\n",
        "    &\\Downarrow \\\\\n",
        "    -\\frac{r^2 R'' +rR' +\\lambda r^2R}{R} &= \\frac{\\;\\Theta''}{\\Theta} = -\\mu <0 \\\\\n",
        "    &\\Downarrow \\\\\n",
        "    \\color{red}{\\Theta'' +\\mu \\Theta} &\\color{red}{=0} \\\\\n",
        "    \\color{red}{r^2 R'' +rR'} &\\color{red}{+(\\lambda r^2 -\\mu) R =0}\n",
        "    \\end{aligned}$$\n",
        "\n",
        "    We get a new separation constant $\\,\\mu$\n",
        "\n",
        "  * It's obvious that <font color=\"red\">the drumhead is periodic with period $\\,2\\pi\\,$ in $\\,\\theta.$</font> $\\,$Thus\n",
        "\n",
        "    $$\\scriptsize\\begin{aligned}\n",
        "    \\Theta'' &+\\mu\\Theta = 0 \\\\\n",
        "    &\\Downarrow \\\\\n",
        "    \\Theta(\\theta) &= a \\cos\\sqrt{\\mu}\\theta +b\\sin\\sqrt{\\mu}\\theta \\\\ \n",
        "    &\\Downarrow \\;{\\scriptstyle \\Theta(0)=\\Theta(2\\pi),\\;\\;\\Theta'(0)=\\Theta'(2\\pi)} \\\\ \n",
        "    \\begin{bmatrix}\n",
        "      1 -\\cos 2\\pi\\sqrt{\\mu} & -\\sin 2\\pi\\sqrt{\\mu} \\\\ \n",
        "      \\sqrt{\\mu} \\sin 2\\pi\\sqrt{\\mu} & \\sqrt{\\mu}\\left(1 -\\cos 2\\pi\\sqrt{\\mu}\\right)\n",
        "    \\end{bmatrix} &\\begin{bmatrix} a \\\\ b \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} \\\\ \\;\\;&\\overset{\\text{non-trivial solution}}{\\longrightarrow} \\;\\; \n",
        "      {\\tiny \\sqrt{\\mu}(1 -\\cos 2\\pi\\sqrt{\\mu})^2 +\\sqrt{\\mu} \\sin^2 2\\pi\\sqrt{\\mu}=0 \\;\\rightarrow\\;1=\\cos 2\\pi\\sqrt{\\mu} } \\\\\n",
        "    &\\Downarrow \\\\\n",
        "    \\color{red}{\\mu}\\, &\\color{red}{= n^2, \\;\\;n=0,1,2,\\cdots} \\\\\n",
        "    &\\Downarrow \\\\ \n",
        "    \\color{red}{\\Theta_n(\\theta)}\\, &\\color{red}{= a_n \\cos n\\theta +b_n\\sin n\\theta} \\\\\n",
        "    &=\\sqrt{a_n^2 +b_n^2} \\left(\\cos n\\theta \\cos \\phi +\\sin n\\theta \\sin \\phi \\right),\\;\\;\\tan \\phi=\\frac{b_n}{a_n} \\\\\n",
        "    &\\color{red}{=c_n \\cos (n\\theta -\\phi)}\n",
        "    \\end{aligned}$$\n",
        "\n",
        "  * So, in order to solve the Helmholtz equation, $~$we must solve the following differential equation\n",
        "\n",
        "    $$\\color{red}{\\begin{aligned}\n",
        "      r^2 R_n''\\, +\\,&rR_n' +(\\lambda r^2 -n^2) R_n =0, \\;\\;\\;0<r<1 \\\\ \n",
        "      \\left |  R_n(0)\\right| &< \\infty \\\\\n",
        "      R_n(1)\\phantom{|} &= 0 \n",
        "    \\end{aligned}}$$\n",
        "\n",
        "    It is the parameterized Bessel's equation and has two linearly independent solutions $\\color{red}{J_n(\\sqrt{\\lambda}r)}$ and $\\color{red}{Y_n(\\sqrt{\\lambda}r)}$\n",
        "\n",
        "$~$"
      ],
      "id": "7525b9ca"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| label: fig-Bessel-functions\n",
        "#| fig-cap: Bessel's functions\n",
        "#| fig-align: center\n",
        "from scipy.special import jv, yv, jn_zeros\n",
        "\n",
        "fig = plt.figure(figsize=(6, 8))\n",
        "ax1 = fig.add_subplot(211)\n",
        "ax2 = fig.add_subplot(212)\n",
        "\n",
        "ax1.axis((0, 10, -0.6, 1))    \n",
        "ax1.set_ylabel('$J_n$')\n",
        "\n",
        "ax2.axis((0, 10, -3, 1))    \n",
        "ax2.set_xlabel(r'$\\sqrt{\\lambda}$')\n",
        "ax2.set_ylabel('$Y_n$')\n",
        "\n",
        "ax1.plot([0, 10], [0, 0], 'k:')\n",
        "ax2.plot([0, 10], [0, 0], 'k:')\n",
        "\n",
        "x = np.linspace(0, 10, 200)\n",
        "for n in range(4):\n",
        "    y1 = jv(n, x)\n",
        "    y2 = yv(n, x)\n",
        "    ax1.plot(x, y1, label=rf'$J_{n:d}(\\sqrt{{\\lambda}})$')\n",
        "    ax2.plot(x, y2, label=rf'$Y_{n:d}(\\sqrt{{\\lambda}})$')\n",
        "\n",
        "ax1.legend(bbox_to_anchor=(1.01, 1), loc='upper left')\n",
        "ax2.legend(bbox_to_anchor=(1.01, 1), loc='upper left')\n",
        "\n",
        "plt.show()"
      ],
      "id": "fig-Bessel-functions",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "* * Since the functions $Y_n(\\sqrt{\\lambda} r)$ are unbounded at $r=0$, $\\,$we choose as our solution $J_n(\\sqrt{\\lambda} r)$. $\\,$The last step in finding $R_n(r)$ is to use the boundary condition $R_n(1)=0~$ to find $\\lambda$. $\\,$We must pick $\\lambda$ to be one of <font color=\"red\">the roots of</font> $\\,\\color{red}{J_n(\\sqrt{\\lambda})=0}$; $\\,$that is\n",
        "\n",
        "    $$\\color{red}{\\sqrt{\\lambda_{nm}}=\\alpha_{nm}}$$\n",
        "\n",
        "    where $\\,\\alpha_{nm}$ is the $m$-th root of $\\,J_n(r)=0$, $~m=1,2,3,\\cdots$.\n",
        "$\\,$With these roots, $\\,$we have just solved the Helmholtz eigenvalue problem\n",
        "\n",
        "  * <font color=\"red\">The eigenvalues $\\,\\lambda_{nm}$ are $\\,\\alpha_{nm}^2$; $\\,$and the corresponding eigenfunctions are</font>\n",
        "\n",
        "    $$\\color{red}{U_{nm}(r,\\theta) =c_n J_n(\\alpha_{nm} r) \\cos (n\\theta -\\phi), \\;\\;\\;n=0,1,2,\\cdots, \\;\\;m=1,2,3,\\cdots}$$\n",
        "\n",
        "    The general shape of $\\,U_{nm}(r,\\theta)\\,$ is the same for different values of the constants $\\,c_n\\,$ and $\\,\\phi.$ $\\,$We plot these functions for the different values of $\\,n$ and $\\,m$ with $\\,c_n=1\\,$ and $\\,\\phi=0$\n",
        "\n",
        "$~$    "
      ],
      "id": "668e2a70"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| label: fig-Helmholtz\n",
        "#| fig-cap: 'Helmholtz Eigenfunctions: $\\,U_{nm}(r, \\theta)$'\n",
        "#| fig-align: center\n",
        "ncols = 4\n",
        "nrows = 4\n",
        "    \n",
        "fig, axs = plt.subplots(ncols=ncols, \n",
        "    nrows=ncols, figsize=(7, 7), \n",
        "    subplot_kw=dict(projection='polar'))\n",
        "\n",
        "for ax in axs.flat:\n",
        "    ax.set(xticks=[], yticks=[])\n",
        "\n",
        "azimuths = np.radians(np.linspace(0, 360, 100))\n",
        "zeniths = np.linspace(0, 1, 100)\n",
        "\n",
        "theta, r = np.meshgrid(azimuths, zeniths)\n",
        "\n",
        "for n in range(ncols):\n",
        "    alpha_nm = jn_zeros(n, nrows)\n",
        "    for m in range(nrows):\n",
        "        U_nm = jv(n, alpha_nm[m] *r) *np.cos(n *theta)\n",
        "        axs[n, m].contourf(theta, r, U_nm, levels=[0, 10])\n",
        "        if m == 0:\n",
        "            axs[n, 0].set_ylabel(f'n = {n}') \n",
        "        if n == 0:\n",
        "            axs[nrows -1, m].set_xlabel(f'm = {m +1}')\n",
        "  \n",
        "plt.show()"
      ],
      "id": "fig-Helmholtz",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "* Now that we have solved the Helmholtz equation for the basic shapes $\\,U_{nm}(r,\\theta)$, $\\,$the final step is to multiply by the time factor\n",
        "\n",
        "  $$\\color{red}{T_{nm}(t)=A_{nm}\\cos c\\alpha_{nm}t +B_{nm}\\sin c\\alpha_{nm} t}$$\n",
        "\n",
        "  and add the products in such a way that the initial conditions are satisfied. $\\,$That is, $\\,$the solution to our problem will be\n",
        "\n",
        "  $$ \\color{red}{u(r,\\theta,t) = \\sum_{n=0}^\\infty \\sum_{m=1}^\\infty J_n(\\alpha_{nm}r) \\cos n\\theta \\left[ A_{nm}\\cos c\\alpha_{nm}t +B_{nm}\\sin c\\alpha_{nm}t \\right]}$$\n",
        "\n",
        "  Rather than going through the complicated process of finding $\\,A_{nm}\\,$ and $\\,B_{nm}\\,$ for the general case, $\\,$<font color=\"blue\">we will find the solution for the situation where $\\,u\\,$ is independent of $\\,\\theta$ (very common, $\\,n=0$). $\\,$In other words, $\\,$we will assume that the initial position of the drumhead depends only on $\\,r$</font>\n",
        "\n",
        "* In particular, $\\,$we consider\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  u(r,\\theta,0) &= \\color{red}{f(r)}\\\\ \n",
        "  u_t(r,\\theta,0) &= 0 \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  (It's just easy to do the case where $\\,u_t \\neq 0$). $\\,$With these assumptions, $\\,$the solution now becomes\n",
        "\n",
        "  $$ u(r,t) = \\sum_{m=1}^\\infty A_{\\color{red}{0}m} J_{\\color{red}{0}}(\\alpha_{\\color{red}{0}m}r) \\cos c\\alpha_{\\color{red}{0}m}t$$\n",
        "\n",
        "  and our goal is to find $\\,A_{0m}\\,$ so that\n",
        "\n",
        "  $$ \\color{blue}{f(r) = \\sum_{m=1}^\\infty \\color{red}{A_{0m}} J_0(\\alpha_{0m}r)} \\tag{IC}\\label{eq:IC}$$ \n",
        "\n",
        "* To find the constants $\\,A_{0m}$, $\\,$we use the orthogonality condition of the Bessel functions:\n",
        "\n",
        "  $$\\int_0^1 rJ_0(\\alpha_{0i} r)\\,J_0(\\alpha_{0j} r) \\,dr = \n",
        "  \\begin{cases}\n",
        "  0 & i \\neq j \\\\ \n",
        "  \\frac{1}{2}J_1^2(\\alpha_{0i}) & i=j \n",
        "  \\end{cases}$$\n",
        "\n",
        "  Hence, $\\,$we multiply each side of equation \\eqref{eq:IC} by $\\,rJ_0(\\alpha_{0j}r)\\,$ and integrate from $\\,0\\,$ to $\\,1\\,$, $\\,$giving \n",
        "\n",
        "  $$ \\int_0^1 rf(r)J_0(\\alpha_{0j}r)\\,dr = A_{0j} \\int_0^1 r J_0^2(\\alpha_{0j}r)\\,dr $$\n",
        "\n",
        "  from which we can solve for $\\,A_{0j}$\n",
        "\n",
        "  $$ \\color{red}{A_{0j}=\\frac{2}{J_1^2(\\alpha_{0j})} \\int_0^1 rf(r)J_0(\\alpha_{0j}r)\\,dr, \\;\\;j =1,2,3,\\cdots} $$\n",
        "\n",
        "* **For example** $\\,$the solution to the vibrating drumhead with initial conditions\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  u(r,\\theta,0) &= J_0(2.405 r) +0.5 J_0(8.654 r)\\\\ \n",
        "  u_t(r,\\theta,0) &= 0\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  would be\n",
        "\n",
        "  $$ u(r,t) = J_0(2.405 r) \\cos(2.405 ct) +0.5 J_0(8.654 r)\\cos(8.654 ct) $$\n",
        "\n",
        "* We start by drawing $\\,J_0(\\sqrt{\\lambda})$. $\\,$Now, $\\,$in order to graph the functions\n",
        "\n",
        "  $$J_0(\\alpha_{01}r), \\,J_0(\\alpha_{02}r), \\,\\cdots,\\, J_0(\\alpha_{0m}r)$$ \n",
        "  \n",
        "  we rescale the $\\,r$-axis so that $\\,m$-th root passes through $\\,r=1$\n",
        "\n",
        "$~$"
      ],
      "id": "4ba08608"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| fig-align: center\n",
        "from mpl_toolkits.axisartist.axislines import SubplotZero\n",
        "\n",
        "fig = plt.figure(figsize=(7, 8))\n",
        "ax1 = SubplotZero(fig, 211)\n",
        "ax2 = SubplotZero(fig, 212)\n",
        "\n",
        "fig.add_subplot(ax1)\n",
        "ax1.axis[\"left\", \"right\", \"bottom\", \"top\"].set_visible(False)\n",
        "ax1.axis[\"xzero\", \"yzero\"].set_visible(True)\n",
        "ax1.axis[\"xzero\", \"yzero\"].set_axisline_style(\"-|>\")\n",
        "\n",
        "ax1.set_xticks([2, 4, 6, 8, 10])\n",
        "ax1.set_ylim(-0.5, 1.1)\n",
        "ax1.set_yticks([-0.5, 0.5, 1.0])\n",
        "ax1.text(11, -0.03, r'$\\sqrt{\\lambda}$', fontsize=14)\n",
        "\n",
        "fig.add_subplot(ax2)\n",
        "ax2.axis[\"left\", \"right\", \"bottom\", \"top\"].set_visible(False)\n",
        "ax2.axis[\"xzero\", \"yzero\"].set_visible(True)\n",
        "ax2.axis[\"xzero\", \"yzero\"].set_axisline_style(\"-|>\")\n",
        "\n",
        "ax2.set_xticks([0.2, 0.4, 0.6, 0.8, 1.0])\n",
        "ax2.set_ylim(-0.5, 1.1)   \n",
        "ax2.set_yticks([-0.5, 0.5, 1.0])\n",
        "ax2.text(1.1, -0.03, '$r$', fontsize=12)\n",
        "\n",
        "mm = 3\n",
        "alpha_0m =jn_zeros(0, mm)\n",
        "\n",
        "r1 = np.linspace(0, 10, 100)\n",
        "y1 = jv(0, r1)\n",
        "ax1.plot(r1, y1, label=r'$J_0(\\sqrt{\\lambda})$')\n",
        "ax1.plot(alpha_0m, np.zeros(mm), 'ro')\n",
        "\n",
        "for m in range(mm):\n",
        "    ax1.text(alpha_0m[m] -0.2, 0.1, rf'$\\alpha_{m +1}$', fontsize=12)\n",
        "ax1.legend()\n",
        "\n",
        "r2 = np.linspace(0, 1, 100)\n",
        "for m in range(mm):   \n",
        "    y2 = jv(0, alpha_0m[m]*r2)\n",
        "    ax2.plot(r2, y2, label=rf'$J_0(\\alpha_{m +1}r)$')\n",
        "    ax2.plot(alpha_0m[:m +1] /alpha_0m[m], np.zeros(m +1), 'x')\n",
        "ax2.legend()\n",
        "\n",
        "plt.show()  "
      ],
      "id": "1d35c3d0",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "* In general, $\\,$what we would do is to expand the initial position $\\,f(r)\\,$ into the sum of these basic shapes $\\,J_0(\\alpha_{0m} r)$, $\\,$observe the vibration for each one and then add them up"
      ],
      "id": "781b2570"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "fig = plt.figure(figsize=(7, 5))\n",
        "ax = plt.axes(xlim=(0, 1), ylim=(-1.5, 1.5))\n",
        "\n",
        "ax.set_xticks([0.0, 0.2, 0.4, 0.6, 0.8, 1.0])\n",
        "ax.set_yticks([-1.5, -1.0, -0.5, 0, 0.5, 1.0, 1.5])\n",
        "ax.tick_params(pad=10)\n",
        "ax.set_xlabel('$r$')\n",
        "ax.set_ylabel('$u(r,t)$')\n",
        "\n",
        "plt.close()"
      ],
      "id": "c3dba8c8",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| fig-align: center\n",
        "line1, = ax.plot([], [], lw=1, ls=':')\n",
        "line2, = ax.plot([], [], lw=1, ls=':')\n",
        "line_sum, = ax.plot([], [], lw=4)\n",
        "\n",
        "time_text = ax.text(0.45, 1.3, '')\n",
        "def init():\n",
        "    time_text.set_text('t = 0.0')\n",
        "    line1.set_data([], [])\n",
        "    line2.set_data([], [])\n",
        "    line_sum.set_data([], [])\n",
        "    return (line1, line2, line_sum)\n",
        "\n",
        "c = 1 \n",
        "alpha_0m =jn_zeros(0, 3)\n",
        "\n",
        "def animate(t):\n",
        "    time_text.set_text(f't = {t:.2f}')        \n",
        "    r = np.linspace(0, 1, 100)   \n",
        "\n",
        "    u1 = jv(0, alpha_0m[0] *r) *np.cos(c *alpha_0m[0] *t)\n",
        "    u2 = 0.5 *jv(0, alpha_0m[2] *r) *np.cos(c *alpha_0m[2] *t)\n",
        "    u_sum = u1 +u2    \n",
        "    \n",
        "    line1.set_data(r, u1)\n",
        "    line2.set_data(r, u2)\n",
        "    line_sum.set_data(r, u_sum)\n",
        "    \n",
        "    return (line1, line2, line_sum)\n",
        "\n",
        "tt = np.linspace(0, 10, 100)\n",
        "anim = animation.FuncAnimation(fig, animate, \n",
        "         init_func=init, frames=tt, interval=200, blit=True)\n",
        "\n",
        "HTML('<center>' + anim.to_html5_video() + '</center>')"
      ],
      "id": "946e4082",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "**Example** $\\,$Solve the vibrating drum head problem\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "  u_{tt} &=\\nabla^2 u && 0 < r < 1, \\;\\; 0 < t < \\infty \\\\ \\\\\n",
        "  u(1,\\theta,t) &=0 && 0 < t < \\infty \\\\ \\\\\n",
        "  \\begin{array}{r}\n",
        "    u(r,\\theta,0) \\\\ u_t(r,\\theta,0)\n",
        "  \\end{array}\n",
        "  &\n",
        "  \\begin{array}{l}\n",
        "    = 1 -r^2 \\\\ =0 \\phantom{-r^2}\n",
        "  \\end{array} && 0 \\leq r \\leq 1\n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Dimensionless Problems {#sec-x2-26}\n",
        "\n",
        "* The basic idea behind dimensionless analysis is that by introducing new (dimensionless) variables in a problem, $\\,$the problem becomes **purely mathematical** and contains none of the physical constants that originally characterized it\n",
        "\n",
        "* In this way, $\\,$many different equations in physics, biology, engineering, $\\,$and chemistry that contain special nuances via physical parameters are all transformed into the same simple form\n",
        "\n",
        "* **<font color=\"blue\">Converting a Diffusion Problem to Dimensionless Form</font>**\n",
        "\n",
        "  * Suppose we start with the initial-boundary-value problem:\n",
        "\n",
        "    $$\n",
        "    \\begin{aligned}\n",
        "      u_t &=\\alpha u_{xx} && 0 < x < L, \\;\\; 0 < t < \\infty \\\\[5pt]\n",
        "      \\begin{array}{r}\n",
        "        u(0,t) \\\\ u(L,t)\n",
        "      \\end{array}\n",
        "      &\n",
        "      \\begin{array}{l}\n",
        "        = T_1 \\\\ = T_2\n",
        "      \\end{array} && 0 < t < \\infty \\\\[5pt]\n",
        "      u(x,0) &= \\sin \\frac{\\pi x}{L} && 0 \\leq x \\leq L  \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    Our goal is to change this problem to a new equivalent formulation that has the properties\n",
        "\n",
        "    |   1. No physical parameters (like $\\alpha$) in the new equation\n",
        "    |   2. The initial and boundary conditions are simpler\n",
        "\n",
        "    $~$\n",
        "\n",
        "  * **Transforming the Dependent Variable** $~u \\to U =\\displaystyle\\frac{u(x,t) -T_1}{T_2 -T_1}$ \n",
        "  \n",
        "    $$\n",
        "    \\begin{aligned}\n",
        "      U_t &=\\alpha U_{xx} && 0 < x < L, \\;\\; 0 < t < \\infty \\\\[5pt]\n",
        "      \\begin{array}{r}\n",
        "        U(0,t) \\\\ U(L,t)\n",
        "      \\end{array}\n",
        "      &\n",
        "      \\begin{array}{l}\n",
        "        = 0 \\\\ = 1\n",
        "      \\end{array} && 0 < t < \\infty \\\\[5pt]\n",
        "      U(x,0) &= \\frac{\\displaystyle \\sin \\frac{\\pi x}{L} -T_1}{T_2 -T_1} && 0 \\leq x \\leq L  \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    $~$\n",
        "\n",
        "  * **Transforming the Space Variable** $~x \\to \\xi=\\;^{\\displaystyle x}/_{\\displaystyle L}$\n",
        "\n",
        "    $$\n",
        "    \\begin{aligned}\n",
        "      U_t &=\\frac{\\alpha}{L^2} U_{\\xi\\xi} && 0 < \\xi < 1, \\; 0 < t < \\infty \\\\[5pt]\n",
        "      \\begin{array}{r}\n",
        "        U(0,t) \\\\ U(L,t)\n",
        "      \\end{array}\n",
        "      &\n",
        "      \\begin{array}{l}\n",
        "        = 0 \\\\ = 1\n",
        "      \\end{array} && 0 < t < \\infty \\\\[5pt]\n",
        "      U(\\xi,0) &= \\frac{\\sin\\pi\\xi -T_1}{T_2 -T_1} && 0 \\leq \\xi \\leq 1  \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    $~$\n",
        "\n",
        "  * **Transforming the Time Variable** $\\;\\; t \\to \\tau$\n",
        "\n",
        "    Since our goal is to eliminate the constant $\\displaystyle\\frac{\\alpha}{L^2}$ from the PDE, $\\,$we proceed as follows:\n",
        "\n",
        "    1. Try a transformation of the form $\\tau=ct$, $\\,$where $c$ is an unknown constant\n",
        "    2. Compute $U_t=U_\\tau\\tau_t=cU_\\tau$\n",
        "    3. Substitute this derivative into the the PDE to obtain\n",
        "\n",
        "        $$ cU_\\tau =\\frac{\\alpha}{L^2} U_{\\xi\\xi}$$\n",
        "\n",
        "        and, $\\,$hence, $\\,$pick $\\displaystyle c=\\frac{\\alpha}{L^2}$. \n",
        "      \n",
        "    This give us our new time\n",
        "   \n",
        "    $$ \\tau=\\frac{\\alpha}{L^2} t $$\n",
        "\n",
        "  * We now have the completely dimensionless problem\n",
        "\n",
        "    $$\n",
        "    \\begin{aligned}\n",
        "      U_\\tau &= U_{\\xi\\xi} && 0 < \\xi < 1, \\; 0 < \\tau < \\infty \\\\[5pt]\n",
        "      \\begin{array}{r}\n",
        "        U(0,\\tau) \\\\ U(L,\\tau)\n",
        "      \\end{array}\n",
        "      &\n",
        "      \\begin{array}{l}\n",
        "        = 0 \\\\ = 1\n",
        "      \\end{array} && 0 < t < \\infty \\\\[5pt]\n",
        "      U(\\xi,0) &= \\frac{\\sin\\pi\\xi -T_1}{T_2 -T_1} && 0 \\leq \\xi \\leq 1  \n",
        "    \\end{aligned}$$ \n",
        "\n",
        "$~$\n",
        "\n",
        "* **<font color=\"blue\">Transforming a Hyperbolic Problem to Dimensionless Form</font>**\n",
        "\n",
        "  Consider the vibrating string\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    u_{tt} &=c^2 u_{xx} && 0 < x < L,\\;\\; 0 < t < \\infty \\\\[5pt]\n",
        "    \\begin{array}{r}\n",
        "      u(0,t) \\\\ u(L,t)\n",
        "    \\end{array}\n",
        "    &\n",
        "    \\begin{array}{l}\n",
        "      = 0 \\\\ = 0\n",
        "    \\end{array} && 0 < t < \\infty \\\\[5pt]\n",
        "    \\begin{array}{r}\n",
        "      u(x,0) \\\\ u_t(x,0)\n",
        "    \\end{array}\n",
        "    &\n",
        "    \\begin{array}{l}\n",
        "      = \\sin \\frac{\\pi x}{L} +0.5\\sin \\frac{3\\pi x}{L} \\\\ = 0\n",
        "    \\end{array} && 0 < x < L\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  * By transforming the independent variables (no need to transform $u$) into a new ones\n",
        "\n",
        "    $$ \\xi=\\frac{x}{L}\\; \\text{ and } \\;\\tau=\\frac{c}{L} t $$ \n",
        "\n",
        "    we get the new problem\n",
        "\n",
        "    $$\n",
        "    \\begin{aligned}\n",
        "      u_{\\tau\\tau} & =u_{\\xi\\xi} && 0 < \\xi < 1,\\;\\; 0 < \\tau < \\infty \\\\[5pt]\n",
        "      \\begin{array}{r}\n",
        "        u(0,\\tau) \\\\ u(1,\\tau)\n",
        "      \\end{array}\n",
        "      &\n",
        "      \\begin{array}{l}\n",
        "        = 0 \\\\ = 0\n",
        "      \\end{array} && 0 < \\tau < \\infty \\\\[5pt]\n",
        "      \\begin{array}{r}\n",
        "        u(\\xi,0) \\\\ u_\\tau(\\xi,0)\n",
        "      \\end{array}\n",
        "      &\n",
        "      \\begin{array}{l}\n",
        "        = \\sin \\pi\\xi +0.5\\sin 3\\pi\\xi \\\\ = 0\n",
        "      \\end{array} && 0 < \\xi < 1 \\\\  \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    which has the solution \n",
        "\n",
        "    $$ u(\\xi,\\tau)=\\cos \\pi \\tau \\sin\\pi\\xi +0.5 \\cos 3\\pi \\tau \\sin 3\\pi \\xi $$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$How could you pick a new space variable $\\,\\xi\\,$ so that $\\,v$ is eliminated in the equation\n",
        "\n",
        "$$ u_t +vu_x=0 $$\n",
        "\n",
        "$~$\n",
        "\n",
        "## $~$Classification of PDEs (Cannonical Form of the Hyperbolic Equation) {#sec-x2-27}\n",
        "\n",
        "* The purpose here is to classify the second-order linear PDE \n",
        "\n",
        "  $$ \\color{red}{A}u_{xx} +\\color{red}{B}u_{xy} +\\color{red}{C} u_{yy} +Du_x +Eu_y +Fu = G \\tag{SL}\\label{eq:SL}$$ \n",
        "\n",
        "  in which $A, B, C, D, E, F,$ and $\\,G$ are, in general, functions of $x$ and $y$ in two independent variables and could be constants, as\n",
        "\n",
        "  * <font color=\"red\">Hyperbolic if $\\,B^2 -4AC > 0~$ at $\\,(x,y)$ </font>\n",
        "\n",
        "  * <font color=\"red\">Parabolic $~\\,$ if $\\,B^2 -4AC = 0~$ at $\\,(x,y)$ </font>\n",
        "\n",
        "  * <font color=\"red\">Elliptic $~~~~~\\,$ if $\\,B^2 -4AC < 0~$ at $\\,(x,y)$ </font>  \n",
        "\n",
        "* and depending on which is true, $\\,$<font color=\"blue\">to transform the equation into a corresponding cannonical (simple) form by introducing new coordinates $\\,\\xi=\\xi(x,y)$ $\\,$and $\\,\\eta=\\eta(x,y)$</font>\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    u_{\\xi\\eta} = \\Phi(\\xi,\\eta,u,u_\\xi,u_\\eta) \n",
        "    \\; &\\text{ or } \\; \n",
        "    u_{\\xi\\xi} -u_{\\eta\\eta} = \n",
        "     \\Psi(\\xi,\\eta,u,u_\\xi,u_\\eta) \\\\ \n",
        "    u_{\\eta\\eta} &= \\Phi(\\xi,\\eta,u,u_\\xi,u_\\eta)\\\\ \n",
        "    u_{\\xi\\xi} +u_{\\eta\\eta} &= \\Phi(\\xi,\\eta,u,u_\\xi,u_\\eta)\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  The student should note that whether equation \\eqref{eq:SL} is hyperbolic, parabolic, or elliptic depends *only* on the coefficients of the second derivatives. $\\,$We now come to the major portion of this section; $\\,$rewriting hyperbolic equations in their canonical form\n",
        "\n",
        "* **The Canonical Form of the Hyperbolic Equation**\n",
        "\n",
        "  The objective here is to introduce new coordinates $\\,\\xi=\\xi(x,y)\\,$ and $\\,\\eta=\\eta(x,y)\\,$ so that the general PDE contains only one second derivative $\\,u_{\\xi\\eta}\\,$. $\\,$First of all, $\\,$we compute the partial derivatives\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  Au_{xx} +Bu_{xy} +C u_{yy} &+Du_x +Eu_y +Fu = G \\\\ \n",
        "  &\\Downarrow\\;\\;\n",
        "  \\color{red}{\\xi=\\xi(x,y), \\;\\eta=\\eta(x,y)} \\\\ \n",
        "  u_x =\\; u_\\xi &\\xi_x +u_\\eta \\eta_x \\\\\n",
        "  u_y =\\; u_\\xi &\\xi_y +u_\\eta \\eta_y \\\\  \n",
        "  u_{xx} =\\; u_{\\xi\\xi}& \\xi_x^2 \n",
        "    +2u_{\\xi\\eta}\\xi_x\\eta_x\n",
        "    +u_{\\eta\\eta}\\eta_x^2\n",
        "    +u_\\xi\\xi_{xx}\n",
        "    +u_\\eta\\eta_{xx}\\\\ \n",
        "  u_{xy} =\\;u_{\\xi\\xi}& \\xi_x\\xi_y \n",
        "    +u_{\\xi\\eta}(\\xi_x\\eta_y +\\xi_y\\eta_x)\n",
        "    +u_{\\eta\\eta}\\eta_x\\eta_y\n",
        "    +u_\\xi\\xi_{xy}\n",
        "    +u_\\eta\\eta_{xy}\\\\ \n",
        "  u_{yy} =\\;u_{\\xi\\xi}& \\xi_y^2 \n",
        "    +2u_{\\xi\\eta}\\xi_y\\eta_y\n",
        "    +u_{\\eta\\eta}\\eta_y^2\n",
        "    +u_\\xi\\xi_{yy}\n",
        "    +u_\\eta\\eta_{yy}\\\\[5pt] \n",
        "    &\\Downarrow \\\\\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    {\\color{red}{\\bar{A}}}u_{\\xi\\xi} \n",
        "  +{\\color{red}{\\bar{B}}}u_{\\xi\\eta} \n",
        "  +&{\\color{red}{\\bar{C}} u_{\\eta\\eta}} \n",
        "  +\\bar{D}u_\\xi \n",
        "  +\\bar{E}u_\\eta \n",
        "  +\\bar{F}u = \\bar{G} \\\\[5pt]\n",
        "  \\text{in which} & \\\\[5pt]\n",
        "  \\bar{A}=&\\;A\\xi_x^2 +B\\xi_x \\xi_y +C\\xi_y^2 \\\\\n",
        "  \\bar{B}=&\\;2A\\xi_x\\eta_x \n",
        "    +B(\\xi_x \\eta_y+\\xi_y\\eta_x) +2C\\xi_y\\eta_y \\\\\n",
        "  \\bar{C}=&\\;A\\eta_x^2 +B\\eta_x \\eta_y +C\\eta_y^2 \\\\\n",
        "  %  \\bar{D}=&\\;A\\xi_{xx} +B\\xi_{xy} \n",
        "  %    +C\\xi_{yy} +D\\xi_x +E\\xi_y \\\\\n",
        "  %  \\bar{E}=&\\;A\\eta_{xx} +B\\eta_{xy} \n",
        "  %    +C\\eta_{yy} +D\\eta_x +E\\eta_y \\\\\n",
        "  %  \\bar{F}=&\\;F\\\\\n",
        "  %  \\bar{G}=&\\;G\\\\\n",
        "  \\Downarrow& \\\\ \n",
        "  \\begin{pmatrix}\n",
        "    2\\bar{A}& \\bar{B}\\\\ \n",
        "    \\bar{B}& 2\\bar{C}\n",
        "  \\end{pmatrix} =& \\;\n",
        "  \\begin{pmatrix}\n",
        "    \\xi_x & \\xi_y\\\\ \n",
        "    \\eta_x & \\eta_y \n",
        "  \\end{pmatrix} \n",
        "  \\begin{pmatrix}\n",
        "    2A & B\\\\ \n",
        "      B & 2C\n",
        "  \\end{pmatrix}\n",
        "  \\begin{pmatrix}\n",
        "    \\xi_x & \\xi_y\\\\ \n",
        "    \\eta_x & \\eta_y \n",
        "  \\end{pmatrix}^T \\\\\n",
        "  \\Downarrow& \\\\  \n",
        "  \\bar{B}^2 -4\\bar{A}\\bar{C} \n",
        "    =& \\; (\\xi_x\\eta_y-\\xi_y\\eta_x)^2(B^2 -4AC) \\\\\n",
        "    =& \\; J^2(B^2 -4AC)\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  in which $\\,J\\,$ is the Jacobian of the transformation and we select the transformation $\\,(\\xi,\\eta)\\,$ such that $\\,J \\neq 0$\n",
        "\n",
        "* <font color=\"blue\">The next step in our process is to set the coefficients $\\,\\bar{A}\\,$ and $\\,\\bar{C}\\,$ to zero and solve for the tranformation $\\,\\xi\\,$ and $\\,\\eta\\,$</font>. $\\,$This will give us the coordinates that reduce the original PDE to canonical form:\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  \\bar{A}=&\\;A\\xi_x^2 +B\\xi_x \\xi_y +C\\xi_y^2 =0\\\\\n",
        "  \\bar{C}=&\\;A\\eta_x^2 +B\\eta_x \\eta_y +C\\eta_y^2 =0\\\\\n",
        "  &\\Downarrow \\\\ \n",
        "  A\\left[ \\frac{\\xi_x}{\\xi_y} \\right]^2 &+B\\left[ \\frac{\\xi_x}{\\xi_y} \\right] +C=0,\\;\\; \n",
        "  A\\left[ \\frac{\\eta_x}{\\eta_y} \\right]^2 +B\\left[ \\frac{\\eta_x}{\\eta_y} \\right] +C=0 \\\\ \n",
        "  &\\Downarrow \\\\\n",
        "  \\left[ \\frac{\\xi_x}{\\xi_y} \\right] =&\\frac{-B +\\sqrt{\\color{blue}{B^2-4AC}}}{2A},\\;\\;\n",
        "  \\left[ \\frac{\\eta_x}{\\eta_y} \\right] =\\frac{-B -\\sqrt{\\color{blue}{B^2-4AC}}}{2A}\n",
        "  \\end{aligned}$$\n",
        "\n",
        "* We have now reduced the problem to finding the two functions $\\,\\xi(x,y)\\,$ and $\\,\\eta(x,y)\\,$ so that their ratio $\\,[\\xi_x/\\xi_y]\\,$ and $\\,[\\eta_x/\\eta_y]\\,$ satisfy the above equation. $\\,$Finding functions satisfying these conditions is really quite easy once we look for a few moments at figure\n",
        "\n",
        "  ![](figures/pde02_figure16.jpg \"characteristic curves\"){width=\"65%\" fig-align=\"center\"}\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    &\\big\\Downarrow \\;\\;{\\scriptsize \\xi = \\text{constant}, \\eta = \\text{constant}}\\\\\n",
        "    \\frac{dy}{dx} &=-\\left[ \\frac{\\xi_x}{\\xi_y} \\right]=\\frac{B -\\sqrt{B^2-4AC}}{2A} =g_1(x,y)\\\\\n",
        "    \\frac{dy}{dx} &=-\\left[ \\frac{\\eta_x}{\\eta_y} \\right]=\\frac{B +\\sqrt{B^2-4AC}}{2A} =g_2(x,y)\\\\\n",
        "    &\\Downarrow \\;\\;{\\scriptsize \\text{integration and arrangement}}\\\\\n",
        "    G_1(&x,y) = c_1 \\\\\n",
        "    G_2(&x,y) = c_2 \\\\\n",
        "    &\\Downarrow \\\\\n",
        "    \\xi &=G_1(x,y) \\\\\n",
        "    \\eta &=G_2(x,y) \n",
        "  \\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$Consider the simple equation\n",
        "\n",
        "$$u_{xx} -4u_{yy} +u_x =0,\\;\\;\\;B^2 -4AC=16>0$$\n",
        "\n",
        "whose characteristic equations are\n",
        "\n",
        "$$\\begin{aligned}\n",
        " \\frac{dy}{dx} &=-\\left[ \\frac{\\xi_x}{\\xi_y} \\right]=\\frac{B -\\sqrt{B^2-4AC}}{2A} =-2\\\\\n",
        " \\frac{dy}{dx} &=-\\left[ \\frac{\\eta_x}{\\eta_y} \\right]=\\frac{B +\\sqrt{B^2-4AC}}{2A} =2\\\\\n",
        "\\end{aligned}$$\n",
        "\n",
        "To find $\\xi$ and $\\eta$, $\\,$we first integrate for $x$ and solve for the constants $c_1$ and $c_2$, $\\,$getting\n",
        "\n",
        "$$\\begin{array}{l}\n",
        "    y =-2x+c_1 \\\\ \n",
        "    y = 2x+c_2 \\\\ \n",
        "  \\end{array}\n",
        "  \\;\\;\\Rightarrow\\;\\;\n",
        "  \\begin{array}{l}\n",
        "   \\xi =y+2x=c_1 \\\\\n",
        "   \\eta =y-2x=c_2\n",
        " \\end{array}$$\n",
        "\n",
        "![](figures/pde02_figure17.jpg \"Characteristic Curves2\"){width=\"50%\" fig-align=\"center\"}\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$Suppose we start with the equation\n",
        "\n",
        "$$y^2u_{xx} -x^2 u_{yy}=0,\\;\\;\\;x>0,\\;y>0$$\n",
        "\n",
        "which is a hyperbolic equation in the first quadrant. $\\,$We consider the problem of finding new coordinates that will change the original equation to canonical form for $\\,x\\,$ and $\\,y\\,$ in the first quadrant\n",
        "\n",
        "**STEP 1** $\\,$ Solve the two characteristic equations\n",
        "\n",
        "$$\\begin{aligned}\n",
        " \\frac{dy}{dx} &=-\\left[ \\frac{\\xi_x}{\\xi_y} \\right]=\\frac{B -\\sqrt{B^2-4AC}}{2A} =-\\frac{x}{y}\\\\\n",
        " \\frac{dy}{dx} &=-\\left[ \\frac{\\eta_x}{\\eta_y} \\right]=\\frac{B +\\sqrt{B^2-4AC}}{2A} =\\frac{x}{y}\\\\\n",
        "\\end{aligned}$$\n",
        "\n",
        "Integrating these two equations by the ODE technique of separating variables gives the implicit relationship\n",
        "\n",
        "$$\\begin{aligned}\n",
        " y^2 &-x^2 = c_1 \\\\ \n",
        " y^2 &+x^2 = c_2 \\\\ \n",
        " &\\Downarrow \\\\ \n",
        " \\xi= \\,&y^2 -x^2 \\\\\n",
        " \\eta = \\,&y^2 +x^2\n",
        "\\end{aligned}$$\n",
        "\n",
        "![](figures/pde02_figure18.jpg \"Characteristic Curves3\"){width=\"70%\" fig-align=\"center\"}\n",
        "\n",
        "\n",
        "We substitute this new coordinate into the equation to find the new equation\n",
        "\n",
        "$$\\begin{aligned}\n",
        "  y^2 u_{xx} &-x^2 u_{yy}= 0\\\\ \n",
        "  &\\Downarrow\\;\\; \\xi=y^2 -x^2,\\; \\eta=y^2 +x^2 \\\\ \n",
        "  -16x^2y^2 u_{\\xi\\eta} -2(x^2 +y^2) &u_\\xi +2(y^2 -x^2) u_\\eta=0\n",
        "\\end{aligned}$$\n",
        "\n",
        "**STEP 2** $\\,$ Finally, $\\,$solving for $\\,x\\,$ and $\\,y\\,$ in terms of $\\,\\xi\\,$ and $\\,\\eta$, $\\,$we get\n",
        "\n",
        "$$ u_{\\xi\\eta}=\\frac{\\eta u_\\xi -\\xi u_\\eta}{2(\\xi^2 -\\eta^2)}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$Find the new characteristic coordinates for\n",
        "\n",
        "$$u_{xx} + 4u_{xy} = 0$$\n",
        "\n",
        "Solve the transformed equation in the new coordinate system and then transform back to the original coordinates to find the solution to the original problem\n",
        "\n",
        "$~$\n",
        "\n",
        "**NOTES**\n",
        "\n",
        "* The general hyperbolic equation actually has two canonical forms; $\\,$the other one can be found by making yet another transformation\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    \\alpha &=\\xi +\\eta \\\\ \n",
        "    \\beta &=\\xi -\\eta\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  and rewriting the first canonical form in terms of $\\,\\alpha\\,$ and $\\,\\beta$. $\\,$The partial derivatives are transformed as follows:\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    u_\\xi&= u_\\alpha \\alpha_\\xi +u_\\beta \n",
        "     \\beta_\\xi=u_\\alpha +u_\\beta\\\\ \n",
        "    u_\\eta&= u_\\alpha \\alpha_\\eta +u_\\beta \n",
        "     \\beta_\\eta=u_\\alpha -u_\\beta\\\\ \n",
        "    u_{\\xi\\eta}&= u_{\\alpha\\alpha}\\alpha_\\eta \n",
        "     +u_{\\alpha\\beta}\\beta_\\eta \n",
        "      +u_{\\beta\\alpha}\\alpha_\\eta +u_{\\beta\\beta} \n",
        "       \\beta_\\eta =u_{\\alpha\\alpha} -u_{\\beta\\beta}\n",
        "  \\end{aligned}$$\n",
        "\n",
        "* In the general parabolic equation, $\\,$we obtain only a single canonical transformation as\n",
        "\n",
        "  $$ \\bar{A}=0, \\;\\;\\frac{dy}{dx}=-\\left [ \\frac{\\xi_x}{\\xi_y} \\right ],\\;\\;\\;\\text{or}\\;\\;\\; \\bar{C}=0, \\;\\;\\frac{dy}{dx}=-\\left [ \\frac{\\eta_x}{\\eta_y} \\right ]$$\n",
        "\n",
        "  Suppose $\\,\\xi\\,$ is calculated. $\\,$What could be the possible choice for $\\,\\eta\\,$? \n",
        " $\\,$We can select $\\,\\eta\\,$ as any arbitrary function of $\\,x\\,$ and $\\,y\\,$ such that $\\,\\eta\\,$ is independent of $\\,\\xi\\,$ ($J \\neq 0$)\n",
        "\n",
        "* In the general elliptic case, $\\,A\\lambda^2 +B\\lambda +C=0\\,$ leads to complex conjugate canonical tramsformation $\\,\\xi\\,$ and $\\,\\eta$. $\\,$Since $\\,\\xi\\,$ and $\\,\\eta\\,$ are complex, $\\,$we introduce new real variables\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "     \\alpha &= \\frac{1}{2}(\\xi +\\eta)\\\\ \n",
        "     \\beta &= \\frac{1}{2i}(\\xi -i\\eta)\n",
        "    \\end{aligned}$$\n",
        "\n",
        "  Under the transformation $\\,(x, y)\\to (\\alpha, \\beta)$, $\\,$the canonical form is given by\n",
        " \n",
        "  $$ u_{\\alpha\\alpha} +u_{\\beta\\beta}=\\Phi(\\alpha,\\beta,u,u_\\alpha,u_\\beta)$$\n",
        "\n",
        "* The three major classifications of linear PDEs as hyperbolic, parabolic, and elliptic equations essentially classify physical problems into three basic physical types:\n",
        "\n",
        "   * **Wave propagation**\n",
        "   * **Diffusion**\n",
        "   * **Steady-state problems**\n",
        "  \n",
        "  The mathematical solutions of these three types of equations are quite different\n",
        "\n",
        "$~$\n",
        "\n",
        "## $~$First-Order Equations (Method of Characteristics) {#sec-x2-28}\n",
        "\n",
        "* If the student recalls, $\\,$when we solved the diffusion equation\n",
        "\n",
        "  $$ u_t=\\alpha u_{xx} - vu_x, \\quad -\\infty < x < \\infty, \\;\\; 0 < t < \\infty$$\n",
        "\n",
        "  the constant $\\,\\alpha\\,$ stood for the amount of diffusion, $\\,$while $v$ stood for the velocity of the medium\n",
        "\n",
        "* Hence if $\\,\\alpha=0$ (no diffusion), $\\,$it is clear (since we only have convection) that the solution will travel along the $\\,x$-axis with velocity $\\,v$. $\\,$In other words, $\\,$if the initial solution is $\\,u(x,0)=\\phi(x)$, $\\,$then the solution to\n",
        "\n",
        "  <font color=\"red\">$$u_t=-vu_x$$</font>\n",
        "\n",
        "  would be <font color=\"red\">$\\,u(x,t)=\\phi(x-vt)$</font>\n",
        "\n",
        "* So we can think of the first-order equation\n",
        "\n",
        "  <font color=\"blue\">$$a(x,t)u_x +b(x,t)u_t = 0$$</font>\n",
        "\n",
        "  as the concentration along a stream where the velocity is given by\n",
        "\n",
        "  <font color=\"blue\">$$ v=\\frac{a(x,t)}{b(x,t)}$$</font>\n",
        "\n",
        "* The purpose of this section is to introduce the notion of first-order partial differential equations and <font color=\"red\">method of characteristics</font>. $\\,$The problem we will solve is the initial-value problem\n",
        "\n",
        "  $$ a(x,t) u_x +b(x,t) u_t +c(x,t)u=0 $$\n",
        "\n",
        "  $$u(x,0)=\\phi(x), \\;\\; {-\\infty<x<\\infty,\\;\\; 0< t < \\infty}$$\n",
        "\n",
        "  The solution to this equation is based on a physical fact, $\\,$that <font color=\"blue\">an initial disturbance at some point $\\,x\\,$ propagates along a line (curve) in the $\\,tx$-plane (called a characteristic)</font>\n",
        "\n",
        "  ![](figures/pde02_figure22.jpg \"characteristics\"){width=\"70%\" fig-align=\"center\"}\n",
        "\n",
        "* With this in mind, $\\,$the idea is to introduce two new coordinates $\\,s\\,$ and $\\,\\tau$ (to replace $\\,x\\,$ and $\\,t$) that have the properties\n",
        "\n",
        "  * $s\\,$ will change along the characteristic curves\n",
        "  * $\\tau\\,$ will change along the initial curve (most likely the line $\\,t=0$)\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    a(x,t) u_x +\\, & b(x,t) u_t +c(x,t)u = 0\\\\ \n",
        "    &\\big\\Downarrow\\;\\; {\\scriptsize\\text{characteristic curves } \\{ \\left( x(s), t(s) \\right) : 0<s<\\infty \\}} \\\\ \n",
        "    \\frac{dx}{ds} = a(x,t), &\\;\n",
        "    \\frac{dt}{ds} = b(x,t) \\\\\n",
        "    &\\Downarrow \\\\\n",
        "    \\frac{du}{ds}= u_x \\frac{dx}{ds} +u_t\\frac{dt}{ds}&=a(x,t) u_x +b(x,t) u_t \\\\\n",
        "    &\\Downarrow \\\\\n",
        "    \\frac{du}{ds} +\\, &c(x,t)u =0\n",
        "   \\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$Solve the following IVP with constant coefficients:\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "  u_x +u_t +2u &=0 && -\\infty < x < \\infty,\\;\\; 0 < t < \\infty \\\\\n",
        "  u(x,0) &=\\sin x && -\\infty < x < \\infty\n",
        "\\end{aligned}$$\n",
        "\n",
        "**STEP 1** $\\,$ Find the characteristics (along which the initial data propagate)\n",
        "\n",
        "$$\\begin{aligned}\n",
        "  \\frac{dx}{ds}=1,\\;\\;\n",
        "   \\frac{dt} {ds}&=1\\quad 0<s<\\infty \\\\ \n",
        "  &\\Downarrow \\\\ \n",
        "  x(s) = &\\;s +c_1 \\\\\n",
        "  t(s) = &\\;s +c_2 \\\\\n",
        "  &\\Downarrow \\;\\;x(0)= \\tau, \\;\\;t(0)=0 \\\\\n",
        "  x = &\\;s +\\tau \\\\\n",
        "  t = &\\;s \\\\\n",
        "  &\\Downarrow \\\\\n",
        "  x - t = \\tau, \\;\\;\\;&-\\infty < \\tau < \\infty\n",
        "\\end{aligned}$$\n",
        "\n",
        "![](figures/pde02_figure23.jpg \"new coordinates\"){width=\"60%\" fig-align=\"center\"}\n",
        "\n",
        "**STEP 2** $\\,$ Using this coordinate system, $\\,$we change the PDE to the ODE\n",
        "\n",
        "$$\\begin{aligned}\n",
        " \\frac{du}{ds} +2u&= 0, \\;\\; u(0)= \\sin\\tau \\\\ \n",
        " &\\Downarrow \\\\\n",
        " u(s,\\tau) &=\\sin \\tau \\cdot e^{-2s} \n",
        "\\end{aligned}$$\n",
        "\n",
        "**STEP 3** $\\,$ We now solve the transformation for $\\,s\\,$ and $\\,\\tau\\,$ in terms of $\\,x\\,$ and $\\,t$:\n",
        "\n",
        "$$u(x,t) = \\sin(x -t) \\cdot e^{-2t}$$\n",
        "\n",
        "![](figures/pde02_figure24.jpg \"solution\"){width=\"60%\" fig-align=\"center\"}\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$Solve the following IVP with variable coefficients:\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "  x u_x +u_t +tu &=0 && -\\infty < x < \\infty,\\; 0 < t < \\infty \\\\\n",
        "  u(x,0) &=F(x) && -\\infty < x < \\infty, \\;\\;\\text{an arbitrary initial wave}\n",
        "\\end{aligned}$$\n",
        "\n",
        "**STEP 1** $\\,$ Find the characteristics (along which the initial data propagate)\n",
        "\n",
        "$$\\begin{aligned}\n",
        "  \\frac{dx}{ds} =x,\\;\\;&\\frac{dt}{ds} =1 \n",
        "    \\quad 0<s<\\infty \\\\ \n",
        "  &\\Downarrow \\\\ \n",
        "  x(s) &=\\; c_1 e^s\\\\\n",
        "  t(s) &=\\; s +c_2 \\\\\n",
        "  &\\Downarrow \\;\\; x(0)= \\tau, \\;\\;t(0)=0 \\\\\n",
        "  x &=\\;\\tau e^s \\\\\n",
        "  t &=\\;s \n",
        "\\end{aligned}$$\n",
        "\n",
        "**STEP 2** $\\,$ Using this coordinate system, $\\,$we change the PDE to the ODE\n",
        "\n",
        "$$\\begin{aligned}\n",
        "  \\frac{du}{ds} +su&= 0, \\;\\; u(0)= F(\\tau) \\\\ \n",
        "  &\\Downarrow \\\\\n",
        "  u(s,\\tau) &=F(\\tau) \\cdot e^{-s^2/2} \n",
        "\\end{aligned}$$\n",
        "\n",
        "**STEP 3** $\\,$ We now solve the transformation for $\\,s\\,$ and $\\,\\tau\\,$ in terms of $\\,x\\,$ and $\\,t$:\n",
        "\n",
        "$$u(x,t) = F(xe^{-t}) \\cdot e^{-t^2/2}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Solve the problem in higher dimensions (surface waves)\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "   a u_x +b u_y +c u_t +du &=0 && \\scriptsize -\\infty < x < \\infty, \\;-\\infty < y < \\infty, \\; 0< t < \\infty \\\\\n",
        "   u(x,y,0) &=e^{-(x^2 +y^2)} && \\scriptsize -\\infty < x < \\infty, \\;-\\infty < y < \\infty\n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## $~$Nonlinear First-Order Equations (Conservation Equations) {#sec-x2-29}\n",
        "\n",
        "* One of the most useful partial differential equations in mathematics is the conservation equation\n",
        "\n",
        "  <font color=\"red\">$$u_t +f_x=0$$</font>\n",
        "\n",
        "  This equation says that the increase of a physical quantity $\\,u_t\\,$ is equal to the change in flux $\\,-f_x\\,$ of that quantity across the boundary\n",
        "\n",
        "* **Derivation of the Conservation Equation**\n",
        "\n",
        "  Suppose we have a stretch of highway on which cars are moving from left to right, $\\,$and we assume there are no exit and entrance ramps. $\\,$We let\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    u(x,t) &=\\text{density of cars at } x\\;\\; \n",
        "      (\\text{cars per unit length at } x) \\\\[5pt]\n",
        "    f(x,t) &=\\text{flux of cars at } x \\;\\; \n",
        "      (\\text{cars per minute passing the point } x)\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  Then, $\\,$it is fairly obvious that for a road segment $\\,[a,b]$, $\\,$the change in the number of cars (with respect to time) is given by both of the following expressions:\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    \\text{change in the number of cars in } [a,b] \n",
        "      &= \\frac{d}{dt} \\int_a^b u(x,t)\\,dx \\\\\n",
        "    \\text{change in the number of cars in } [a,b] \n",
        "      &= f(a,t) -f(b,t) \n",
        "      = -\\int_a^b \\frac{\\partial f}{\\partial x}(x,t)\\,dx\n",
        "    \\end{aligned}$$\n",
        "\n",
        "  Setting these two integrals equal to each other, $\\,$we have\n",
        "\n",
        "  $$ \\int_a^b \\frac{\\partial u}{\\partial t}(x,t)\\,dx = -\\int_a^b \\frac{\\partial f}{\\partial x}(x,t)\\,dx$$\n",
        "\n",
        "  Finally, $\\,$since the integral $\\,[a,b]\\,$ was arbitrary, $\\,$we have the one-dimensional conservation equation\n",
        "\n",
        "  $$u_t +f_x=0$$\n",
        "\n",
        "  If we carried out a similar analysis in two or three dimensions, $\\,$we would have\n",
        "\n",
        "  $$u_t +f_x +f_y=0, \\;\\; u_t +f_x +f_y +f_z=0$$\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Conservation Equation Applied to the Traffic Problem**\n",
        "\n",
        "  * We are now ready to see how the conservation equation $\\,u_t +f_x=0\\,$ can be applied to the traffic problem\n",
        "\n",
        "  * To do this, $\\,$we rewrite the change in flux $\\,f_x\\,$ as \n",
        "\n",
        "    $$f_x = \\frac{df}{du} u_x,\\;\\;\\text{chain rule}$$ \n",
        "    \n",
        "    and substitute it in the conservation equation. $\\,$Doing this, $\\,$we arrive at\n",
        "\n",
        "    $$ u_t +\\frac{df}{du}u_x=u_t+g(u)u_x=0$$\n",
        "\n",
        "    where we can imagine a car moving upstream or downstream with velocity $\\,g(u)$\n",
        "\n",
        "  * Hence, after $\\,t\\,$ minutes, the position $\\,x\\,$ of the car will be\n",
        "\n",
        "    $$x = x_0 +g(u)t, \\quad\\text{characteristic equation}$$\n",
        "\n",
        "  * Hence, after $\\,t\\,$ minutes, the position $\\,x\\,$ of the car will be\n",
        "\n",
        "    $$x = x_0 +g(u)t, \\quad\\text{characteristic equation}$$\n",
        "\n",
        "  * Remembering that <font color=\"blue\">the concentration $\\,u(x,t)\\,$ will not change along each characteristic</font>, $\\,$if we know the initial density $\\,u(x_0,0)$, then the characteristic equation for $\\,x\\,$ can be written\n",
        "\n",
        "    $$x=x_0+g[u(x_0,0)]t$$\n",
        "\n",
        "  * It is clear that by knowing these characteristic curves starting from each point (and knowing the solution doesn't change along these curves), $\\,$we can piece together the solution $\\,u(x,t)\\,$ for all time $\\,t$. $\\,$We won't actually find the explicit equation for the solution $\\,u(x,t)\\,$ in terms of $\\,x\\,$ and $\\,t\\,$ but will use our knowledge of the characteristics of the equation to solve some interesting problems\n",
        "\n",
        "![](figures/pde02_figure25.jpg \"characteristic curves\"){width=\"40%\" fig-align=\"center\"}\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Traffic-Flow Problem**\n",
        "\n",
        "  * We will now solve a traffic-flow problem where the flux is given by $\\,f(u)=u^2$ and the initial density of cars is given. $\\,$In other words, $\\,$we have\n",
        "\n",
        "  $$ u_t +2uu_x =0 \\quad -\\infty < x < \\infty, \n",
        "  \\; 0< t < \\infty$$\n",
        "\n",
        "  $$u(x,0) = \n",
        "  \\begin{cases}\n",
        "  \\;\\;\\; 1 & x \\leq 0\\\\ \n",
        "  1 -x     & 0 < x < 1, \\;-\\infty < x <\\infty \\\\ \n",
        "  \\;\\;\\; 0 & 1 \\leq x \n",
        "  \\end{cases}$$\n",
        "\n",
        "![](figures/pde02_figure26.jpg \"initial density\"){width=\"60%\" fig-align=\"center\"}\n",
        "\n",
        "**STEP 1**\n",
        "\n",
        "We begin by finding the characteristics starting from each initial point $\\,(x_0,0)$.\n",
        "$\\,$For $\\,x_0 < 0$, $\\,$the characteristics are\n",
        "\n",
        "$$\\begin{aligned}\n",
        "  x &= x_0 +g[u(x_0,0)] t \\\\ \n",
        "  &= x_0 +g[1] t\\\\ \n",
        "  &= x_0 +2t \\\\\n",
        "  &\\Downarrow \\\\\n",
        "  t &=\\frac{1}{2} (x -x_0)\n",
        "\\end{aligned}$$\n",
        "\n",
        "Now consider those initial points $\\,0 < x_0 < 1$. $\\,$Here, $\\,$the characteristic curves are\n",
        "\n",
        "$$\\begin{aligned}\n",
        " x &= x_0 +g[u(x_0,0)] t \\\\ \n",
        " &= x_0 +g[1 -x_0] t\\\\ \n",
        " &= x_0 +2(1 -x_0)t \\\\\n",
        " &\\Downarrow \\\\\n",
        " t &=\\frac{x -x_0}{2(1 -x_0)}\n",
        "\\end{aligned}$$\n",
        "\n",
        "Finally, $\\,$for $\\,1 \\leq x_0 < \\infty$, $\\,$we have the characteristics\n",
        "\n",
        "$$\\begin{aligned}\n",
        " x &= x_0 +g[u(x_0,0)] t \\\\ \n",
        " &= x_0 +g[0] t\\\\ \n",
        " &= x_0\n",
        "\\end{aligned}$$\n",
        "\n",
        "which represents vertical lines starting at $\\,x_0$\n",
        "\n",
        "![](figures/pde02_figure27.jpg \"characteristics\"){width=\"80%\" fig-align=\"center\"}\n",
        "\n",
        "The solution remains constant along each characteristic line. $\\,$Now the solution for $\\,x \\in \\mathbb{R}$, $\\,0 \\leq t <\\textstyle\\frac{1}{2}\\,$ is given by\n",
        "\n",
        "$$u(x,t)=\n",
        "\\begin{cases}\n",
        " \\quad 1 & \\; x \\leq 2t,\\qquad 0 \\leq t < \\frac{1}{2}\\\\ \n",
        " \\displaystyle\\frac{1 -x}{1 -2t} & 2t \\leq x < 1, \\;\\, \n",
        "   0 \\leq t < \\frac{1}{2} \\\\ \n",
        " \\quad 0 & \\; 1 \\leq x, \\qquad \\; 0 \\leq t < \\frac{1}{2}\n",
        "\\end{cases}$$\n",
        "\n",
        "The difficulty in this example is\n",
        "that some characteristic lines will intersect each other. $\\,$In other words, $\\,$<font color=\"red\">at the intersection point $\\,(1,\\textstyle \\frac{1}{2})\\,$ of the two characteristic lines, $\\,$the solution becomes multi-valued</font>. $\\,$This pathology means that the solution in the usual sense fails to exist after $\\,t \\geq \\textstyle \\frac{1}{2}$\n",
        "\n",
        "![](figures/pde02_figure28.jpg \"density of traffic at different values of time\"){width=\"50%\" fig-align=\"center\"}\n",
        "\n",
        "**STEP 2**\n",
        "\n",
        "* Hence, $\\,$to find the solution past $\\,t=\\textstyle \\frac{1}{2}$, $\\,$we must use another type of analysis. $\\,$<font color=\"red\">When characteristics run together, $\\,$we have the phenomenon of shock waves (discontinuous solutions)</font>, $\\,$and what we must ask is, $\\,$how fast does the leading edge of the shork wave propagate along the road?\n",
        "\n",
        "* Before proceeding further, $\\,$it is necessary to introduce the concept of <font color=\"red\">a jump condition: a condition that holds at a discontinuity or abrupt change</font>. $\\,$Consider one dimensional problem where there is a jump in the conserved quantity $\\,u$:\n",
        "\n",
        "  $$u_t +f_x=0$$\n",
        "\n",
        "  Let the solution exhibit a jump (or shork) at $\\,x=x_s(t)\\,$ and integrate over the partial domain, $\\,x \\in (x_1, x_2)$, $\\,$where $\\,x_1 < x_s(t) < x_2$,\n",
        "\n",
        "  $$\\scriptsize \\begin{aligned}\n",
        "  \\frac{d}{dt} \\left( \\int_{x_1}^{x_s(t)}u\\,dx +\\int_{x_s(t)}^{x_2}u \\,dx\\right)&= -\\int_{x_1}^{x_2} \n",
        "    \\frac{\\partial } {\\partial x} f(u)\\,dx\\\\\n",
        "  &\\Downarrow \\\\\n",
        "    \\int_{x_1}^{x_s(t)} u_t \\,dx +u^-(x_s(t),t)\\frac{dx_s}{dt} +\\int_{x_s(t)}^{x_2} u_t \\,dx \n",
        "    &-u^+(x_s(t),t)\\frac{dx_s}{dt}= -\\left. \\underset{}{f(u)}\\, \\right|_{x_1}^{x_2}\\\\ \n",
        "  x_1 \\to x_s(t),\\;x_2 \\to x_s(t) \\;\\; &\\Downarrow \\\\ \n",
        "  \\left[ u^-(x_s(t),t) -u^+(x_s(t),t) \\right] \\frac{d x_s}{dt} &= f(u^-(x_s(t),t)) -f(u^+(x_s(t),t)) \\\\\n",
        "  &\\Downarrow \\\\\n",
        "  s=\\frac{d x_s}{dt} &=\\frac{f(u^-(x_s(t),t)) -f(u^+(x_s(t),t))}{ u^-(x_s(t),t) -u^+(x_s(t),t)}\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  in which $\\,s\\,$ is the speed of the discontinuity and represents the jump condition for conservation eqaution \n",
        "\n",
        "* A shork situation arises in a system where its characteristics intersect, $\\,$and under these conditions a requirement for a unique single-valued solution is that the solution should satisfy the Lax entropy condition\n",
        "\n",
        "  $$f'(u^+(x_s(t),t)) < s < f'(u^-(x_s(t),t))$$\n",
        "\n",
        "  where $f'(u^+(x_s(t),t))\\,$ and $\\,f'(u^-(x_s(t),t))\\,$ represent characteristic speeds at upstream and downstream conditions, respectively\n",
        "\n",
        "* So, $\\,$in our example, $\\,$the speed of the wave front would be(remembering that $\\,f(u)=u^2$)\n",
        "\n",
        "  $$ s = \\frac{1 -0}{1 -0}=1$$\n",
        "\n",
        "* <font color=\"red\">Therefore, $\\,$a shock is formed at $(x,t)=(1,\\textstyle\\frac{1}{2})$: </font>\n",
        "\n",
        "  * After that, $\\,$it moves with constant speed $1$, $\\,$along the line $\\,x=t +\\textstyle \\frac{1}{2}$, $\\,$for $\\,t \\geq \\textstyle \\frac{1}{2}$. \n",
        "  \n",
        "  * In conclusion, $\\,$the solution takes different forms in the three different regions in the space-time plane\n",
        "\n",
        "$$u(x,t)=\n",
        "\\begin{cases}\n",
        "\\quad 1 & x \\leq 2t, \\qquad\\; 0 \\leq t < \\frac{1}{2} \\;\\;\\text{or}\\;\\; x-\\frac{1}{2} \\leq t, \\;\\;t \\geq \\frac{1}{2}\\\\ \n",
        "\\displaystyle\\frac{1 -x}{1 -2t} & 2t \\leq x < 1, \\;\\, 0 \\leq t < \\frac{1}{2} \\\\ \n",
        "\\quad 0 & x \\geq 1, \\qquad\\;\\; 0 \\leq t < \\frac{1}{2} \\;\\;\\text{or}\\;\\; x-\\frac{1}{2} > t, \\;\\;t \\geq \\frac{1}{2}\n",
        "\\end{cases}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Solve\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "  u_t +uu_x &=0 \\qquad -\\infty < x < \\infty, \\; 0 < t < \\infty \\\\\n",
        "  u(x,0) &= \n",
        "    \\begin{cases}\n",
        "      3(1 -|x|) & |x| \\leq 1\\\\ \n",
        "      \\quad\\; 0 & |x| > 1 \n",
        "    \\end{cases}  \n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Verify that $\\,u=\\phi[x-g(u)t]\\,$ is an implicit solution of the nonlinear problem\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "  u_t +g(u)u_x &=0 \\quad -\\infty < x < \\infty, \\; 0 < t < \\infty \\\\\n",
        "  u(x,0) &= \\phi(x)\n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## $~$Systems of PDEs {#sec-x2-30}\n",
        "\n",
        "* In many areas of science, $\\,$several unknown quantities (and their derivatives) are modeled by a system of interlocking equations. $\\,$And we seek to find all of these functions simultaneously\n",
        "\n",
        "* There are other reasons for studying systems of equations. $\\,$Although things are not quite so simple in PDE theory, $\\,$it is often possible to write a single higher-order PDE as a system of first-order equations\n",
        "\n",
        "* For example, $\\,$the telegraph equation\n",
        "\n",
        "  $$ u_{tt}=c^2u_{xx} +au_t +bu $$\n",
        "\n",
        "  can be rewritten in equivalent form as three first-order PDEs by introducing the three variables:\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    u_1 &= u \\\\ \n",
        "    u_2 &= u_x \\\\ \n",
        "    u_3 &= u_t \n",
        "  \\end{aligned}$$\n",
        "\n",
        "* It is a simple matter to see that the telegraph equation is equivalent to the three equations:\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "   \\frac{\\partial u_1}{\\partial x} &= u_2 \\\\[2pt] \n",
        "   \\frac{\\partial u_2}{\\partial t} &= u_3 \\\\[2pt] \n",
        "   \\frac{\\partial u_3}{\\partial t} &= c^2 \n",
        "    \\frac{\\partial u_2}{\\partial x} +au_3 +bu_1\n",
        "  \\end{aligned}$$\n",
        "\n",
        "* **Solution of the Linear System** $\\,\\mathbf{u}_t +\\mathbf{A}\\mathbf{u}_x=\\mathbf{0}$\n",
        "\n",
        "  * Consider the initial-value problem consisting of two PDEs and two ICs\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "      \\frac{\\partial u_1}{\\partial t} +8\n",
        "        &\\frac{\\partial u_2}{\\partial x} = 0 \\\\[2pt] \n",
        "      \\frac{\\partial u_2}{\\partial t} +2\n",
        "        &\\frac{\\partial u_1}{\\partial x} = 0 \\\\[5pt] \n",
        "      u_1(x,0)& = f(x) \\\\ \n",
        "      u_2(x,0)& = g(x) \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    We start by writing the two PDEs in matrix form\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "      \\begin{bmatrix}\n",
        "      \\frac{\\partial u_1}{\\partial t} \\\\ \n",
        "      \\frac{\\partial u_2}{\\partial t}\n",
        "      \\end{bmatrix} \n",
        "    +&\\begin{bmatrix}\n",
        "        0 & 8 \\\\ 2 & 0 \n",
        "      \\end{bmatrix}\n",
        "      \\begin{bmatrix}\n",
        "      \\frac{\\partial u_1}{\\partial x} \\\\ \n",
        "      \\frac{\\partial u_2}{\\partial x}\n",
        "      \\end{bmatrix}\n",
        "      = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} \\\\ \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    &\\Downarrow \\\\[2pt] \n",
        "      \\mathbf{u}_t +\n",
        "      &\\mathbf{A}\\mathbf{u}_x = \\mathbf{0} \\\\[2pt] \n",
        "    &\\Downarrow \\;\\; \n",
        "      \\mathbf{u}=\\mathbf{P}\\mathbf{v}\\\\[2pt] \n",
        "      \\mathbf{v}_t +&\\mathbf{P}^{-1} \n",
        "      \\mathbf{A}\\mathbf{P}\\mathbf{v}_x \n",
        "      = \\mathbf{0} \\\\[2pt] \n",
        "    &\\Downarrow \\\\[2pt] \n",
        "      \\mathbf{v}_t +\n",
        "      &\\boldsymbol{\\Gamma}\\mathbf{v}_x = \\mathbf{0}\n",
        "    \\end{aligned}$$\n",
        "\n",
        "    where\n",
        "\n",
        "    $$\\mathbf{P}=\n",
        "    \\begin{bmatrix}\n",
        "    2 & -2 \\\\ \n",
        "    1 & \\;\\;\\,1 \n",
        "    \\end{bmatrix},\\;\\;\n",
        "    \\boldsymbol{\\Gamma}=\n",
        "    \\begin{bmatrix}\n",
        "    4 & \\;\\;\\,0 \\\\ \n",
        "    0 & -4 \n",
        "    \\end{bmatrix}\\qquad$$\n",
        "\n",
        "  * These are the two uncoupled equations that we can solve independently\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "      &\\frac{\\partial v_1}{\\partial t} +4\\frac{\\partial v_1}{\\partial x} = 0 \\\\ \n",
        "      &\\frac{\\partial v_2}{\\partial t} -4\\frac{\\partial v_2}{\\partial x} = 0 \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    These equations have travelling-wave solutions\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    v_1(x,t) &= \\phi(x -4t) \\\\ \n",
        "    v_2(x,t) &= \\psi(x +4t) \n",
        "    \\end{aligned}$$\n",
        "\n",
        "    where $\\,\\phi\\,$ and $\\,\\psi\\,$ are arbitrary differentiable functions\n",
        "\n",
        "  * To obtain our general solution $\\,u$, $\\,$we merely compute\n",
        "\n",
        "    $$\\mathbf{u}=\\mathbf{P}\\mathbf{v}=\n",
        "    \\begin{bmatrix}\n",
        "      2\\phi(x -4t) -2\\psi(x+4t)\\\\ \n",
        "      \\phi(x -4t) +\\psi(x+4t)\n",
        "    \\end{bmatrix}$$\n",
        "\n",
        "    We now substitute general solution into the ICs to get\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    2\\phi(x) &-2\\psi(x) = f(x) \\\\ \n",
        "    \\phi(x) &+\\psi(x) = g(x) \\\\ \n",
        "    &\\Downarrow \\\\ \n",
        "    \\phi(x) &= \\frac{1}{4} \\left[ f(x) +2g(x) \\right] \\\\\n",
        "    \\psi(x) &= \\frac{1}{4} \\left[ 2g(x) -f(x) \\right]\n",
        "    \\end{aligned}$$\n",
        "\n",
        "    and, $\\,$hence, $\\,$the solution to IVP is\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    u_1(x,t) &= \\frac{1}{2} \\left[ f(x -4t) +2g(x -4t) \\right] -\\frac{1}{2}\\left[ 2g(x +4t) -f(x +4t) \\right]\\\\ \n",
        "    u_2(x,t) &= \\frac{1}{4} \\left[ f(x -4t) +2g(x -4t) \\right] +\\frac{1}{4}\\left[ 2g(x +4t) -f(x +4t) \\right]\n",
        "    \\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ What is the general solution of the system\n",
        "\n",
        "$$\\begin{aligned}\n",
        " &\\frac{\\partial u_1}{\\partial t} +\\frac{\\partial u_1}{\\partial x} +\\frac{\\partial u_2}{\\partial x} = 0\\\\ \n",
        " &\\frac{\\partial u_2}{\\partial t} +4\\frac{\\partial u_1}{\\partial x} +\\frac{\\partial u_2}{\\partial x} = 0 \n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Worked Exercises {.unnumbered}\n",
        "\n",
        "**1.** $~$ Find $u(0,0,0,t)$\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        " u_{tt} &= \\nabla^2 u, \\;\\; t > 0\\\\ \n",
        " &u(x, y, z, 0) = 0, \\;\n",
        " u_t(x, y, z, 0) = x^2 +y^2 +z^2\n",
        "\\end{aligned}\n",
        "$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "**Step 1:** $~$ Use the Kirchhoff’s formula (solution to 3D wave equation)\n",
        "\n",
        "For the 3D wave equation (with wave speed $c= 1$), the solution with initial conditions $u(\\mathbf{x},0) = f(\\mathbf{x})$, $u_t(\\mathbf{x},0) = g(\\mathbf{x})$ is:\n",
        "\n",
        "$$u(\\mathbf{x},t) = \\frac{1}{4\\pi t} \\int_{|\\xi - \\mathbf{x}| = t} g(\\xi) \\, dS(\\xi) + \\frac{1}{4\\pi t^2} \\int_{|\\xi - \\mathbf{x}| = t} f(\\xi) \\, dS(\\xi) $$\n",
        "\n",
        "where the integrals are over the sphere of radius $t$ centered at $\\mathbf{x}$\n",
        "\n",
        "In our problem:\n",
        "\n",
        "* $f(x,y,z) = 0$\n",
        "* $g(x,y,z) = x^2 + y^2 + z^2 = |\\xi|^2$\n",
        "* Point of interest: $\\mathbf{x} = (0,0,0)$\n",
        "\n",
        "Thus:\n",
        "\n",
        "$$u(0,0,0,t) = \\frac{1}{4\\pi t} \\int_{|\\xi| = t} |\\xi|^2 \\, dS(\\xi)$$\n",
        "\n",
        "**Step 2:** $~$ Evaluate the integral\n",
        "\n",
        "On the sphere $|\\xi| = t$, we have $|\\xi|^2 = t^2$ constant\n",
        "\n",
        "Then:\n",
        "\n",
        "$$u(0,0,0,t) = \\frac{1}{4\\pi t} \\int_{|\\xi| = t} t^2 \\, dS(\\xi) = \\frac{t^2}{4\\pi t} \\cdot \\text{Surface area of sphere of radius } t$$\n",
        "\n",
        "The surface area of a sphere of radius $t$ is $4\\pi t^2$, so:\n",
        "\n",
        "$$u(0,0,0,t) = \\frac{t^2}{4\\pi t} \\cdot 4\\pi t^2 = t^2 \\cdot t = \\boxed{t^3}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**2.** $~$ Find $u(x,y,z,t)$\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        " u_{tt} &= \\nabla^2 u, \\;\\; t > 0\\\\ \n",
        " &u(x, y, z, 0) = 0, \\;\n",
        " u_t(x, y, z, 0) = x\n",
        "\\end{aligned}\n",
        "$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "**Step 1:** $~$ Use Kirchhoff’s formula (3D wave equation)\n",
        "\n",
        "For the 3D wave equation $u_{tt} = \\nabla^2 u$ with wave speed $c = 1$, the general solution with initial data\n",
        "\n",
        "$$u(\\mathbf{x},0) = f(\\mathbf{x}), \\quad u_t(\\mathbf{x},0) = g(\\mathbf{x})$$\n",
        "\n",
        "is given by:\n",
        "\n",
        "$$u(\\mathbf{x},t) = \\frac{1}{4\\pi t} \\int_{|\\xi - \\mathbf{x}| = t} g(\\xi) \\, dS(\\xi) + \\frac{1}{4\\pi t^2} \\int_{|\\xi - \\mathbf{x}| = t} f(\\xi) \\, dS(\\xi)$$\n",
        "\n",
        "In our case:\n",
        "\n",
        "* $f(x,y,z) = 0$\n",
        "* $g(x,y,z) = x$ (we’ll write this as $\\xi_1$ to distinguish from the field point $\\mathbf{x} = (x_1,x_2,x_3)$)\n",
        "* Therefore:\n",
        "\n",
        "$$u(\\mathbf{x},t) = \\frac{1}{4\\pi t} \\int_{|\\xi - \\mathbf{x}| = t} \\xi_1 \\, dS(\\xi)$$\n",
        "\n",
        "**Step 2:** $~$ Use coordinate shift\n",
        "\n",
        "Let’s simplify by performing a change of variables to center the sphere\n",
        "\n",
        "Let $\\mathbf{x} = (x_1, x_2, x_3)$, and let $\\xi = \\mathbf{x} + t\\omega$, where $\\omega \\in S^2$ is a unit vector.\n",
        "Then $|\\xi - \\mathbf{x}| = t$, and $dS(\\xi) = t^2\\, d\\omega$. So:\n",
        "\n",
        "$$u(\\mathbf{x},t) = \\frac{1}{4\\pi t} \\int_{|\\xi - \\mathbf{x}| = t} \\xi_1 \\, dS(\\xi)\n",
        "= \\frac{1}{4\\pi t} \\int_{S^2} (x_1 + t\\omega_1) \\cdot t^2 \\, d\\omega$$\n",
        "\n",
        "Simplify:\n",
        "\n",
        "$$u(\\mathbf{x},t) = \\frac{t}{4\\pi} \\int_{S^2} (x_1 + t\\omega_1) \\, d\\omega\n",
        "= \\frac{t}{4\\pi} \\left[ x_1 \\int_{S^2} d\\omega + t \\int_{S^2} \\omega_1 \\, d\\omega \\right]$$\n",
        "\n",
        "Now compute the integrals:\n",
        "\n",
        "* $\\displaystyle \\int_{S^2} d\\omega = 4\\pi$\n",
        "\n",
        "* $\\displaystyle \\int_{S^2} \\omega_1 \\, d\\omega = 0~$ (odd function over symmetric sphere)\n",
        "\n",
        "So:\n",
        "\n",
        "$$u(\\mathbf{x},t) = \\frac{t}{4\\pi} \\cdot x_1 \\cdot 4\\pi = x_1 t = x t$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**3.** $~$ Solve the vibrations of a membrane which is in the $xy$ plane:\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        " u_{tt} &= \\frac{\\rho}{T} \\left[ \\frac{\\partial^2 u}{\\partial x^2} +\\frac{\\partial^2 u}{\\partial y^2} \\right] , \\;\\; 0 < x < \\pi, \\;0 < y < \\pi \\\\\n",
        " u&(0, y, t) =0, \\; u(\\pi, y, t) =0 \\\\ \n",
        " u&(x, 0, t) =0, \\; u(x, \\pi, t) =0 \\\\ \n",
        " u&(x,y,0) = \\sin 2x \\sin 3y +\\sin 3x \\sin2y. \\;\n",
        " u_t(x,y,0) =0\n",
        "\\end{aligned}$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "**Step 1:** $~$ Separation of Variables\n",
        "\n",
        "Assume a solution of the form:\n",
        "$$u(x, y, t) = X(x) Y(y) T(t)$$\n",
        "Plugging into the wave equation:\n",
        "\n",
        "$$X Y T'' = c^2 \\left( X'' Y T + X Y'' T \\right)$$\n",
        "\n",
        "Divide both sides by $XYT$:\n",
        "\n",
        "$$\\frac{T''}{c^2 T} = \\frac{X''}{X} + \\frac{Y''}{Y} = -\\lambda$$\n",
        "\n",
        "We separate variables:\n",
        "$$\\frac{X''}{X} + \\frac{Y''}{Y} = -\\lambda \\Rightarrow\n",
        "\\begin{cases}\n",
        "X’’ + \\mu X = 0 \\\\\n",
        "Y’’ + (\\lambda - \\mu) Y = 0\n",
        "\\end{cases}$$\n",
        "\n",
        "With the boundary conditions:\n",
        "$$\\begin{aligned}\n",
        "X(0) &= X(\\pi) = 0 \\Rightarrow X_n(x) = \\sin(nx),\\quad \\mu = n^2 \\\\\n",
        "Y(0) &= Y(\\pi) = 0 \\Rightarrow Y_m(y) = \\sin(my),\\quad \\lambda - \\mu = m^2 \\Rightarrow \\lambda = n^2 + m^2\n",
        "\\end{aligned}$$\n",
        "\n",
        "Then the time part:\n",
        "$$\\begin{aligned}\n",
        " T'' &+ c^2(n^2 + m^2)T = 0\\\\ \n",
        " &\\Rightarrow\n",
        " T_{n,m}(t) = A_{n,m} \\cos(c\\sqrt{n^2 + m^2}t) + B_{n,m} \\sin(c\\sqrt{n^2 + m^2}t)\n",
        " \\end{aligned}$$\n",
        "\n",
        "**Step 2:** $~$ General Solution\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "u(x, y, t) = \\sum_{n=1}^{\\infty} \\sum_{m=1}^{\\infty} &\\left[ A_{n,m} \\cos(c\\sqrt{n^2 + m^2} t)\\right. \\\\ \n",
        "&\\left.+ B_{n,m} \\sin(c\\sqrt{n^2 + m^2} t) \\right] \\sin(nx) \\sin(my)\n",
        "\\end{aligned}\n",
        "$$\n",
        "\n",
        "**Step 3:** $~$ Apply Initial Conditions\n",
        "\n",
        "Initial displacement:\n",
        "\n",
        "$$u(x, y, 0) = \\sum_{n,m} A_{n,m} \\sin(nx)\\sin(my) = \\sin 2x \\sin 3y + \\sin 3x \\sin 2y$$\n",
        "\n",
        "So $A_{2,3} = 1$, $A_{3,2} = 1$, all others zero\n",
        "\n",
        "Initial velocity:\n",
        "$$u_t(x, y, 0) = -c\\sum_{n,m} c\\sqrt{n^2 + m^2} B_{n,m} \\sin(nx)\\sin(my) = 0 \\Rightarrow B_{n,m} = 0$$\n",
        "\n",
        "**Final Answer**\n",
        "\n",
        "$$u(x, y, t) = \\cos\\left(c \\sqrt{13}\\, t\\right) \\sin(2x) \\sin(3y)\n",
        "\t+\\cos\\left(c \\sqrt{13}\\, t\\right) \\sin(3x) \\sin(2y)$$\n",
        "\n",
        "where $c = \\sqrt{\\rho/T}$\n",
        "\n",
        "$~$"
      ],
      "id": "e5aaed7f"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "import numpy as np\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "def plot_rectangle_membrane_normal_modes(n, m):\n",
        "    \n",
        "    fig, ax = plt.subplots(figsize=(3, 3))\n",
        "\n",
        "    ax.set(xticks=[], yticks=[])\n",
        "\n",
        "    x_ = np.linspace(0, np.pi, 100)\n",
        "    y_ = np.linspace(0, np.pi, 100)\n",
        "\n",
        "    X_, Y_ = np.meshgrid(x_, y_)\n",
        "    U_ = np.sin(n*X_) *np.sin(m*Y_) +np.sin(m*X_) *np.sin(n*Y_) \n",
        "    \n",
        "    ax.contourf(X_, Y_, U_, levels=[0, 10])\n",
        "    \n",
        "    ax.set_title(f'$n={n}$, $m={m}$')\n",
        "    \n",
        "    plt.show()"
      ],
      "id": "82c2e329",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "plot_rectangle_membrane_normal_modes(2, 3)"
      ],
      "id": "008b79fa",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "**4.** $~$ Solve the vibrations of a membrane which is in the $xy$ plane:\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u_{tt} &= \\frac{\\rho}{T} \\left[ \\frac{\\partial^2 u}{\\partial x^2} +\\frac{\\partial^2 u}{\\partial y^2} \\right] , \\;\\; 0 < x < \\pi, \\;0 < y < \\pi \\\\\n",
        " u&(0, y, t) =0, \\; u(\\pi, y, t) =0 \\\\ \n",
        " u&(x, 0, t) =0, \\; u(x, \\pi, t) =0 \\\\ \n",
        " u&(x,y,0) = \\sin x \\sin 4y +\\sin 4x \\sin y, \\;\n",
        " u_t(x,y,0) =0\n",
        "\\end{aligned}$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "**Step 1:** $~$ Use Separation of Variables\n",
        "\n",
        "Assume a solution of the form:\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "u(x,y,t) = \\sum_{n=1}^\\infty \\sum_{m=1}^\\infty &\\left[ A_{nm} \\cos(c\\sqrt{n^2 + m^2} \\, t)\\right.\\\\ \n",
        "&+\\left. B_{nm} \\sin(c\\sqrt{n^2 + m^2} \\, t) \\right] \\sin(nx) \\sin(my)\n",
        "\\end{aligned}$$\n",
        "\n",
        "From the initial displacement:\n",
        "$$u(x,y,0) = \\sum_{n,m} A_{nm} \\sin(nx)\\sin(my) = \\sin x \\sin 4y + \\sin 4x \\sin y$$\n",
        "\n",
        "So the only nonzero coefficients are:\n",
        "$$A_{1,4} = 1,\\quad A_{4,1} = 1$$\n",
        "\n",
        "From the initial velocity condition:\n",
        "$$u_t(x,y,0) = 0 \\Rightarrow B_{nm} = 0$$\n",
        "\n",
        "**Step 2:** $~$ Final Solution\n",
        "\n",
        "$$\\begin{aligned}\n",
        "u(x, y, t) &= A_{1,4} \\cos(c \\sqrt{1^2 + 4^2} \\, t) \\sin x \\sin 4y\\\\\n",
        "\t&\\quad+\tA_{4,1} \\cos(c \\sqrt{4^2 + 1^2} \\, t) \\sin 4x \\sin y \\\\\n",
        "&= \\cos(c\\sqrt{17} \\, t) \\sin x \\sin 4y + \\cos(c\\sqrt{17} \\, t) \\sin 4x \\sin y\n",
        "\\end{aligned}$$\n",
        "\n",
        "Thus, the solution is:\n",
        "\n",
        "$$\n",
        "u(x, y, t) = \\cos(c\\sqrt{17} \\, t) \\left[ \\sin x \\sin 4y + \\sin 4x \\sin y \\right]\n",
        "$$\n",
        "\n",
        "where $c = \\sqrt{\\frac{\\rho}{T}}$\n",
        "\n",
        "$~$"
      ],
      "id": "0805d817"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "plot_rectangle_membrane_normal_modes(1, 4)"
      ],
      "id": "b2924ef4",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "**5.** $~$ Suppose the vibration of a string is described by $u_{tt}=u_{xx}$ and has an initial displacement as given by the following diagram:\n",
        "\n",
        "$(a)$\n",
        "\n",
        "<div>\n",
        "<center><img src=\"figures/2024_2_finalA.png\" width=\"500\"/></center>\n",
        "</div>\n",
        "\n",
        "$(b)$\n",
        "\n",
        "<div>\n",
        "<center><img src=\"figures/2024_2_finalB.png\" width=\"500\"/></center>\n",
        "</div>\n",
        "\n",
        "\n",
        "Assuming the initial velocity $u_t(x,0)=0$, describe the solution of this problem in the $xt$-plane and plot the solution at $t=4$ in the $xu$-plane\n",
        "\n",
        "**Solution**"
      ],
      "id": "e490fc81"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# Re-import libraries due to code state reset\n",
        "import numpy as np\n",
        "import matplotlib.pyplot as plt\n",
        "import matplotlib.animation as animation\n",
        "from IPython.display import HTML\n",
        "\n",
        "# Define the piecewise function f(x)\n",
        "def fa(x):\n",
        "    x = np.array(x)\n",
        "    result = np.zeros_like(x)\n",
        "    result[(x >= -3) & (x < -2)] = 1\n",
        "    result[(x > -2) & (x < -1)] = 2\n",
        "    result[(x >= -1) & (x < 1)] = 1\n",
        "    result[(x >= 1) & (x < 2)] = 2\n",
        "    result[(x >= 2) & (x < 3)] = 1\n",
        "    # result is already 0 elsewhere\n",
        "    return result\n",
        "\n",
        "def fb(x):\n",
        "    x = np.array(x)\n",
        "    result = np.zeros_like(x)\n",
        "    result[(x >= -3) & (x < -2)] = 1\n",
        "    result[(x > -2) & (x < -1)] = 2\n",
        "    result[(x >= -1) & (x < 1)] = 3\n",
        "    result[(x >= 1) & (x < 2)] = 2\n",
        "    result[(x >= 2) & (x < 3)] = 1\n",
        "    # result is already 0 elsewhere\n",
        "    return result    "
      ],
      "id": "4bee2dcb",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# Create meshgrid\n",
        "x = np.linspace(-10, 10, 400)\n",
        "t = np.linspace(0, 6, 200)\n",
        "X, T = np.meshgrid(x, t)\n",
        "\n",
        "Ua = 0.5 *(fa(X -T) +fa(X +T))\n",
        "Ub = 0.5 *(fb(X -T) +fb(X +T))\n",
        "\n",
        "# Plot u\n",
        "fig, axes = plt.subplots(2, 1, figsize=(7, 7))\n",
        "\n",
        "cba = axes[0].pcolormesh(x, t, Ua, vmin=0, vmax=3, cmap='gray_r')\n",
        "cbb = axes[1].pcolormesh(x, t, Ub, vmin=0, vmax=3, cmap='gray_r')\n",
        "plt.colorbar(cba, shrink=0.9, ticks=[0, 0.5, 1, 1.5, 2, 2.5, 3], label='u')\n",
        "plt.colorbar(cbb, shrink=0.9, ticks=[0, 0.5, 1, 1.5, 2, 2.5, 3], label='u')\n",
        "\n",
        "axes[0].axhline(y=4, color=\"black\", linestyle=\":\", label='$t=4$')\n",
        "axes[1].axhline(y=4, color=\"black\", linestyle=\":\", label='$t=4$')\n",
        "\n",
        "# Plot characteristics\n",
        "for x0 in [-3, -2, -1, 1, 2, 3]:\n",
        "    axes[0].plot(x0 +t, t, 'red', linestyle=':')\n",
        "    axes[0].plot(x0 -t, t, 'red', linestyle=':')\n",
        "    axes[1].plot(x0 +t, t, 'red', linestyle=':')\n",
        "    axes[1].plot(x0 -t, t, 'red', linestyle=':')    \n",
        "\n",
        "axes[0].set_title('Characteristic Lines and $u(x,t)$ in $x$-$t$ Plane')\n",
        "axes[1].set_xlabel('x')\n",
        "axes[0].set_ylabel('t')\n",
        "axes[1].set_ylabel('t')\n",
        "\n",
        "plt.legend(loc=4)\n",
        "plt.tight_layout()\n",
        "plt.show()"
      ],
      "id": "0912829d",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# Define u(x, t) = 1/2 [f(x -t) +f(x +t)] at t = 4\n",
        "\n",
        "t = 4\n",
        "x_vals = np.linspace(-10, 10, 1000)\n",
        "ua_vals = 0.5 *(fa(x_vals -t) +fa(x_vals +t))\n",
        "ub_vals = 0.5 *(fb(x_vals -t) +fb(x_vals +t))\n",
        "\n",
        "# Plot u(x, 4)\n",
        "fig, axes = plt.subplots(2, 1, figsize=(7, 6))\n",
        "\n",
        "axes[0].plot(x_vals, ua_vals, color='blue')\n",
        "axes[1].plot(x_vals, ub_vals, color='blue')\n",
        "\n",
        "axes[0].set_title('Displacement $u(x, 4)$ in the $xu$-plane')\n",
        "axes[1].set_xlabel('x')\n",
        "axes[0].set_ylabel('u(x, 4)')\n",
        "axes[1].set_ylabel('u(x, 4)')\n",
        "axes[0].grid(True)\n",
        "axes[1].grid(True)\n",
        "\n",
        "axes[0].set_ylim([-0.1, 2.1])\n",
        "axes[1].set_ylim([-0.1, 2.1])\n",
        "\n",
        "plt.tight_layout()\n",
        "plt.show()"
      ],
      "id": "a0ead2b6",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# Create grid\n",
        "x = np.linspace(-10, 10, 400)\n",
        "t_vals_light = np.linspace(0, 6, 40)\n",
        "\n",
        "# Set up the figure\n",
        "fig, axes = plt.subplots(2, 1, figsize=(7, 6))\n",
        "\n",
        "line0, = axes[0].plot([], [], lw=2)\n",
        "line1, = axes[1].plot([], [], lw=2)\n",
        "axes[0].set_xlim(-10, 10)\n",
        "axes[1].set_xlim(-10, 10)\n",
        "\n",
        "axes[0].set_ylim(-0.1, 3.1)\n",
        "axes[1].set_ylim(-0.1, 3.1)\n",
        "\n",
        "axes[1].set_xlabel('x')\n",
        "axes[0].set_ylabel('u(x,t)')\n",
        "axes[1].set_ylabel('u(x,t)')\n",
        "#axes[0].set_title('Wave Propagation Over Time')\n",
        "\n",
        "plt.close()\n",
        "\n",
        "# Animation functions\n",
        "def init():\n",
        "    line0.set_data([], [])\n",
        "    line1.set_data([], [])    \n",
        "    return line0, line1\n",
        "\n",
        "def animate(i):\n",
        "    t = t_vals_light[i]\n",
        "    ua = 0.5 *(fa(x -t) +fa(x +t))\n",
        "    ub = 0.5 *(fb(x -t) +fb(x +t))    \n",
        "    line0.set_data(x, ua)\n",
        "    line1.set_data(x, ub)    \n",
        "    axes[0].set_title(f'Wave at t = {t:.2f}')\n",
        "    return line0, line1\n",
        "\n",
        "# Create and save animation\n",
        "ani = animation.FuncAnimation(fig, animate, frames=len(t_vals_light),\n",
        "                              init_func=init, blit=True, interval=400)\n",
        "\n",
        "HTML('<center>' + ani.to_html5_video() + '</center>')"
      ],
      "id": "f0b932d5",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "**6.** $~$ Find $u\\left( \\frac{3}{8}, 3 \\right)$\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        " u_{tt} &= u_{xx}, \\;\\;0<x<1, \\; 0 < t < \\infty\\\\ \n",
        " u_x(0, t) &= 0\\\\\n",
        " u(1, t) &= 0\\\\\n",
        " u(x, 0) &=(1-x)^3 \\\\\n",
        " u_t(x, 0) &= (1-x)^2\n",
        "\\end{aligned}\n",
        "$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "Method of Solution: D’Alembert’s Formula with Function Extension\n",
        "\n",
        "**Step 1:** $~$ D’Alembert Solution on the Infinite Domain\n",
        "\n",
        "The general D’Alembert solution for the wave equation on the entire real line is:\n",
        "\n",
        "$$u(x,t) = \\frac{1}{2}\\left[f(x + t) + f(x - t)\\right] + \\frac{1}{2} \\int_{x - t}^{x + t} g(s)\\, ds$$\n",
        "\n",
        "This solution assumes that u is defined on the entire real line with no boundary conditions. To use this method on the interval $0 < x < 1$, we extend $f(x)$ and $g(x)$ to the whole real line by reflecting them in such a way that the boundary conditions are satisfied\n",
        "\n",
        "**Step 2:** $~$ Extend $f(x)$ and $g(x)$ to the Real Line\n",
        "\n",
        "We extend $f(x)$ and $g(x)$ as follows:\n",
        "\n",
        "Boundary Conditions:\n",
        "\n",
        "* Neumann at $x = 0 \\;\\Rightarrow\\;$ Extend as an even function about $x$ = 0\n",
        "* Dirichlet at $x = 1 \\;\\Rightarrow\\;$ Extend as an odd function about $x = 1$\n",
        "\n",
        "This leads to a 2-periodic extension over $\\mathbb{R}$. The steps:\n",
        "\n",
        "1.\tReflect $f(x)$, $g(x)$ evenly about $x = 0$\n",
        "2.\tReflect them oddly about $x = 1$\n",
        "3.\tPeriodically extend with period 4\n",
        "\n",
        "We denote the extended functions as $\\tilde{f}(x)$, $\\tilde{g}(x)$, defined for all $x \\in \\mathbb{R}$\n",
        "and this pattern repeats every 4 units:\n",
        "\n",
        "$$\\tilde{f}(x + 4) = \\tilde{f}(x)$$\n",
        "\n",
        "**Step 3:** $~$ Apply D’Alembert Formula\n",
        "\n",
        "Using the extended functions, the D’Alembert solution becomes:\n",
        "\n",
        "$$u(x,t) = \\frac{1}{2} \\left[\\tilde{f}(x + t) + \\tilde{f}(x - t)\\right] + \\frac{1}{2} \\int_{x - t}^{x + t} \\tilde{g}(s)\\, ds$$\n",
        "\n",
        "Now substitute $x = \\frac{3}{8}$, $t = 3$:\n",
        "\n",
        "$$u\\left( \\frac{3}{8}, 3 \\right) = \\frac{1}{2} \\left[ \\tilde{f}\\left(\\frac{3}{8} + 3\\right) + \\tilde{f}\\left(\\frac{3}{8} - 3\\right) \\right] + \\frac{1}{2} \\int_{\\frac{3}{8} - 3}^{\\frac{3}{8} + 3} \\tilde{g}(s)\\, ds$$\n",
        "\n",
        "* Construction of $\\tilde{f}(x)$ on $[0, 4)$:\n",
        "\n",
        "| Interval | Definition of $\\tilde{f}(x)$ | Reasoning     |\n",
        "|----------------|----------------------------------------|--------------------------------|\n",
        "| $0 \\leq x < 1$   | $(1 - x)^3$   | Original definition          |\n",
        "| $1 \\leq x < 2$   | $(1 - x)^3$  | Odd reflection about $x = 1$ |\n",
        "| $2 \\leq x < 3$   | $(x - 3)^3$  | Even reflection about $x = 2$ of previous term |\n",
        "| $3 \\leq x < 4$   | $(x - 3)^3$   | Odd reflection about $x = 3$ of previous term |\n",
        "\n",
        "* Construction of $\\tilde{g}(x)$ on $[0, 4)$:\n",
        "\n",
        "| Interval | Definition of $\\tilde{g}(x)$ | Reasoning     |\n",
        "|----------------|----------------------------------------|--------------------------------|\n",
        "| $0 \\leq x < 1$   | $\\phantom{-}(1 - x)^2$   | Original definition          |\n",
        "| $1 \\leq x < 2$   | $-(1 - x)^2$  | Odd reflection about $x = 1$ |\n",
        "| $2 \\leq x < 3$   | $-(x - 3)^2$  | Even reflection about $x = 2$ of previous term |\n",
        "| $3 \\leq x < 4$   | $\\phantom{-}(x - 3)^2$   | Odd reflection about $x = 3$ of previous term |"
      ],
      "id": "01e90cf4"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "import numpy as np\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "def tilde_fg(x):\n",
        "    x = np.array(x)\n",
        "    f = np.zeros_like(x)\n",
        "    g = np.zeros_like(x)    \n",
        "    \n",
        "    # (0, 1): original\n",
        "    mask1 = (0 <= x) & (x < 1)\n",
        "    f[mask1] = (1 -x[mask1])**3\n",
        "    g[mask1] = (1 -x[mask1])**2    \n",
        "\n",
        "    # (1, 2): odd reflection about x = 1\n",
        "    mask2 = (1 <= x) & (x < 2)\n",
        "    f[mask2] = (1 -x[mask2])**3\n",
        "    g[mask2] = -(1 -x[mask2])**2      \n",
        "\n",
        "    # (2, 3): even reflection about x = 2 \n",
        "    mask3 = (2 <= x) & (x < 3)\n",
        "    f[mask3] = (x[mask3] -3)**3  # no sign change\n",
        "    g[mask3] = -(x[mask3] -3)**2\n",
        "\n",
        "    # (3, 4): odd reflection about x = 3\n",
        "    mask4 = (3 <= x) & (x <= 4)\n",
        "    f[mask4] = (x[mask4] -3)**3\n",
        "    g[mask4] = (x[mask4] -3)**2\n",
        "\n",
        "    return f, g\n",
        "\n",
        "# Domain\n",
        "x_vals = np.linspace(0, 4, 1000)\n",
        "f_vals, g_vals = tilde_fg(x_vals)\n",
        "\n",
        "# Plot\n",
        "plt.figure(figsize=(6, 4))\n",
        "plt.plot(x_vals, f_vals, color='red', label=r'$\\tilde{f}$')\n",
        "plt.plot(x_vals, g_vals, color='blue', label=r'$\\tilde{g}$')\n",
        "\n",
        "plt.title(r'$\\tilde{f}(x), \\tilde{g}(x)$ on $[0, 4)$')\n",
        "plt.xlabel('x')\n",
        "plt.ylabel(r'$\\tilde{f}(x), \\tilde{g}(x)$')\n",
        "plt.legend()\n",
        "plt.grid(True)\n",
        "plt.tight_layout()\n",
        "plt.show()"
      ],
      "id": "726d3c5b",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**Step 4:** $~$ Evaluate $\\tilde{f}(x \\pm t)$\n",
        "\n",
        "$$x = \\frac{3}{8} = 0.375,\\quad t = 3 \\Rightarrow x + t = 3.375,\\quad x - t = -2.625$$\n",
        "\n",
        "Using 4-periodicity:\n",
        "\n",
        "* $3.375 \\mod 4 = 3.375$\n",
        "* $-2.625 \\mod 4 = 1.375$\n",
        "\n",
        "Thus:\n",
        "\n",
        "* $\\tilde{f}(3.375) = (3.375 - 3)^3 = (0.375)^3 = \\frac{27}{512}$\n",
        "* $\\tilde{f}(1.375) = (1 -1.375)^3 = - (0.375)^3 = -\\frac{27}{512}$\n",
        "\n",
        "So the average is:\n",
        "\n",
        "$$\\frac{1}{2} \\left[ \\tilde{f}(3.375) + \\tilde{f}(-2.625) \\right] = \\frac{1}{2} \\left( \\frac{27}{512} - \\frac{27}{512} \\right) = 0$$\n",
        "\n",
        "**Step 5:** $~$ Evaluate the Integral Term\n",
        "\n",
        "We now compute:\n",
        "\n",
        "$$\\int_{-2.625}^{3.375} \\tilde{g}(s)\\, ds =\n",
        "\\underbrace{\\int_{-2.625}^{-2} \\tilde{g}(s)\\, ds}_{A}\n",
        "\t+\\underbrace{\\int_{-2}^{2} \\tilde{g}(s)\\, ds}_{0}\n",
        "\t+\\underbrace{\\int_{2}^{3.375} \\tilde{g}(s)\\, ds}_{B}$$\n",
        "\n",
        "We computed the tails:\n",
        "\n",
        "*\t$\\displaystyle A = \\int_{-2.625}^{-2} \\tilde{g}(s)\\, ds = -\\int_{1.375}^{2} (s - 1)^2 ds = \\boxed{-\\frac{485}{1536}}$\n",
        "\n",
        "*\t$\\displaystyle B = \\int_{2}^{3.375} \\tilde{g}(s)\\, ds$\n",
        "  \n",
        "  We split this into two parts, because the definition of $\\tilde{g}(s)$ changes at $s = 3$:\t\n",
        "  \n",
        "  *\tOn $[2, 3)$: $\\tilde{g}(s) = (3 - s)^2$\n",
        "\n",
        "    $$\\int_{2}^{3} (3 - s)^2 ds = \\int_1^0 u^2 (-du) = \\int_0^1 u^2 du = \\left[\\frac{u^3}{3}\\right]_0^1 = \\frac{1}{3}$$\n",
        "\n",
        "  *\tOn $[3, 3.375]$: $\\tilde{g}(s) = -(s - 3)^2$\n",
        "\n",
        "  $$\\int_{3}^{3.375} - (s - 3)^2 ds = - \\int_0^{3/8} v^2 dv = - \\left[\\frac{v^3}{3}\\right]_0^{3/8}\n",
        "= - \\frac{(3/8)^3}{3} = - \\frac{27}{1536}$$\n",
        "\n",
        "So:\n",
        "\n",
        "$$\\int_{2}^{3.375} \\tilde{g}(s)\\, ds = \\frac{1}{3} - \\frac{27}{1536} = \\frac{512 - 27}{1536} = \\boxed{\\frac{485}{1536}}$$\n",
        "\n",
        "**Final Answer:**\n",
        "\n",
        "Recall that from the previous step:\n",
        "\n",
        "$$\\frac{1}{2} [\\tilde{f}(x+t) + \\tilde{f}(x - t)] = 0\n",
        "\\quad\\text{and}\\quad \\text{(integral term)} = 0$$\n",
        "\n",
        "$$\\boxed{u\\left( \\frac{3}{8}, 3 \\right) = 0}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**7.** $~$ Suppose the vibration of a string is described by $u_{tt}=u_{xx}$ and has an initial displacement as given by the following diagram:\n",
        "\n",
        "\n",
        "![](./figures/2023_final_2_B_2.jpg)\n",
        "\n",
        "Assuming the initial velocity $u_t(x,0)=0$, describe the solution of this problem in the $xt$-plane"
      ],
      "id": "c87b1a99"
    }
  ],
  "metadata": {
    "kernelspec": {
      "name": "python3",
      "language": "python",
      "display_name": "Python 3 (ipykernel)",
      "path": "/opt/miniconda3/share/jupyter/kernels/python3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}