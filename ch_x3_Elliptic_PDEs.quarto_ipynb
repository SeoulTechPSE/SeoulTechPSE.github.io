{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "---\n",
        "jupyter: python3\n",
        "---\n",
        "\n",
        "# Elliptic Partial Differential Equations {#sec-x3}\n",
        "\n",
        "## The Laplacian (an Intuitive Description) {#sec-x3-31}\n",
        "\n",
        "* The <font color=red> Laplacian operator </font>\n",
        "\n",
        "  $$ \\nabla^2 =\\frac{\\partial^2}{\\partial x^2} +\\frac{\\partial^2}{\\partial y^2} +\\frac{\\partial^2}{\\partial z^2}$$\n",
        "\n",
        "  is probably the most important operator in mathematical physics. $\\,$The question is, $\\,$what does it mean and why should the sum of three second derivatives have anything to do with the laws of nature? \n",
        "\n",
        "* The answer to this lies in the fact that <font color=red>the Laplacian of a function allows us to compare the function at a point with the function at neighboring points</font>. $\\,$It does what the second derivative did in one dimension and might be thought of as <font color=blue>a second derivative generalized to higher dimensions</font>\n",
        "\n",
        "$~$\n",
        "\n",
        "![](figures/pde03_figure01.jpg \"Intutive Meaning of the Laplacian\"){width=\"90%\" fig-align=\"center\"}\n",
        "\n",
        "$~$\n",
        "\n",
        "* The heat equation $\\,u_t=\\alpha\\nabla^2 u\\,$ measures temperature $\\,u$, and the equation can be interpreted to mean that <font color=blue>the change in temperature with respect to time $\\,u_t$ is proportional to $\\,\\nabla^2 u$</font>. $\\,$That is, $\\,$the temperature at a point is increasing if the temperature at that point is less than the average of the temperature on a circle around the point\n",
        "\n",
        "* The wave equation $\\,u_{tt}=c^2\\nabla^2 u\\,$ measures the displacement of a drumhead and can be interpreted to mean that <font color=blue>the acceleration (or force) of a point on the drumhead $\\,u_{tt}\\,$ is proportional to $\\,\\nabla^2 u$</font>. $\\,$That is, $\\,$the drumhead at a point is accelerating upward if the drumhead at that point is less than the average of its neighbors\n",
        "\n",
        "* <font color=blue>Laplace's equation $\\,\\nabla^2 u = 0\\,$ says that the solution $\\,u\\,$ is always equal to the average of its neighbors</font>. $\\,$For example, $\\,$a steady-state, stretched rubber membrane satisfies Laplace's equation, $\\,$hence, $\\,$the height of the membrane at any point is equal to the average height of the membrane on a circle around the point\n",
        "\n",
        "* <font color=blue>Poisson's equation $\\,\\nabla^2 u=f$</font>, $\\,$where $\\,f\\,$ is a function that depends only on the space variables\n",
        "\n",
        "  * $\\nabla^2 u=-\\rho\\,$ describes the potential of an electrostatic field where $\\,\\rho\\,$ represents a constant charge density\n",
        "  * $\\nabla^2 u =-g(x,y)\\,$ describes the steady-state temperature $\\,u(x,y)\\,$ due to a heat source $\\,g(x,y)$ \n",
        "\n",
        "* <font color=blue>$\\nabla^2 u +\\lambda u =0\\,$ is known as the Helmholtz equation</font> which describes the fundamental shapes of a stretched membrane\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Changing Coordinates**\n",
        "\n",
        "  Before we start, $\\,$however, $\\,$let's review briefly the three major coordinate systems in two or three dimensions except for Cartesian system:\n",
        "\n",
        "  * Polar Coordinates\n",
        "\n",
        "    ![](figures/pde03_figure02.jpg \"Polar Coordinate\"){width=\"45%\" fig-align=\"center\"}\n",
        "\n",
        "    $$\\begin{matrix}\n",
        "      x = r\\cos\\theta \\\\ \n",
        "      y = r\\sin\\theta \\, \\\\ \n",
        "      \\end{matrix} \\;\\; \\Rightarrow \\;\\;\n",
        "      \\begin{matrix}\n",
        "        r^2 = x^2 + y^2 \\;\\;\\;\\\\ \n",
        "        \\tan\\theta = y/x \\;\\;\\;\\;\\;\n",
        "    \\end{matrix}$$\n",
        "\n",
        "    As an illustration, $\\,$we see how the two-dimensional Laplacian is transformed into polar coordinates:\n",
        "\n",
        "    $$\\scriptsize \n",
        "    \\begin{aligned}\n",
        "    \\nabla^2u &= u_{xx} +u_{yy}\\\\ \n",
        "    &\\Updownarrow \\\\ \n",
        "    u_x = u_r r_x +u_\\theta \\theta_x &= u_r \\cos\\theta -u_\\theta \\frac{\\sin\\theta}{r}\\\\ \n",
        "    u_y = u_r r_y +u_\\theta \\theta_y &= u_r \\sin\\theta +u_\\theta \\frac{\\cos\\theta}{r}\\\\ \n",
        "    &\\Downarrow \\\\\n",
        "    u_{xx} = (u_x)_r r_x +(u_x)_\\theta \\theta_x =& \n",
        "        {\\tiny\\left( u_{rr} \\cos\\theta -u_{\\theta r} \\frac{\\sin\\theta}{r} +u_\\theta\\frac{\\sin\\theta}{r^2} \\right) \\cos\\theta \n",
        "        -\\left( u_{r\\theta} \\cos\\theta -u_r\\sin\\theta -u_{\\theta\\theta} \\frac{\\sin\\theta}{r} \n",
        "        -u_\\theta \\frac{\\cos\\theta}{r} \\right) \\frac{\\sin\\theta}{r} }\\\\\n",
        "    u_{yy} = (u_y)_r r_y +(u_y)_\\theta \\theta_y =& \n",
        "    {\\tiny  \\left( u_{rr} \\sin\\theta +u_{\\theta r} \\frac{\\cos\\theta}{r} -u_\\theta\\frac{\\cos\\theta}{r^2} \\right) \\sin\\theta \n",
        "        +\\left( u_{r\\theta} \\sin\\theta +u_r\\cos\\theta +u_{\\theta\\theta} \\frac{\\cos\\theta}{r} \n",
        "        -u_\\theta \\frac{\\sin\\theta}{r} \\right) \\frac{\\cos\\theta}{r} } \\\\\n",
        "        &\\Updownarrow \\\\\n",
        "        \\color{red}{\\nabla^2 u = u_{rr}} &\\color{red}{+\\frac{1}{r} u_r +\\frac{1}{r^2} u_{\\theta\\theta}} \n",
        "    \\end{aligned}$$\n",
        "\n",
        "  * Cylindrical Coordinates\n",
        "\n",
        "    ![](figures/pde03_figure03.jpg \"Cylindrical Coordinate\"){width=\"55%\" fig-align=\"center\"}\n",
        "\n",
        "    $$\\begin{matrix}\n",
        "        x = r\\cos \\theta \\\\ \n",
        "        y = r\\sin \\theta \\, \\\\\n",
        "        z = z \\quad\\;\\;\\;\n",
        "        \\end{matrix} \\;\\; \\Rightarrow \\;\\;\n",
        "        \\begin{matrix}\n",
        "        r^2 = x^2 + y^2 \\;\\;\\;\\\\ \n",
        "        \\tan\\theta = y/x  \\quad\\; \\\\\n",
        "        z=z \\qquad\\;\\;\\;\\;\n",
        "    \\end{matrix}$$\n",
        "\n",
        "    Changing the Laplacian $\\,\\nabla^2 u = u_{xx} +u_{yy} +u_{zz}\\,$ to cylindrical coordinates, $\\,$we can show\n",
        "\n",
        "    $$ \\color{red}{\\nabla^2 u = u_{rr} +\\frac{1}{r} u_r +\\frac{1}{r^2} u_{\\theta\\theta} +u_{zz}}$$\n",
        "\n",
        "  * Spherical Coordinates\n",
        "\n",
        "    ![](figures/pde03_figure04.jpg \"Spherical Coordinate\"){width=\"65%\" fig-align=\"center\"}\n",
        "\n",
        "    $$\\begin{matrix}\n",
        "    x = r\\sin\\phi\\cos \\theta \\\\ \n",
        "    y = r\\sin\\phi\\sin \\theta \\, \\\\\n",
        "    z = r\\cos\\phi \\quad\\;\\;\\;\n",
        "    \\end{matrix} \\;\\; \\Rightarrow \\;\\;\n",
        "    \\begin{matrix}\n",
        "    r^2 = x^2 + y^2 +z^2 \\;\\;\\;\\\\ \n",
        "    \\cos\\phi = z/r \\qquad\\;\\;\\;\\;\\\\\n",
        "    \\tan\\theta=y/x \\qquad\\;\\;\\;\\;\n",
        "    \\end{matrix}$$\n",
        "\n",
        "    Finally, $\\,$if we write the Laplacian in spherical coordinates, $\\,$we have\n",
        "\n",
        "    $$\\scriptsize \\begin{aligned}\n",
        "    \\nabla^2u &= u_{xx} +u_{yy} +u_{zz}\\\\ \n",
        "    &\\Updownarrow \\\\ \n",
        "    u_x = u_r r_x +u_\\phi \\phi_x+u_\\theta \\theta_x &= u_r \\sin\\phi\\cos\\theta +u_\\phi \\frac{\\cos\\phi\\cos\\theta}{r}\n",
        "    -u_\\theta \\frac{\\sin\\theta}{r\\sin\\phi}\\\\ \n",
        "    u_y = u_r r_y +u_\\phi \\phi_y+u_\\theta \\theta_y &= u_r \\sin\\phi\\sin\\theta +u_\\phi \\frac{\\cos\\phi\\sin\\theta}{r}\n",
        "    +u_\\theta \\frac{\\cos\\theta}{r \\sin\\phi}\\\\ \n",
        "    u_z = u_r r_z +u_\\phi \\phi_z+u_\\theta \\theta_z &= u_r \\cos\\phi -u_\\phi\\frac{\\sin\\phi}{r} \\\\ \n",
        "    &\\Downarrow \\\\\n",
        "        u_{xx} = (u_x)_r r_x +(u_x)_\\phi \\phi_x+(u_x)_\\theta \\theta_x &= \n",
        "    {\\tiny \\left( u_{rr} \\sin\\phi\\cos\\theta +u_{\\phi r} \\frac{\\cos\\phi\\cos\\theta}{r} -u_\\phi\\frac{\\cos\\phi\\cos\\theta}{r^2}\n",
        "        -u_{\\theta r} \\frac{\\sin\\theta}{r\\sin\\phi} +u_\\theta\\frac{\\sin\\theta}{r^2\\sin\\phi} \\right) \n",
        "        \\sin\\phi\\cos\\theta} \\\\\n",
        "    { \\tiny +\\left( u_{r\\phi}\\sin\\phi \\cos\\theta \\right. }&{\\tiny\\, \\left. +u_r\\cos\\phi\\cos\\theta +u_{\\phi\\phi} \\frac{\\cos\\phi\\cos\\theta}{r} -u_{\\phi} \\frac{\\sin\\phi\\cos\\theta}{r} \n",
        "        -u_{\\theta\\phi} \\frac{\\sin\\theta}{r\\sin\\phi} +u_\\theta \\frac{\\sin\\theta\\cot\\phi}{r\\sin\\phi}\n",
        "    \\right)\\frac{\\cos\\phi \\cos\\theta}{r}} \\\\\n",
        "    {\\tiny -\\left( u_{r\\theta}\\sin\\phi\\cos\\theta \\right. }&{\\tiny \\, \\left. -u_r \\sin\\phi\\sin\\theta +u_{\\phi\\theta} \\frac{\\cos\\phi\\cos\\theta}{r} \n",
        "    -u_\\phi \\frac{\\cos\\phi\\sin\\theta}{r} -u_{\\theta\\theta}\\frac{\\sin\\theta}{r\\sin\\phi} -u_\\theta \\frac{\\cos\\theta}{r\\sin\\phi} \\right) \n",
        "    \\frac{\\sin\\theta}{r\\sin\\phi} }\\qquad\\qquad\n",
        "    \\end{aligned}$$\n",
        "\n",
        "    $$\\scriptsize \\begin{aligned}\n",
        "        u_{yy} = (u_y)_r r_y +(u_y)_\\phi \\phi_y+(u_y)_\\theta \\theta_y &= \n",
        "    {\\tiny \\left( u_{rr} \\sin\\phi\\sin\\theta +u_{\\phi r} \\frac{\\cos\\phi\\sin\\theta}{r}  -u_\\phi\\frac{\\cos\\phi\\sin\\theta}{r^2}\n",
        "        +u_{\\theta r} \\frac{\\cos\\theta}{r\\sin\\phi} -u_\\theta\\frac{\\cos\\theta}{r^2\\sin\\phi} \\right) \n",
        "        \\sin\\phi\\sin\\theta }\\\\\n",
        "    {\\tiny+\\left( u_{r\\phi}\\sin\\phi \\sin\\theta \\right.} &{\\tiny\\, \\left. +u_r\\cos\\phi\\sin\\theta +u_{\\phi\\phi} \\frac{\\cos\\phi\\sin\\theta}{r} -u_{\\phi} \\frac{\\sin\\phi\\sin\\theta}{r} \n",
        "        +u_{\\theta\\phi} \\frac{\\cos\\theta}{r\\sin\\phi} -u_\\theta \\frac{\\cos\\theta\\cot\\phi}{r\\sin\\phi}\n",
        "    \\right)\\frac{\\cos\\phi \\sin\\theta}{r}} \\\\\n",
        "    {\\tiny+\\left( u_{r\\theta}\\sin\\phi\\sin\\theta \\right.} &{\\tiny \\, \\left.+u_r \\sin\\phi\\cos\\theta +u_{\\phi\\theta} \\frac{\\cos\\phi\\sin\\theta}{r} \n",
        "    +u_\\phi \\frac{\\cos\\phi\\cos\\theta}{r} +u_{\\theta\\theta}\\frac{\\cos\\theta}{r\\sin\\phi} -u_\\theta \\frac{\\sin\\theta}{r\\sin\\phi} \\right) \n",
        "    \\frac{\\cos\\theta}{r\\sin\\phi} }\\\\\n",
        "        u_{zz} = (u_z)_r r_z +(u_z)_\\phi \\phi_z+(u_z)_\\theta \\theta_z \n",
        "        &={\\tiny \\left( u_{rr}\\cos\\phi -u_{\\phi r}\\frac{\\sin\\phi}{r} +u_\\phi\\frac{\\sin\\phi}{r^2} \\right) \\cos\\phi} \n",
        "        {\\tiny +\\left( -u_{r\\phi}\\cos\\phi \\right. +}{\\tiny\\, \\left. u_{r}\\sin\\phi +u_{\\phi\\phi}\\frac{\\sin\\phi}{r} +u_\\phi\\frac{\\cos\\phi}{r} \\right) \\frac{\\sin\\phi}{r}}\\\\ \n",
        "        &\\Downarrow \\\\\n",
        "        \\color{red}{\\nabla^2 u =u_{rr} +\\frac{2}{r} u_r }&\\color{red}{+\\frac{1}{r^2}u_{\\phi\\phi} +\\frac{\\cot\\phi}{r^2} u_{\\phi} +\\frac{1}{r^2\\sin^2\\phi}u_{\\theta\\theta}} \\\\\n",
        "        \\color{red}{= \\frac{1}{r^2}\\left(  r^2 u_r \\right)_r }& \\color{red}{+\\frac{1}{r^2 \\sin\\phi} \\left( \\sin\\phi\\, u_\\phi \\right)_\\phi +\\frac{1}{r^2\\sin^2\\phi}u_{\\theta\\theta}}\n",
        "    \\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**NOTES**\n",
        "\n",
        "* <font color=blue>The Laplacian in cartesian coordinates is the only one with constant coefficients</font>. $\\,$This is one reason why problems in other coordinate systems are harder to solve. $\\,$<font color=blue>It is still possible to use the separation of variables for these equations with variable coefficients; $\\,$it's just that some of the resulting ordinary differential equations have variables coefficients</font>\n",
        "\n",
        "* We arrive at a lot of fairly complicated equations, $\\,$such as Bessel's equation, $\\,$Legendre equation, and other so-called classical equations of physics. $\\,$To solve these equations, $\\,$we must resort to infinite-series solutions and, $\\,$in particular, $\\,$the method of Frobenious\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ What is the wave equation $\\,u_{tt}=c^2\\nabla^2 u\\,$ in polar coordinates if you know that the solution $\\,u\\,$ depends only on $\\,r\\,$ and $\\,t$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ What is Laplace's equation in spherical coordinates if the solution $\\,u\\,$ depends only on $\\,r$? $\\,$Can you find the solutions of this equation? These are the spherically symmetric potentials in three dimensions\n",
        "\n",
        "$~$\n",
        "\n",
        "## General Nature of Boundary-Value Problems {#sec-x3-32}\n",
        "\n",
        "* <font color=blue>Many important problems whose outcomes do not change with time are described by elliptic boundary-value problems</font>. $\\,$There are two common situations in physical problems that give rise to PDEs that don't involve time; $\\,$they are:\n",
        "\n",
        "  <font color=blue>1. $\\;$Steady-state problems</font>\n",
        "\n",
        "  <font color=blue>2. $\\;$Problems where we factor out the time component in the solution</font>\n",
        "\n",
        "* When studying boundary-value problems (BVPs), $\\,$there are three types of BCs that are most common; $\\,$we discuss these three types now\n",
        "\n",
        "* **Dirichlet Problems**\n",
        "\n",
        "  <font color=blue>Here, $\\,$the PDE holds over a given region of space, $\\,$and the solution is specified on the boundary of the region</font>. $\\,$An example would be to find the steady-state temperature inside a circle with the temperature given on the boundary\n",
        "\n",
        "  $$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=0, $$\n",
        "  $$\\;\\; u(1,\\theta) = \\sin\\theta, \\;\\;\\;0 < r < 1,\\;\\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "  ![](figures/pde03_figure05.jpg \"Interior Dirichlet Problem\"){width=\"45%\" fig-align=\"center\"}\n",
        "\n",
        "  Another example would be an exterior Dirichlet problem in which we are looking for the solution of Laplace's equation outside the unit circle, $\\,$and the boudary condition is given on the circle\n",
        "\n",
        "\n",
        "  ![](figures/pde03_figure06.jpg \"Exterior Dirichlet Problem\"){width=\"45%\" fig-align=\"center\"}\n",
        "\n",
        "* **Neumann Problems**\n",
        "\n",
        "  Here, $\\,$<font color=blue>the PDE holds in some region of space, $\\,$but now the outward normal derivative \n",
        "  \n",
        "  $$\\frac{\\partial u}{\\partial n}$$ \n",
        "  \n",
        "  (which is proportional to the inward flux) is specified on the boundary</font>. $\\,$For example, $\\,$suppose the inward flow of heat varies around the circle according to\n",
        "\n",
        "  $$ \\frac{\\partial u}{\\partial r}=\\sin\\theta$$\n",
        "\n",
        "  The steady-state temperature inside the circle would then be given by the solution of the BVP\n",
        "\n",
        "  $$ \\nabla^2 u = 0, \\quad 0 < r < 1$$\n",
        "\n",
        "  $$ \\frac{\\partial u}{\\partial r} =\\sin\\theta, \\quad r=1, \\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "  Here, $\\,$we can see that the flux of heat across the boundary is inward for $\\,0 \\leq \\theta \\leq \\pi\\,$ and outward for $\\,\\pi \\leq \\theta < 2\\pi$\n",
        "\n",
        "\n",
        "  ![](figures/pde03_figure07.jpg \"heat flow for the Neumann problem\"){width=\"40%\" fig-align=\"center\"}  \n",
        "\n",
        "  However, $\\,$since the total flux\n",
        "\n",
        "  $$ \\int_0^{2\\pi} \\frac{\\partial u}{\\partial r}\\, d\\theta\\;=\\int_0^{2\\pi} \\sin\\theta \\,d\\theta = 0$$\n",
        "\n",
        "  (a condition that must be true for Neumann problems), $\\,$we can say that the temperature at each point inside circle does not change with respect to time. $\\,$In other words, $\\,$<font color=blue>Neumann problems make sense only if the net gain in heat across the boundary is zero</font>\n",
        "\n",
        "  The Neumann problem is somewhat different from other boundary conditions, $\\,$<font color=red>in that solutions are not unique</font>. $\\,$In other words, $\\,$the above Neumann problem has an infinite number of solutions $\\,u(r,\\theta)$. $\\,$<font color=blue>Once we have one solution, $\\,$we can get the others just by adding a constant.</font> $\\,$For example, $\\,$one solution to our Neumann problem is\n",
        "\n",
        "  $$ u(r,\\theta)=r\\sin\\theta$$\n",
        "\n",
        "  and it is obvious that if we add a constant to this solution, $\\,$another one is obtained. $\\,$For this reason, $\\,$<font color=blue>if we want to find one solution to the Neumann problem, $\\,$we must have some additional information (like knowing the solution at one point)</font>\n",
        "\n",
        "* **Robin Problems**\n",
        "\n",
        "  These problems correspond to the PDEs being given in some region of space, $\\,$<font color=blue>but now the condition on the boundary is a mixture of the first two kinds</font>\n",
        "\n",
        "  $$ \\frac{\\partial u}{\\partial n} = -h(u -g)$$\n",
        "\n",
        "  where $\\,h\\,$ is a constant and $\\,g\\,$ is a given function that can vary over the boundary. $\\,$This BC says the inward flux across the boundary is proportional to the difference between the boundary value of $\\,u\\,$ and specified environment value $\\,g\\,$ \n",
        "\n",
        "  In heat transfer, $\\,$this, $\\,$of course, $\\,$is just Newton's law of cooling. $\\,$The constant $\\,h\\,$ is a physical parameter that measures the amount of flux across the boundary per difference between $\\,u\\,$ and $\\,g$. $\\,$<font color=\"blue\">If $\\,h\\,$ is large, $\\,$and so the solution looks very much like the solution of the Dirichlet problem $\\,u=g$. $\\,$On the order hand, $\\,$if $\\,h=0$, then the BC is reduced to the insulated BC</font>\n",
        "\n",
        "  $$ \\color{blue}{\\frac{\\partial u}{\\partial r}=0} $$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Does the following Neumann have a solution inside the circle?\n",
        "\n",
        "$$ \\nabla^2 u = 0, \\quad 0 < r < 1$$\n",
        "\n",
        "$$ \\frac{\\partial u}{\\partial r} =\\sin^2\\theta, \\quad r=1, \\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ For different values of $h$, $~$imagine the solution $u(r,\\theta)\\,$ to\n",
        "\n",
        "$$ \\nabla^2 u = 0, \\quad 0 < r < 1$$\n",
        "\n",
        "$$ \\frac{\\partial u}{\\partial r} +h(u -\\sin\\theta)=0, \\quad r=1, \\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Interior Dirichlet Problem for a Circle {#sec-x3-33}\n",
        "\n",
        "* This section presents a number of new ideas to solve the interior Dirichlet problem for the circle\n",
        "\n",
        "  $$ \\color{red}{u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=0, \\;\\;\\;0 < r < 1}$$\n",
        "\n",
        "  $$ \\color{red}{u(1,\\theta) = g(\\theta), \\;\\;\\; 0 \\leq \\theta < 2\\pi}$$\n",
        "\n",
        "  The method of separation of variables will be the usual procedure\n",
        "\n",
        "  $$\\scriptsize\\begin{aligned}\n",
        "    u_{rr} +\\frac{1}{r}u_r \n",
        "    &+\\frac{1}{r^2}u_{\\theta\\theta}= 0 \\\\ \n",
        "    u(1,\\theta) &= g(\\theta) \\\\ \n",
        "    &\\Downarrow u(r,\\theta)=R(r)\\Theta(\\theta)\\\\ \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  $$\\scriptsize\\begin{aligned}\n",
        "    -\\frac{r^2R'' +rR'}{R} \n",
        "     &= \\frac{\\;\\Theta''}{\\Theta} =-\\lambda \\leq 0 \\\\ \n",
        "    &\\Downarrow \\\\\n",
        "    \\Theta'' +\\lambda \\Theta =0 \n",
        "     \\;\\; \\xrightarrow[] \n",
        "      {\\;\\;\\Theta(0)=\\Theta(2\\pi),\\;\\Theta'(0)\n",
        "      =\\Theta'(2\\pi)\\;\\;} \n",
        "        &\\;\\;\\Theta_n(\\theta)=a_n \\cos n\\theta \n",
        "        +b_n \\sin n\\theta, \\;\\; \\lambda_n =n^2, \n",
        "        \\;\\; n=0,1,2,\\cdots \\\\\n",
        "    &\\Downarrow \\\\\n",
        "    r^2R_0'' +rR_0'=0\\; \n",
        "     &\\xrightarrow[]{\\;\\;| R_0(0)| \\,<\\,\\infty  \\;\\;} \n",
        "      \\;\\; R_0(r)=1 \\\\ \n",
        "    r^2R_n''+rR_n' -n^2 R_n=0,\\;\\;n =1,2,\\cdots\\; \n",
        "     &\\xrightarrow[]{\\;\\; | R_n(0) | \\,<\\,\\infty \\;\\;} \n",
        "      \\;\\;R_n(r)= r^n \\\\ \n",
        "    &\\Downarrow \\\\\n",
        "    \\color{red}{u(r,\\theta) =\\frac{a_0}{2} \n",
        "     +\\sum_{n=1}^\\infty }\n",
        "     &\\color{red}{ r^n \\left( a_n \\cos n\\theta \n",
        "      +b_n \\sin n\\theta \\right)} \\\\\n",
        "    a_n = \\frac{1}{\\pi} \\int_0^{2\\pi} &g(\\theta) \n",
        "     \\cos n\\theta \\,d\\theta \\\\\n",
        "    b_n = \\frac{1}{\\pi} \\int_0^{2\\pi} &g(\\theta) \n",
        "     \\sin n\\theta \\,d\\theta\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  * The solution can be interpreted as expanding the boundary function $\\,g(\\theta)\\,$ as a Fourier series\n",
        "\n",
        "    $$ g(\\theta)=\\frac{a_0}{2} +\\sum_{n=1}^\\infty \\left(a_n \\cos n\\theta +b_n \\sin n\\theta \\right)$$\n",
        "\n",
        "      and solve the problem for $\\,\\cos n\\theta\\,$ and $\\,\\sin n\\theta\\,$ in the series. $\\,$Since each of these terms will give rise to solutions $\\,r^n\\cos n\\theta\\,$ and $\\,r^n \\sin n\\theta$, $\\,$we can then say (by superposition) that\n",
        "\n",
        "    $$ u(r,\\theta)=\\frac{a_0}{2} +\\sum_{n=1}^\\infty {\\color{red}{r^n}} \\left(a_n \\cos n\\theta +b_n \\sin n\\theta \\right)$$\n",
        "\n",
        "  * Note that the constant term $\\,\\displaystyle\\frac{a_0}{2}\\,$ in the solution represents the average of $\\,g(\\theta)$\n",
        "\n",
        "    $$ \\frac{a_0}{2} = \\frac{1}{2\\pi} \\int_0^{2\\pi} g(\\theta)\\,d\\theta$$\n",
        "\n",
        "  * If the radius of the circle was arbitrary (say $R$), $\\,$then the solution would be\n",
        "\n",
        "    $$ u(r,\\theta)=\\frac{a_0}{2} +\\sum_{n=1}^\\infty \\left(\\frac{r}{R}\\right)^n \\left(a_n \\cos n\\theta +b_n \\sin n\\theta \\right)$$\n",
        "\n",
        "    This completes our discussion of the separation of variables solution. $\\,$We now go to the interesting Poisson integral formula\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$The solution of\n",
        "\n",
        "$$ \\quad\\;\\;\\;\\nabla^2 u = 0, \\quad 0 < r < 1$$\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u(1, \\theta)&=1 + \\sin\\theta +\\frac{1}{2}\\sin3\\theta +\\cos 4\\theta \\\\ \n",
        "\\end{aligned}$$\n",
        "\n",
        "would be\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u(r, \\theta)&=1 + r\\sin\\theta +\\frac{r^3}{2}\\sin3\\theta +r^4\\cos 4\\theta \\\\ \n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Poisson Integral Formula**\n",
        "\n",
        "  We start with the separation of varaiables solution\n",
        "\n",
        "  $$ u(r,\\theta)\n",
        "   =\\frac{a_0}{2} +\\sum_{n=1}^\\infty \n",
        "    \\left(\\frac{r}{R}\\right)^n \\left(a_n \\cos n\\theta \n",
        "     +b_n \\sin n\\theta \\right)$$\n",
        "\n",
        "  and substitute the coefficients $\\,a_n\\,$ and $\\,b_n$. $\\,$After a few manipulations, $\\,$we have\n",
        "\n",
        "  $$\\scriptsize\\begin{aligned}\n",
        "  u(r,\\theta) \n",
        "    &= \\frac{1}{2\\pi} \\int_0^{2\\pi} \n",
        "     g(\\alpha)\\,d\\alpha +\\frac{1}{\\pi} \n",
        "    \\sum_{n=1}^\\infty \\left(\\frac{r}{R} \\right)^n \n",
        "     \\int_0^{2\\pi} g(\\alpha) \n",
        "      \\left( \\cos n\\alpha\\cos n\\theta\n",
        "      +\\sin n\\alpha \\sin n\\theta \\right)\\,d\\alpha \\\\ \n",
        "    &= \\frac{1}{2\\pi} \\int_0^{2\\pi}  \n",
        "     \\left\\{ 1 +2\\sum_{n=1}^\\infty \n",
        "     \\left(\\frac{r}{R} \\right)^n \n",
        "      \\cos n(\\theta -\\alpha) \\right\\} \n",
        "       \\,g(\\alpha)\\,d\\alpha \\\\ \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  $$\\scriptsize\\begin{aligned}\n",
        " &= \\frac{1}{2\\pi} \\int_0^{2\\pi}  \\left\\{  1 +\\sum_{n=1}^\\infty \\left(\\frac{r}{R} \\right)^n \\left[e^{in(\\theta -\\alpha)} +e^{-in(\\theta -\\alpha)}  \\right] \\right\\}\\,g(\\alpha)\\,d\\alpha \\\\ \n",
        " &= \\frac{1}{2\\pi} \\int_0^{2\\pi}  \\left\\{  1 +\\frac{re^{i(\\theta -\\alpha)}}{R -re^{i(\\theta -\\alpha)}} \n",
        " +\\frac{re^{-i(\\theta -\\alpha)}}{R -re^{-i(\\theta -\\alpha)}} \\right\\}\\,g(\\alpha)\\,d\\alpha \\\\ \n",
        " &= \\color{red}{\\frac{1}{2\\pi} \\int_0^{2\\pi}  \\left\\{ \\frac{R^2 -r^2}{R^2 +r^2 -2rR\\cos(\\theta -\\alpha)} \\right\\}\\,g(\\alpha)\\,d\\alpha} \n",
        "\\end{aligned}$$\n",
        "\n",
        "  This last equation is what we were looking for; $\\,$it's <font color=blue>the Poisson Integral Formula</font>\n",
        "\n",
        "  * We can interpret the Poisson integral solution as finding the potential $\\,u\\,$ at $\\,(r,\\theta)\\,$ as a weighted average of the boundary potentials $\\,g(\\theta)\\,$ weighted by the Poisson kernel\n",
        "\n",
        "    $$\\text{Poisson kernel}=\\frac{R^2 -r^2}{R^2 +r^2 -2rR\\cos(\\theta -\\alpha)}$$\n",
        "\n",
        "    ![](figures/pde03_figure08.jpg \"Poisson Kernel\"){width=\"45%\" fig-align=\"center\"}\n",
        "\n",
        "    For boundary values $\\,g(\\alpha)\\,$ close to $\\,(r,\\theta)\\,$, $\\,$the Poisson kernel gets larger, $\\,$since the denominator of the Poisson kernel is the square of the distance from $\\,(r,\\theta)\\,$ to $\\,(R,\\alpha)$\n",
        "\n",
        "  * If we evaluate the potential at the center of the circle by the Poisson integral, $\\,$we find\n",
        "\n",
        "    $$ u(0,0) = \\frac{1}{2\\pi} \\int_0^{2\\pi} g(\\theta) \\,d\\theta$$\n",
        "\n",
        "    In other words, $\\,$the potential at the center of the circle is the average of the boundary potential\n",
        "\n",
        "$~$\n",
        "\n",
        "## The Dirichlet Problem in an Annulus and in an Exterior {#sec-x3-34}\n",
        "\n",
        "* The Dirichlet problem between two circles (annulus) is\n",
        "\n",
        "  $$ \\color{red}{u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=0, \\;\\;R_1 < r < R_2}$$\n",
        "  $$\\;\\; \\color{red}{\\begin{aligned} u(R_1,\\theta) &= g_1(\\theta) \\\\ u(R_2,\\theta) &= g_2(\\theta) \\end{aligned}, \\;\\;\\; 0 \\leq \\theta < 2\\pi}$$\n",
        "\n",
        "  ![](figures/pde03_figure09.jpg \"An annulus\"){width=\"45%\" fig-align=\"center\"}\n",
        "\n",
        "* We begin by looking for solutions of the form\n",
        "\n",
        "  $$ u(r,\\theta)=R(r)\\Theta(\\theta)$$\n",
        "\n",
        "  Substituting this into Laplace's equation, $\\,$we get the two following ODEs in $\\,R(r)\\,$ and $\\,\\Theta(\\theta)$:\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  &r^2 R'' +rR' -\\lambda R = 0 \\quad (\\text{Euler's equation}) \\\\ \n",
        "  &\\Theta'' +\\lambda \\Theta = 0 \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  Note that in the two equations, $\\,$we required the separation constant $\\,\\lambda\\,$ to be greater than, $\\,$or equal to zero, $\\,$or else the solution for $\\,\\Theta(\\theta)\\,$ would not be periodic\n",
        "\n",
        "* Solving these two ODEs, $\\,$we now have\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  \\lambda = 0 \\;\\; \n",
        "  &\\begin{cases}\n",
        "  \\Theta(\\theta)= \\alpha + \\beta\\theta \\\\\n",
        "  R(r) = \\gamma + \\delta\\ln r \n",
        "  \\end{cases} \\\\ \n",
        "  \\lambda > 0 \\;\\;\n",
        "  &\\begin{cases}\n",
        "  \\Theta(\\theta)=  a\\cos\\sqrt{\\lambda}\\theta +b\\sin \\sqrt{\\lambda}\\theta\\\\ \n",
        "  R(r) = cr^{\\sqrt{\\lambda}} +dr^{-\\sqrt{\\lambda}}   \n",
        "  \\end{cases} \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  and using the requirement that $\\,\\Theta(\\theta)\\,$ must be periodic with period $\\,2\\pi$, $\\,$we have that $\\,\\beta=0 \\,\\text{ at }\\, \\lambda=0\\,$ and $\\,\\lambda (>0)\\,$ must be $\\,n^2$, $\\,n= 0,1,2,\\cdots$\n",
        "\n",
        "* Hence, $\\,$we arrive at the following solutions to Laplace's equation\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    &1 \\;\\;\\;(\\text{constants}) \\\\ \n",
        "    &\\ln r \\\\ \n",
        "    &r^n \\cos n\\theta \\\\ \n",
        "    &r^n \\sin n\\theta \\\\ \n",
        "    &r^{-n} \\cos n\\theta \\\\\n",
        "    &r^{-n} \\sin n\\theta \n",
        "  \\end{aligned}$$\n",
        "\n",
        "* Since any sum of these solutions is also a solution, $\\,$we arrive at our general solution\n",
        "\n",
        "  $$ \\color{red}{u(r,\\theta) = \n",
        "   \\frac{a_0}{2} +\\frac{\\tilde{a_0}}{2} \\ln r \n",
        "    +\\sum_{n=1}^\\infty \\left[ \\left(a_n r^n \n",
        "     +\\tilde{a_n} r^{-n}\\right) \\cos n\\theta +\n",
        "  \\left(b_n r^n +\\tilde{b_n} r^{-n}\\right) \n",
        "  \\sin n\\theta \\right]}$$\n",
        "\n",
        "  The only task left is to determine the constants in the sum so that $\\,u(r,\\theta)\\,$ satisfies the BCs\n",
        "\n",
        "  $$ \\begin{aligned} u(R_1,\\theta) &= g_1(\\theta) \\\\ u(R_2,\\theta) &= g_2(\\theta) \\end{aligned}, \\;\\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "* Substituting the general solution into these BCs and integrating gives the following equations\n",
        "\n",
        "  $$\\scriptsize\\begin{aligned}\n",
        "  &\\begin{cases}\n",
        "    a_0 +\\tilde{a_0} \\ln R_1 \n",
        "     =\\displaystyle \\frac{1}{\\pi} \\int_0^{2\\pi} \n",
        "      g_1(\\alpha)\\,d\\alpha \\\\ \n",
        "    a_0 +\\tilde{a_0} \\ln R_2 \n",
        "     =\\displaystyle \\frac{1}{\\pi} \\int_0^{2\\pi} \n",
        "      g_2(\\alpha)\\,d\\alpha\n",
        "   \\end{cases} &&\\text{Solve for } a_0, \\tilde{a_0} \\\\ \n",
        "  &\\begin{cases}\n",
        "    a_n R_1^n +\\tilde{a_n} R_1^{-n} \n",
        "     =\\displaystyle \\frac{1}{\\pi} \\int_0^{2\\pi} \n",
        "      g_1(\\alpha) \\cos n\\alpha \\,d\\alpha \\\\ \n",
        "    a_n R_2^n +\\tilde{a_n} R_2^{-n} \n",
        "     =\\displaystyle \\frac{1}{\\pi} \\int_0^{2\\pi} \n",
        "      g_2(\\alpha) \\cos n\\alpha \\,d\\alpha\n",
        "  \\end{cases} &&\\text{Solve for } a_n, \\tilde{a_n} \\\\ \n",
        "  &\\begin{cases}\n",
        "    b_n R_1^n +\\tilde{b_n} R_1^{-n} \n",
        "     =\\displaystyle \\frac{1}{\\pi} \\int_0^{2\\pi} \n",
        "      g_1(\\alpha) \\sin n\\alpha \\,d\\alpha \\\\ \n",
        "    b_n R_2^n +\\tilde{b_n} R_2^{-n} \n",
        "     =\\displaystyle \\frac{1}{\\pi} \\int_0^{2\\pi} \n",
        "      g_2(\\alpha) \\sin n\\alpha \\,d\\alpha\n",
        "   \\end{cases} &&\\text{Solve for } b_n, \\tilde{b_n}\n",
        "  \\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Suppose the potential on the inside circle is zero, $\\,$while the outside potential is $\\,\\sin \\theta$\n",
        "\n",
        "$$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=0, \\;\\;\\;1 < r < 2$$\n",
        "\n",
        "$$ \\begin{aligned} u(1,\\theta) &= 0 \\\\ u(2,\\theta) &= \\sin\\theta \\end{aligned}, \\;\\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "Solving the necessary equations for $\\,a_0, \\tilde{a_0}$, $a_n, \\tilde{a_n}$, $b_n$, and $\\tilde{b_n}\\,$ yields\n",
        "\n",
        "$$ u(r,\\theta)=\\frac{2}{3} \\left(r -\\frac{1}{r} \\right) \\sin \\theta$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Consider the problem with constant potentials on the boundaries\n",
        "\n",
        "$$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=0, \\;\\;\\;1 < r < 2 $$\n",
        "\n",
        "$$ \\begin{aligned} u(1,\\theta) &= 3 \\\\ u(2,\\theta) &= 5 \\end{aligned}, \\;\\;\\; 0 \\leq \\theta < 2\\pi $$\n",
        "\n",
        "In this case, $\\,$since it's obvious that the solution is independent of $\\,\\theta$, $\\,$we know our solution must be of the form $\\,a_0 +\\tilde{a_0} \\ln r$. $\\,$Using our two equations for $\\,a_0\\,$ and $\\,\\tilde{a_0}$, $\\,$we obtain\n",
        "\n",
        "$$ u(r,\\theta)=3 +\\frac{2}{\\ln 2} \\ln r$$\n",
        "\n",
        "The only solutions of the two dimensional Laplace equation that depend only on $\\,r\\,$ are constant and $\\,\\ln r$. $\\,$The potential $\\,\\ln r\\,$ is very important and is called the logarithmic potential\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Another interesting problem is\n",
        "\n",
        "$$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=0, \\;\\;\\;1 < r < 2$$\n",
        "\n",
        "$$ \\begin{aligned} u(1,\\theta) &= \\sin\\theta \\\\ u(2,\\theta) &= \\sin\\theta \\end{aligned}, \\;\\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "A quick check of the coefficients reveals that they are all zero except for $\\,b_1\\,$ and $\\,\\tilde{b}_1$. $\\,$Solving for $\\,b_1\\,$ and $\\,\\tilde{b_1}\\,$ gives the solution\n",
        "\n",
        "$$ u(r,\\theta)=\\left(\\frac{r}{3} +\\frac{2}{3r}\\right) \\sin\\theta$$\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Exterior Dirichlet Problem**\n",
        "\n",
        "  The exterior Dirichlet problem\n",
        "\n",
        "  $$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=0, \\;\\;\\;\\color{red}{R_1 < r < \\infty}$$\n",
        "\n",
        "  $$ u(R_1,\\theta)=g(\\theta), \\;\\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "  is solved exactly like the interior Dirichlet problem except that now we throw out the solutions that are unbounded as $\\,r\\,$ goes to infinity\n",
        "\n",
        "  Hence, $\\,$we left with the solution\n",
        "\n",
        "  $$ \\color{red}{u(r,\\theta)= \\frac{a_0}{2} +\\sum_{n=1}^{\\infty} \\left(\\frac{r}{R_1}\\right)^{-n}\\left( \\tilde{a_n} \\cos n\\theta +\\tilde{b_n} \\sin n \\theta \\right)}$$\n",
        "\n",
        "  where $\\,a_0$, $\\,\\tilde{a_n}\\,$ and $\\,\\tilde{b_n}\\,$ are exactly as Fourier series. $\\,$In other words, $\\,$we merely expand $\\,u(R_1,\\theta)=g(\\theta)\\,$ as a Fourier series\n",
        "\n",
        "  $$ g(\\theta)=\\frac{a_0}{2} +\\sum_{n=1}^\\infty \\left( \\tilde{a_n} \\cos n\\theta +\\tilde{b_n} \\sin n\\theta \\right)$$\n",
        "\n",
        "  and then insert the factor $\\,\\displaystyle\\left(\\frac{r}{R_1}\\right)^{-n}\\,$ in each term to get the solution\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ The exterior problem \n",
        "\n",
        "$$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=0, \\;\\;\\;1 < r < \\infty$$\n",
        "\n",
        "$$ u(1,\\theta)=1 +\\sin\\theta +\\cos 3\\theta, \\;\\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "has the solution\n",
        "\n",
        "$$ u(r,\\theta)=1 +\\frac{1}{r}\\sin\\theta +\\frac{1}{r^3}\\cos 3\\theta, \\;\\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ The exterior Neumann problem\n",
        "\n",
        "$$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=0, \\;\\;\\;1 < r < \\infty$$\n",
        "\n",
        "$$ \\frac{\\partial u}{\\partial r}(1,\\theta)=g(\\theta), \\;\\;\\; 0 \\leq \\theta < 2\\pi$$\n",
        "\n",
        "has a solution that is the same form as the Dirichlet problem\n",
        "\n",
        "$$ u(r,\\theta)= \\frac{a_0}{2} +\\sum_{n=1}^{\\infty} r^{-n}\\left( \\tilde{a_n} \\cos n\\theta +\\tilde{b_n} \\sin n \\theta \\right)$$\n",
        "\n",
        "but now the coefficients $\\,a_0$, $\\,\\tilde{a_n}$ and $\\,\\tilde{b_n}\\,$ must satisfy the new BC.\n",
        "Of course, once you have this solution, $\\,$any constant plus this solution is also a solution\n",
        "\n",
        "$~$\n",
        "\n",
        "## Laplace's Equation in Spherical Coordinates (Spherical Harmonics) {#sec-x3-35}\n",
        "\n",
        "* An important problem in physics is to find the potential inside or outside a sphere when the potential is given on the boundary \n",
        "\n",
        "* For the interior problem, $\\,$we must find the solution $\\,u(r,\\phi,\\theta)\\,$ that satisfies\n",
        "\n",
        "  $$ \\left( r^2 u_r \\right)_r +\\frac{1}{\\sin\\phi} \\left( \\sin\\phi\\, u_\\phi \\right)_\\phi +\\frac{1}{\\sin^2\\phi} u_{\\theta\\theta} = 0 $$\n",
        "\n",
        "  <font color=blue> $$ u(1,\\phi,\\theta)=g(\\phi,\\theta), \\;0\\leq \\theta <2\\pi,\\;0 \\leq \\phi < \\pi $$ </font>\n",
        "\n",
        "  Note that this spherical Laplacian is written in a different form than those we've seen before. $\\,$This form is slightly more compact and easier to use\n",
        "\n",
        "* Quite often $\\,g(\\phi,\\theta)\\,$ has a specific form, $\\,$so that it isn't necessary to solve the problem in its most general form. $\\,$Two important special cases are considered in this section. $\\,$<font color=blue>One is the case when $\\,g(\\phi,\\theta)\\,$ is constant, $\\,$and the other is when it depends only on the angle $\\,\\phi\\,$ (the angle from the north pole)</font>\n",
        "\n",
        "  ![](figures/pde03_figure10.jpg \"spherical coordinate\"){width=\"45%\" fig-align=\"center\"}\n",
        "\n",
        "* **Special Case 1** $\\,$ $-\\;\\;\\color{red}{g(\\phi,\\theta) = \\text{constant}}$\n",
        "\n",
        "  In this case, $\\,$it is clear that the solution is independent of $\\,\\phi\\,$ and $\\,\\theta$, $\\,$and so Laplace's equation reduces to the ODE\n",
        "\n",
        "  $$ \\left( r^2 u_r \\right)_r = 0 $$\n",
        "\n",
        "  This is a simple ODE that the student can easily solve; $\\,$the general solution is \n",
        "\n",
        "  $$ u(r)=\\frac{a}{r} +b $$\n",
        "\n",
        "  In other words, $\\,$constant and $\\,\\displaystyle\\frac{a}{r}\\,$ are the only potential that depend only on the radial distance from the origin. $\\,$The potential $\\,\\displaystyle\\frac{1}{r}\\,$ is very important in physics and is called the Newtonian potential\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ (Potential interior to a sphere)\n",
        "\n",
        "$$ \\nabla^2 u = 0, \\;\\;\\; 0 < r < 1 $$\n",
        "\n",
        "$$ u(1,\\phi,\\theta) = 3 $$\n",
        "\n",
        "Here solution must be $\\,u(r,\\phi,\\theta) = 3\\,$ in order to be bounded\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ (Potential between two spheres each at constant potential)\n",
        "\n",
        "Suppose we want to find the steady-state temperature between two spheres held at different temperatures\n",
        "\n",
        "$$ \\nabla^2 u = 0, \\;\\;\\; R_1 < r < R_2 $$\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u(R_1,\\phi,\\theta) &= A \\\\ \n",
        " u(R_2,\\phi,\\theta) &= B \n",
        "\\end{aligned}$$\n",
        "\n",
        "Since we know the potential has the general solution\n",
        "\n",
        "$$ u(r)=\\frac{a}{r} +b $$\n",
        "\n",
        "we substitute it in the BCs and solve for $\\,a\\,$ and $\\,b\\,$; $\\,$doing this gives\n",
        "\n",
        "$$ u(r)= (A -B) \\frac{R_1 R_2}{R_2 -R_1} \\frac{1}{r} + \\frac{R_2 B -R_1 A}{R_2 -R_1} $$\n",
        "\n",
        "![](figures/pde03_figure11.jpg \"potential between two concentric spheres\"){width=\"75%\" fig-align=\"center\"}\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Special Case 2** $\\,$ $-\\;\\;\\color{red}{g(\\phi,\\theta) \\text{ depends only on } \\phi}$\n",
        "\n",
        "  Here, the Dirichlet problem takes the form\n",
        "\n",
        "  $$ \\left( r^2 u_r \\right)_r +\\frac{1}{\\sin\\phi} \n",
        "   \\left( \\sin\\phi\\, u_\\phi \\right)_\\phi = 0, \n",
        "   \\;\\;\\; 0 < r < 1 $$\n",
        "\n",
        "  $$ u(1,\\phi)=g(\\phi),\\;\\;\\; 0 \\leq \\phi \\leq \\pi $$\n",
        "\n",
        "  Using separation of variables, $\\,$we look for solutions of the form\n",
        "\n",
        "  $$ u(r,\\phi)=R(r)\\Phi(\\phi) $$\n",
        "\n",
        "  and arrive at the two ODEs\n",
        "\n",
        "  $$ \\begin{aligned}\n",
        "    &\\left(\\sin\\phi\\, \\Phi' \\right)' +\\lambda \\sin\\phi \\Phi= 0 &&\\text{Legendre's equation}\\\\ \n",
        "    &r^2R'' +2rR' -\\lambda R = 0 && \\text{Euler's equation}\n",
        "    \\end{aligned} $$\n",
        "\n",
        "  Legendre's equation isn't easy; $\\,$the general strategy in solving this equation is to make the substitution\n",
        "\n",
        "  <font color=blue>$$x=\\cos\\phi$$</font>\n",
        "\n",
        "  Making this change of variable gives rise to the new Legendre's equation\n",
        "\n",
        "  $$\\scriptsize \n",
        "  \\begin{aligned}\n",
        "    \\left(\\sin\\phi\\, \\Phi' \\right)' \n",
        "    &+\\lambda \\sin\\phi \\Phi= 0\\\\ \n",
        "    &\\Downarrow \n",
        "    \\;\\; x=\\cos\\phi, \n",
        "      \\;\\; \\Phi'=\\frac{d\\Phi}{dx} \\frac{dx}{d\\phi}\n",
        "      =-\\sin\\phi\\frac{d\\Phi}{dx} \\\\\n",
        "    \\left(\\sin\\phi\\, \\Phi' \\right)'\n",
        "    &=-\\frac{d}{dx}\n",
        "      \\left(\\sin^2\\phi \\frac{d\\Phi}{dx} \\right) \n",
        "      \\frac{dx}{d\\phi}\n",
        "    =\\left(\\sin^2\\phi \\frac{d^2\\Phi}{dx^2} \n",
        "    +2\\sin\\phi\\cos\\phi \n",
        "    \\frac{d\\phi}{dx}\\frac{d\\Phi}{dx} \\right)\\sin\\phi \\\\\n",
        "    &=\\left[ (1 -x^2) \\frac{d^2\\Phi}{dx^2} \n",
        "    -2x\\frac{d\\Phi}{dx} \\right] \\sin\\phi \\\\\n",
        "    &\\Downarrow \\\\\n",
        "      \\color{red}{(1 -x^2) \\frac{d^2\\Phi}{dx^2}} \n",
        "    &\\color{red}{-2x\\frac{d\\Phi}{dx} +\\lambda \\Phi = 0, \n",
        "    \\;\\;\\; -1 \\leq x \\leq 1} \\\\\n",
        "    &\\Downarrow \\\\\n",
        "    \\frac{d}{dx} \\left[ (1 -x^2) \n",
        "    \\frac{d\\Phi}{dx} \\right] \n",
        "    &+\\lambda \\Phi = 0\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  * One of the difficulties in this equation is that \n",
        "\n",
        "    <font color=\"blue\">the coefficient $\\,(1-x^2)$ of $\\displaystyle \\,\\frac{d^2\\Phi}{dx^2}$ is zero at the ends of the domain $-1 \\leq x \\leq 1$ </font>\n",
        "  \n",
        "    Equations like this are called singular differential equations. $\\,$We arrive at a very interesting conclusion\n",
        "\n",
        "  * <font color=red>The only bounded solutions of Legendre's equation occur when $\\,\\lambda=n(n +1)$, $\\,n=0,1,2,\\cdots\\,$ and these solutions are Legendre polynomials $\\,P_n(x)$</font>\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "      &P_0(x) = 1 \\\\ \n",
        "      &P_1(x) = x \\\\ \n",
        "      &P_2(x) = \\frac{1}{2}(3x^2 -1) \\\\ \n",
        "      &P_3(x) = \\frac{1}{2}(5x^3 -3x) \\\\\n",
        "      &\\qquad \\vdots \\\\\n",
        "      &P_n(x) = \\frac{1}{2^n n!} \\frac{d^n}{dx^n} \n",
        "       \\left[ (x^2 -1)^n \\right]\n",
        "    \\end{aligned}$$\n",
        "\n",
        "    The graphs of a few Legendre polynomials are shown in\n",
        "\n",
        "    ![](figures/pde03_figure12.jpg \"Legendre polynomials\"){width=\"65%\" fig-align=\"center\"}\n",
        "\n",
        "  * We now solve Euler's equation by substituting $\\,\\lambda = n(n+1)\\,$ and $\\,R(r)=r^\\alpha\\,$ in the equation and solving for $\\,\\alpha$. $\\,$Doing this, $\\,$we get two values\n",
        "\n",
        "    $$\\alpha = \\begin{cases}\n",
        "      \\phantom{-(n \\,} n \\\\ \n",
        "    -(n +1) \n",
        "    \\end{cases}$$\n",
        "\n",
        "    and, $\\,$hence, $\\,$Euler's equation has the general solution\n",
        "\n",
        "    $$R_n(r)= a_n r^n + b_n r^{-(n +1)} \\;\\;\\xrightarrow[]{\\text{ bounded solution }}\\;\\;a_n r^n$$\n",
        "\n",
        "  * The final step is to form the sum\n",
        "\n",
        "    $$ \\color{red}{u(r,\\phi) = \\sum_{n=0}^\\infty a_n r^n P_n(\\cos\\phi)}\\;\\;\\;$$\n",
        "\n",
        "    in such a way that it agrees with the BC $\\,u(1,\\phi)=g(\\phi)$. $\\,$Substituting the above solution into the BC gives\n",
        "\n",
        "    $$ g(\\phi) = \\sum_{n=0}^\\infty a_n P_n(\\cos\\phi)$$\n",
        "\n",
        "    If we multiply each side of this equation by $\\,P_m(\\cos\\phi)\\sin\\phi\\,$ and integrate $\\,\\phi\\,$ from $\\,0\\,$ to $\\,\\pi$, $\\,$we get\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    \\int_0^\\pi g(\\phi) P_m(\\cos\\phi)\\,\\sin\\phi \\,d\\phi \n",
        "    &= \\sum_{n=0}^\\infty \n",
        "        a_n \\int_0^{\\pi} P_n(\\cos\\phi) \n",
        "        P_m(\\cos\\phi)\\,\\sin\\phi \\, d\\phi \\\\\n",
        "        &= \\sum_{n=0}^\\infty a_n \n",
        "        \\int_{-1}^1 P_n(x) P_m(x) \\,dx \\\\ \n",
        "        &=\n",
        "    \\begin{cases}\n",
        "        \\quad\\: 0  & n \\neq m \\\\ \n",
        "        \\displaystyle \\frac{2}{2m +1}\\, a_m & n = m \n",
        "    \\end{cases} \\\\ \n",
        "    &\\Downarrow \\\\ \n",
        "    a_n &=\\frac{2n +1}{2} \\int_0^{\\pi} g(\\phi) \n",
        "        P_n(\\cos\\phi)\\, \\sin \\phi \\,d\\phi\n",
        "    \\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Suppose the temperature on the surface of the sphere is given by\n",
        "\n",
        "$$ g(\\phi) = 1 -\\cos 2\\phi, \\quad 0 \\leq \\phi \\leq \\pi $$\n",
        "\n",
        "and suppose we would like to find the temperature inside the sphere. $\\,$In this problem, $\\,$the temperature is constant on circles of constant latitude. $\\,$To find $\\,u$, $\\,$we must solve\n",
        "\n",
        "$$ \\left( r^2 u_r \\right)_r +\\frac{1}{\\sin\\phi} \\left( \\sin\\phi\\, u_\\phi \\right)_\\phi = 0, \\;\\;\\; 0 < r < 1 $$\n",
        "\n",
        "$$u(1,\\phi)=1 -\\cos 2\\phi,\\;\\;\\; 0 \\leq \\phi \\leq \\pi $$\n",
        "\n",
        "Our goal now is to expand $\\,g(\\phi)\\,$ as a series of Legendre polynomials;\n",
        "\n",
        "$$\\begin{aligned}\n",
        " 1 -\\cos 2\\phi &= 1 - \\left( 2\\cos^2\\phi -1 \\right) \\\\ \n",
        " &= \\frac{4}{3} - \\frac{4}{3}\\left[ \\frac{1}{2} (3\\cos^2\\phi -1) \\right] \\\\ \n",
        " &= \\frac{4}{3} P_0(\\cos\\phi) -\\frac{4}{3}P_2(\\cos\\phi)\\\\\n",
        " &\\Downarrow \\\\\n",
        " a_0 = \\frac{4}{3},\\;\\; a_2&=-\\frac{4}{3},\\;\\;a_1=a_3=a_4=a_5=\\cdots =0\n",
        "\\end{aligned}$$\n",
        "\n",
        "Hence, $\\,$the solution to the problem is\n",
        "\n",
        "$$\\begin{aligned}\n",
        " u(r,\\phi) &= \\frac{4}{3} P_0(\\cos\\phi) -\\frac{4}{3} r^2 P_2(\\cos\\phi)\n",
        " = \\frac{4}{3} - \\frac{2}{3} r^2 (3\\cos^2\\phi -1) \n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**NOTE** $\\,$ The solution of the exterior Dirichlet problem\n",
        "\n",
        "  $$\\;\\;\\displaystyle \\left( r^2 u_r \\right)_r +\\frac{1}{\\sin\\phi} \\left( \\sin\\phi\\, u_\\phi \\right)_\\phi = 0, \\;\\; 1 < r < \\infty, \\;\\;u(1,\\phi)=g(\\phi),\\;\\;\\; 0 \\leq \\phi \\leq \\pi $$\n",
        "\n",
        "is \n",
        "  \n",
        "$$ u(r,\\phi)=\\sum_{n=0}^\\infty \\frac{b_n}{r^{n+1}} P_n(\\cos\\phi)$$\n",
        "\n",
        "where $\\;\\displaystyle b_n = \\frac{2n +1}{2} \\int_0^\\pi g(\\phi) P_n(\\cos\\phi)\\, \\sin\\phi \\, d\\phi$\n",
        "\n",
        "For example, $\\,$the BC $\\,g(\\phi)=3\\,$ would yield the solution $\\,u(r,\\theta)=3/r$. $\\,$Note that in this problem, $\\,$the solution goes to zero, $\\,$while in two dimensions, $\\,$the exterior solution with constant BC was itself a constant\n",
        "\n",
        "$~$\n",
        "\n",
        "* **General Case**  $\\,$ $-\\;\\;\\color{red}{g(\\phi,\\theta)}$\n",
        "\n",
        "  We consider the boundary value problem\n",
        "\n",
        "  $$\\color{red}{\\begin{aligned}\n",
        "  u_{rr} +\\frac{2}{r} u_r &+\\frac{1}{r^2}u_{\\phi\\phi} +\\frac{\\cot\\phi}{r^2} u_{\\phi} +\\frac{1}{r^2\\sin^2\\phi}u_{\\theta\\theta} = 0, \\;\\; r < R \\\\ \n",
        "  u(R,\\phi,\\theta) &= g(\\phi,\\theta)\\\\ \n",
        "  \\end{aligned}}$$\n",
        "\n",
        "  in a sphere of radius $\\,R$\n",
        "\n",
        "  | 1. $~$ Solve this problem by separation of variables, \n",
        "  | 2. $~$ Derive $\\,K(r,\\phi,\\theta; R,\\varphi,\\vartheta)\\,$ in the equivalent integral formula:\n",
        "\n",
        "  $$ u(r,\\phi,\\theta) = \\int_0^{2\\pi} \\int_0^\\pi K(r,\\phi,\\theta; R,\\varphi,\\vartheta)\\, g(\\varphi,\\vartheta) \\sin\\varphi \\,d\\varphi \\, d\\vartheta$$\n",
        "\n",
        "  **1.** $\\,$Applying separation of variables, $\\,$we find that the equation has the solution of the form $\\,R(r) \\,\\Phi(\\phi) \\,\\Theta(\\theta)$, $\\,$provided\n",
        "\n",
        "  $$ -r^2 \\sin^2\\phi \\, \\frac{R'' +\\frac{2}{r}R'}{R} -\\sin\\phi\\frac{(\\sin\\phi\\, \\Phi')'}{\\Phi} = \\frac{\\;\\Theta''}{\\Theta}= -\\mu < 0$$\n",
        "\n",
        "  Since $\\Theta$ must be periodic of period $\\,2\\pi$, $\\,$we have $\\,\\color{blue}{\\Theta=\\cos m\\theta}\\,$ or $\\,\\color{blue}{\\sin m\\theta}$, $\\,$where $\\,\\color{blue}{\\mu = m^2, \\; m = 0, 1, 2,\\cdots}$. $\\,$Then\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    -\\frac{r^2 R'' +2rR'}{R} \n",
        "    = \\frac{(\\sin\\phi\\, \\Phi')'}{\\sin\\phi\\,\\Phi} \n",
        "    &-\\frac{m^2}{\\sin^2\\phi} = -\\lambda < 0 \\\\ \n",
        "    &\\Downarrow \\\\ \n",
        "    \\color{blue}{(\\sin\\phi\\, \\Phi')' \n",
        "    +\\left(\\lambda \\sin\\phi \\, \n",
        "    {\\color{red}{-\\frac{m^2}{\\sin\\phi}}} \\right) \n",
        "    \\Phi } \\;& {\\color{blue}{= 0}}\\\\ \n",
        "    \\color{blue}{r^2 R'' +2r R' -\\lambda R} \n",
        "     \\;&\\color{blue}{= 0} \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  * The equation for $\\,\\Phi(\\phi)\\,$ is singular at its two endpoints $\\,\\phi=0\\,$ and $\\,\\phi=\\pi$. $\\,$In lieu of boundary conditions, $\\,$we impose the condition that $\\,\\Phi\\,$ and $\\,\\Phi'\\,$ remain bounded at both ends. $\\,$This gives an eigenvalue problem with two singular endpoints. $\\,$We introduce the new variable $\\,x=\\cos\\phi\\,$ and let $\\,\\Phi(\\phi)=P(\\cos\\phi)$. $\\,$Then the equation for $\\,\\Phi(\\phi)\\,$ becomes\n",
        "\n",
        "    $$\\color{red}{\\frac{d}{dx} \n",
        "    \\left[\\left(1 -x^2\\right) \\frac{dP}{dx} \\right] \n",
        "     +\\left[\\lambda -\\frac{m^2}{1 -x^2 } \\right] P = 0} \n",
        "    \\tag{AL}\\label{eq:AL}$$ \n",
        "\n",
        "  * In the case of $\\,m=0$: \n",
        "\n",
        "    $$\\frac{d}{dx} \\left[\\left(1 -x^2\\right) \n",
        "    \\frac{dP}{dx} \\right] +\\lambda P = 0\n",
        "    \\tag{LG}\\label{eq:LG}$$ \n",
        "\n",
        "\n",
        "    we obtain a function which is bounded for $\\,-1 \\leq x \\leq 1\\,$ if and only if\n",
        "\n",
        "    $$\\lambda=n(n+1), \\;\\; n=0,1,2,\\cdots$$\n",
        "\n",
        "    These, $\\,$then, $\\,$are the eigenvalues. $\\,$Setting $P_n(1)=1$, $\\,$we obtain the eigenfunction $\\,P_n(x)\\,$ corresponding to the eigenvalue $\\,\\lambda_n=n(n+1):$\n",
        "\n",
        "    $$ P_n(x)= \\sum_{k=0}^n \\frac{(n +k)!}{2^k (k!)^2 (n -k)!}(x - 1)^k\\;\\;$$\n",
        "\n",
        "    It is called a **Legendre polynomial**\n",
        "\n",
        "  * Since $\\,P_n(x)\\,$ is of exactly degree $\\,n\\,$ in $\\,x$, $\\,$any polynomial of degree $\\,k\\,$ can be expressed as a linear combination of $\\,P_n(x)\\,$ with $\\,n=0,1,\\cdots,k$. $\\,$Since $\\,P_n(x)\\,$ are orthogonal, $\\,$each $\\,P_n(x)\\,$ must therefore be orthogonal to all powers of $\\,x\\,$ less than $\\,n:$\n",
        "\n",
        "    $$ \\int_{-1}^1 x^k P_n(x)\\, dx=0, \\;\\;k=0,1,\\cdots, n-1$$\n",
        "\n",
        "    These $\\,n\\,$ linear conditions, $\\,$together with the fact that $\\,P_n(x)\\,$ is of degree $\\,n$, $\\,$determine $\\,P_n(x)\\,$ uniquely\n",
        "\n",
        "  * We can verify the identity\n",
        "\n",
        "    $$ P_n(x)=\\frac{1}{2^n n!}\\frac{d^n}{dx^n} \\left(x^2 -1\\right)^n$$\n",
        "\n",
        "    which is called the **Rodrigues formula**. $\\,$It is clear from this formula that $\\,P_n(x)\\,$ is even in $\\,x\\,$ if $\\,n\\,$ is even, $\\,$and odd if $\\,n\\,$ is odd\n",
        "\n",
        "  * The Legendre polynomials can also be defined as the coefficients in a formal expansion in powers of $\\,t\\,$ of the **generating function**\n",
        "\n",
        "    $$ \\frac{1}{\\sqrt{1 -2xt +t^2}} = \\sum_{n=0}^\\infty P_n(x) t^n $$\n",
        "\n",
        "  * We now wish to consider the equation \\eqref{eq:AL} with a positive $m$. $\\,$For this purpose, $\\,$we first differentiate the equation \\eqref{eq:LG} $\\,m\\,$ times with respect to $\\,x$. $\\,$This gives\n",
        "\n",
        "    $$ \\left(1 -x^2\\right) \\frac{d^{m+2}}{dx^{m+2}}P -2(m +1)x \\frac{d^{m+1}}{dx^{m+1}}P +\\left[ \\lambda -m(m +1)\\right] \\frac{d^{m}}{dx^{m}}P=0$$\n",
        "\n",
        "    We now introduce the new dependent variable\n",
        "\n",
        "    $$ \\color{red}{Q(x)=\\left(1 -x^2\\right)^{m/2} \\frac{d^{m}}{dx^{m}}P(x)}$$\n",
        "\n",
        "  * The above equation becomes\n",
        "\n",
        "    $$\\frac{d}{dx} \\left[\\left(1 -x^2\\right) \\frac{dQ}{dx} \\right] +\\left[\\lambda -\\frac{m^2}{1 -x^2 } \\right] Q = 0\\;\\;$$\n",
        "\n",
        "    Thus any solution $\\,P(x)\\,$ of \\eqref{eq:LG} leads to a solution $\\,Q(x)\\,$ of \\eqref{eq:AL}, $\\,$unless $\\,P(x)\\,$ is a polynomial of degree less than $\\,m$\n",
        " \n",
        "  * Since $\\,P_n(x)\\,$ is a polynomial of degree $\\,n$, \n",
        "  \n",
        "    $$\\frac{d^m}{dx^m} P_n = 0 \\, \\text{ for }\\, n < m,$$ \n",
        "    \n",
        "    and we get no eigenfunction. $\\,$Therefore, $\\,$the eigenvalues are precisely $\\,n(n+1)\\,$ with $\\,n=m, m+1, \\cdots.$ $\\,$The eigenfunctions\n",
        "\n",
        "    $$ \\color{red}{P_n^m(x)=\\left(1 -x^2 \\right)^{m/2} \\frac{d^m}{dx^m} P_n(x)=\\frac{1}{2^n n!} \\left(1 -x^2 \\right)^{m/2} \\frac{d^{m +n}}{dx^{m +n}} \\left(x^2 -1 \\right)^n}$$\n",
        "\n",
        "    are called the **associated Legendre functions**. $\\,P_n^m(x)\\,$ corresponds to the eigenvalue $\\,n(n +1)$, $\\,$and $\\,n \\geq m$ \n",
        "\n",
        "  * In Fourier expressions, $\\,$it is useful to know the integrals of $\\,\\left[P_n^m(x)\\right]^2$. $\\,$It follows from the Rodrigues formula and $\\,n\\,$ integrations by parts that\n",
        "\n",
        "    $$\\tiny \\begin{aligned}\n",
        "      \\int_0^\\pi \\left[ P_n(\\cos\\phi)\\right]^2 \\,\\sin\\phi  \\,d\\phi &= \\int_{-1}^1 \\left[P_n(x) \\right]^2 \\,dx\\\\ \n",
        "      &= \\frac{1}{2^{2n} n!^2} \\int_{-1}^1 \\left[ \\frac{d^n}{dx^n} \\left(1- x^2 \\right)^n\\right]^2 \\, dx\\\\ \n",
        "      &= \\frac{1}{2^{2n} n!^2} \\left[ \\underbrace{\\left.\\frac{d^{n-1}}{dx^{n-1}} \\left(1- x^2 \\right)^n\n",
        "      \\frac{d^{n}}{dx^{n}} \\left(1- x^2 \\right)^n \\right|_{-1}^{1}}_{=0} \n",
        "      -\\int_{-1}^1 \\frac{d^{n-1}}{dx^{n-1}} \\left(1- x^2 \\right)^n\n",
        "      \\frac{d^{n+1}}{dx^{n+1}} \\left(1- x^2 \\right)^n \\,dx\\right]\\\\ \n",
        "      &\\,\\vdots \\\\ \n",
        "      &=\\frac{(-1)^n}{2^{2n} n!^2} \\int_{-1}^1 \\left(1- x^2 \\right)^n\n",
        "      \\underbrace{\\frac{d^{2n}}{dx^{2n}} \\left(1- x^2 \\right)^n}_{(-1)^n (2n)!} \\,dx \\\\\n",
        "      &=\\frac{(2n)!}{2^{2n} n!^2} \\int_{-1}^1 \\left(1- x^2 \\right)^n \\,dx = \\frac{(2n)!}{2^{2n} n!^2} 2^{2n +1} \\frac{n!^2}{(2n+1)!}=\\frac{2}{2n +1}\n",
        "    \\end{aligned}$$\n",
        "\n",
        "  * Similarly,\n",
        "\n",
        "    $$\\tiny \\begin{aligned}\n",
        "      \\color{blue}{\\int_0^\\pi \\left[ P_n^m(\\cos\\phi)\\right]^2 \\,\\sin\\phi  \\,d\\phi} &= \\int_{-1}^1 \\left[P_n^m(x) \\right]^2 \\,dx \n",
        "      = \\int_{-1}^1 \\left[ \\left(1 -x^2 \\right)^{m/2} \\frac{d^m}{dx^m} P_n(x) \\right]^2 \\, dx\\\\ \n",
        "      &= \\underbrace{\\left. \\frac{d^{m-1}}{dx^{m-1}} P_n(x)\n",
        "      \\left\\{ \\left(1- x^2 \\right)^m  \\frac{d^m}{dx^m} P_n(x) \\right\\} \\right|_{-1}^{\\phantom{-}1}}_{=0} \n",
        "      -\\int_{-1}^1 \\frac{d^{m-1}}{dx^{m-1}} P_n(x)\n",
        "      \\frac{d}{dx} \\left\\{\\left(1- x^2 \\right)^m  \\frac{d^m}{dx^m} P_n(x)  \\right\\} \\,dx \\\\ \n",
        "      &\\;\\Downarrow \\;\\;\\left(1- x^2 \\right)^m = (-1)^m x^{2m}+\\cdots, \\;\\;\\frac{d^m}{dx^m} P_n(x)=c_n \\frac{n!}{(n -m)!}x^{n -m}+\\cdots\\\\ \n",
        "      &= (-1)^m \\int_{-1}^1 P_n(x)\n",
        "      \\underbrace{\\frac{d^m}{dx^m} \\left\\{\\left(1- x^2 \\right)^m  \\frac{d^m}{dx^m} P_n(x) \\right\\}}_{(-1)^m \\,c_n\\, \\frac{n!}{(n-m)!\\;} \\,\\frac{(n +m)!\\;}{n!} \\,x^n +\\,\\cdots} \\,dx \\\\\n",
        "      &=\\frac{(n+m)!}{(n-m)!} \\int_{-1}^1 P_n(x) c_n x^n \\,dx \\\\\n",
        "      &=\\frac{(n+m)!}{(n-m)!} \\int_{-1}^1 \\left[ P_n(x) \\right ]^2 \\,dx \\\\\n",
        "      &=\\color{blue}{\\frac{2}{2n +1}\\frac{(n+m)!}{(n-m)!}}\n",
        "    \\end{aligned}$$\n",
        "\n",
        "    in which $\\,c_n\\,$ is the coefficient of $\\,x^n\\,$ in $\\,P_n(x)$\n",
        "\n",
        "  * Putting $\\,\\lambda=n(n+1)\\,$ in the equation for $\\,R(r)$, $\\,$we obtain the two solutions $\\,\\color{blue}{r^n}\\,$ and $\\,r^{-(n +1)}$. $\\,$Only the first of these is bounded at $\\,r=0$\n",
        "\n",
        "  * The method of separation of variables thus gives the harmonic functions\n",
        "\n",
        "  <font color=\"red\">$$\\begin{aligned}\n",
        "    &r^n P_n^m(\\cos\\phi) \\cos m\\theta\\\\ \n",
        "    &r^n P_n^m(\\cos\\phi) \\sin m\\theta \n",
        "   \\end{aligned}$$</font>\n",
        "\n",
        "  * We note that $\\,P_n^m(\\cos\\phi)\\,$ is $\\,\\sin^m\\phi\\,$ times a polynomial of degree $\\,(n -m)\\,$ in $\\,\\cos\\phi\\,$ which is even or odd according as $\\,(n -m)\\,$ is even or odd\n",
        "\n",
        "  * Since $\\,r\\cos\\phi=z$, $\\,$it follows that $\\,r^{n-m}\\,$ times this polynomial is a polynomial in $\\,r^2\\,$ and $\\,z$, $\\,$and hence in $\\,x$, $\\,y$, and $\\,z$\n",
        "\n",
        "  * Also, $\\,r\\sin\\phi=\\sqrt{x^2 +y^2}\\,$. $\\,$Thus $\\,r^m\\sin^m\\phi \\cos m\\theta\\,$ and $\\,r^m\\sin^m\\phi \\sin m\\theta\\,$ are the polynomial solutions \n",
        "in $\\,x\\,$ and $\\,y\\,$ obtained by separating the two-dimensional Laplace's equation in polar coordinates\n",
        "\n",
        "\n",
        "  * We see then that the functions $\\,r^n P_n^m(\\cos\\phi) \\cos m\\theta\\,$ and $\\,r^n P_n^m(\\cos\\phi) \\sin m\\theta\\,$ are homogeneous polynomials of degree $\\,n\\,$ in $\\,x$, $\\,y$, and $\\,z$. $\\,$They are of degree $\\,(n -m)\\,$ in $\\,z$. $\\,$These polynomials are called **spherical harmonics**\n",
        "\n",
        "  The formal solution of the problem is then\n",
        "\n",
        "  $$ \\color{red}{u(r,\\phi,\\theta) = \\sum_{n=0}^\\infty \\left( \\frac{r}{R} \\right)^n \\left[ \\frac{1}{2} a_{n0} P_n(\\cos\\phi) +\\sum_{m=1}^n \\left(a_{nm} \\cos m\\theta +b_{nm} \\sin m\\theta \\right) P_n^m(\\cos\\phi) \\right]} $$\n",
        "\n",
        "  where\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    a_{nm} &= \\frac{(2n +1)}{2\\pi}\n",
        "    \\frac{(n -m)!}{(n +m)!} \n",
        "   \\int_{0}^{2\\pi} \\int_{0}^\\pi g(\\phi,\\theta) \n",
        "      \\,P_n^m(\\cos\\phi) \\,\\cos m\\theta \\,\n",
        "      \\sin\\phi \\,d\\phi \n",
        "        \\,d\\theta \\\\ \n",
        "    b_{nm} &= \\frac{(2n +1)}{2\\pi}\n",
        "    \\frac{(n -m)!}{(n +m)!} \n",
        "    \\int_{0}^{2\\pi} \\int_{0}^\\pi g(\\phi,\\theta) \n",
        "        \\,P_n^m(\\cos\\phi) \\,\\sin m\\theta \\,\n",
        "        \\sin\\phi \\,d\\phi \n",
        "        \\,d\\theta\n",
        "  \\end{aligned} $$\n",
        "\n",
        "  are the $\\,n\\,$-th Fourier coefficients of $\\,g(\\phi,\\theta)=u(R,\\phi,\\theta)$\n",
        "\n",
        "  $~$\n",
        "\n",
        "  **2.** $\\,$We can write this solution as\n",
        "\n",
        "  $$ u(r,\\phi,\\theta) = \\int_0^{2\\pi} \\int_0^\\pi K(r,\\phi,\\theta; R,\\varphi,\\vartheta)\\, g(\\varphi,\\vartheta) \\sin\\varphi \\,d\\varphi \\, d\\vartheta $$\n",
        "\n",
        "  where $\\,K(r,\\phi,\\theta; R,\\varphi,\\vartheta)\\,$ is\n",
        "\n",
        "  $$ \\scriptsize\\displaystyle\n",
        "     \\sum_{n=0}^\\infty \\left( \\frac{r}{R} \\right)^n \n",
        "     \\underbrace{\\left[ \\frac{2n +1}{4\\pi} \n",
        "      P_n(\\cos\\phi) P_n(\\cos\\varphi) +\\sum_{m=1}^n \n",
        "       \\frac{(2n +1)}{2\\pi}\\frac{(n -m)!}{(n +m)!} \n",
        "        P_n^m(\\cos\\phi) P_n^m(\\cos\\varphi) \n",
        "        \\cos m(\\theta -\\vartheta) \n",
        "         \\right]}_{K_n(\\phi,\\,\\theta; \n",
        "          \\,\\varphi,\\,\\vartheta)}\n",
        "   \\tag{KL}\\label{eq:KL}$$\n",
        "\n",
        "  * For a fixed $\\,n$, \n",
        "\n",
        "    $$\\begin{aligned}\n",
        "     \\int_{0}^{2\\pi} \\int_{0}^\\pi & \n",
        "      \\,K_n(\\phi,\\theta;\\varphi,\\vartheta)\\, r^l \n",
        "       \\,P_l^m(\\cos\\varphi) \\,(a\\cos m\\vartheta \n",
        "       +b\\sin m\\vartheta) \\,\\sin\\varphi \\,d\\varphi \n",
        "        \\,d\\vartheta \\\\ \n",
        "     &= \n",
        "     \\begin{cases}\n",
        "       r^n P_n^m(\\cos\\phi) \n",
        "       (a\\cos m\\theta +b\\sin m\\theta)\n",
        "       & \\text{ for }\\; l=n \\\\ \n",
        "       0 & \\text{ for }\\; l \\neq n \n",
        "     \\end{cases}\n",
        "    \\end{aligned}$$\n",
        "\n",
        "  * This means that any homogeneous polynomial of degree $\\,l\\,$ which is a solution of Laplace's equation can be written as a linear combination of the $\\,2l+1\\,$ spherical harmonics $\\,r^l \\,P_l^m(\\cos\\phi)\\cos m\\theta\\,$ and $\\,r^l \\,P_l^m(\\cos\\phi)\\sin m\\theta$. $\\,$The kernel $\\,K_n(\\phi,\\theta;\\varphi,\\vartheta)\\,$ has the property that it reproduces all homogeneous harmonic polynomials of degree $\\,n,$ $\\,$and reduces those of other degrees to zero\n",
        "\n",
        "  * Since rotation of the coordinate axes takes a homogeneous harmonic polynomial of degree $\\,l\\,$ into another such polynomial in the new variable, $\\,$the kernel $\\,K_n\\,$ must be unchanged by such a rotation. $\\,$That is, $\\,$if the new polar coordinates are $\\,(r',\\phi',\\theta'),$ $\\,$we have $\\,K_n(\\phi,\\theta;\\varphi,\\vartheta)=K_n(\\phi',\\theta';\\varphi',\\vartheta')$. $\\,$In particular, $\\,$we can rotate our coordinates so that the new $\\,z$-axis passes through $\\,(r,\\phi,\\theta)$; $\\,$that is, so that $\\,\\phi'=0$\n",
        "\n",
        "  * By definition, $\\,P_n(1)=1$. $\\,$On the other hand, $\\,P_n^m(x)\\,$ with $\\,m \\geq 1\\,$ has a factor $\\,\\left(1 -x^2\\right)^{m/2}$, $\\,$so that $\\,P_n^m(1)=0$, $\\,$for $\\,m \\geq 1$. $\\,$Therefore \n",
        "\n",
        "    $$ K_n(\\phi,\\theta;\\varphi,\\vartheta) =K_n(0,\\theta';\\varphi',\\vartheta')= \\frac{2n+1}{4\\pi} P_n(\\cos\\varphi') \\tag{KS}\\label{eq:KS}$$\n",
        "\n",
        "    where $\\,\\varphi'\\,$ is the angle between the direction $\\,(\\phi,\\theta)\\,$ and $\\,(\\varphi,\\vartheta):$\n",
        "\n",
        "    $$ \\cos\\varphi'=\\cos\\phi\\cos\\varphi +\\sin\\phi\\sin\\varphi \\cos(\\theta-\\vartheta) $$\n",
        "\n",
        "  * Substituting the identity \\eqref{eq:KS} in \\eqref{eq:KL}, $\\,$we find\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "        K(r,\\phi,\\theta;R,\\varphi,\\vartheta) &= \\frac{1}{4\\pi} \\sum_{n=0}^\\infty (2n +1) \\left( \\frac{r}{R} \\right)^n P_n(\\cos\\varphi')\\\\ \n",
        "        &= \\frac{1}{4\\pi} \\left( 2r\\frac{\\partial }{\\partial r} +1 \\right) \\sum_{n=0}^\\infty \\left( \\frac{r}{R} \\right)^n P_n(\\cos\\varphi')\n",
        "    \\end{aligned}$$\n",
        "\n",
        "  * Evaluating the generating function at $\\,x=\\cos\\varphi'\\,$ and $\\,t=\\frac{r}{R}$, $\\,$we have the identity\n",
        "\n",
        "    $$ \\frac{R}{\\sqrt{r^2 +R^2 -2rR\\cos\\varphi'}} = \\sum_{n=0}^\\infty \\left( \\frac{r}{R}\\right)^n P_n(\\cos\\varphi') $$\n",
        "\n",
        "    Since\n",
        "\n",
        "    $$ \\scriptsize \n",
        "   \\begin{aligned}\n",
        "    \\left( 2r\\frac{\\partial}{\\partial r} +1\\right) \n",
        "     &\\frac{R}{\\sqrt{r^2 +R^2 -2rR\\cos\\varphi'}} \n",
        "     = \\frac{R\\left(R^2 -r^2\\right)}{\\left(r^2 +R^2 -2rR\\cos\\varphi'\\right)^{3/2}} \\\\\n",
        "     &= \\frac{\\displaystyle 1 -\\left(\\frac{r}{R}\\right)^2}{\\displaystyle\\left(1 +\\left(\\frac{r}{R}\\right)^2 -2\\frac{r}{R}\\cos\\varphi'\\right)^{3/2}} = \\mathcal{P}(r, R, \\varphi')\n",
        "     \\end{aligned}$$\n",
        "\n",
        "    where $\\,\\left(r^2 +R^2 -2rR\\cos\\varphi'\\right)^{1/2}$ is the distance from the point $\\,(r,\\phi,\\theta)\\,$ to the point $\\,(R,\\varphi,\\vartheta)$, $\\,$thus, $\\,$the solution formula is equivalent to the integral formula\n",
        "\n",
        "    $$\n",
        "    \\color{red}{u(r,\\phi,\\theta)\n",
        "    =\\frac{1}{4\\pi} \\int_0^{2\\pi} \\int_0^\\pi \n",
        "      \\mathcal{P}(r, R, \\varphi') \\, \n",
        "        g(\\varphi,\\vartheta) \\sin\\varphi \\,d\\varphi \\, \n",
        "        d\\vartheta} $$\n",
        "  \n",
        "    This is **Poisson's integral formula** in three dimensions\n",
        "\n",
        "$~$\n",
        "\n",
        "## A Nonhomogeneous Dirichlet Problem (Green's Function) {#sec-x3-36}\n",
        "\n",
        "* A common problem in applied mathematics is to find the potential in some region of space in response to a forcing term $\\,f$. $\\,$A typical example would be to find the potential inside a circle in two dimensions that satisfies\n",
        "\n",
        "  $$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=-f(r,\\theta), \\;\\;\\;0 < r < 1 $$\n",
        "\n",
        "  $$ u(1,\\theta) = 0, \\;\\;\\; 0 \\leq \\theta < 2\\pi $$\n",
        "\n",
        "* Note that we have chosen the boundary values to be zero. $\\,$<font color=\"red\">If we wanted to solve the general case, where both the equation and BC were nonhomogeneous, $\\,$we could add the Poisson integral formula from @sec-x3-33 to the solution from this section</font>\n",
        "\n",
        "* In order to gain a little intuition about nonhomogeneous differential equations, $\\,$let's consider graphing the solution to the following Poisson's equation:\n",
        "\n",
        "  $$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=-q, \\quad 0 < r < 1 $$\n",
        "\n",
        "  $$ u(1,\\theta) = 0, \\quad 0 \\leq \\theta < 2\\pi $$\n",
        "\n",
        "  Here, $\\,$the potential is fixed at zero on the boundary, $\\,$and the Laplacian of $\\,u\\,$ is always equal to $-q\\,$ inside the circle. $\\,$Since $\\,\\nabla^2 u(p)\\,$ measures the difference between $\\,u(p)\\,$ and the average of its neighbors, $\\,$it will look like a thin membrane fixed at the boundary that was continuously being pushed up by a stream of air from below\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Potentials from Point Sources and Sinks**\n",
        "\n",
        "  * <font color=\"blue\">In solving a nonhomogeneous linear equation, $\\,$it is sufficient to solve the equation with a point source since we can find the solution to the general problem by summing the responses to point sources.</font> $\\,$Our goal here is to find the potential in some region of space due to a point source (or sink)\n",
        "\n",
        "  * Suppose we have a single point source of magnitude $\\,q\\,$ located at the origin. $\\,$It is clear that the heat will flow outward along radial lines, $\\,$and, $\\,$hence, $\\,$if we compute the total outward flux across a circle of radius $\\,r$, $\\,$we have\n",
        "\n",
        "  $$ \\text{Total outward flux across the circle }=-\\int_0^{2\\pi} \\underbrace{u_r(r)}_{<\\,0}\\, r\\,d\\theta = -2\\pi r\\, u_r(r)$$\n",
        "\n",
        "  * But the outward flux must be equal to the heat generated within the circle (conservation of energy), $\\,$so we have\n",
        "\n",
        "    $$-2\\pi r u_r(r) = q$$\n",
        "\n",
        "    Solving this simple differential equation for $\\,u_r(r)$, $\\,$we get\n",
        "\n",
        "    $$ u(r)=\\frac{q}{2\\pi} \\ln \\frac{1}{r} $$\n",
        "\n",
        "    A sink, $\\,$on the other hand, $\\,$is represented by a negative source, $\\,$and so a sink with magnitude $-q\\,$ would give rise to a potential field\n",
        "\n",
        "    $$ u(r)=-\\frac{q}{2\\pi} \\ln \\frac{1}{r} $$\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Poisson's Equation Inside a Circle**\n",
        "\n",
        "  * We will now solve the important problem\n",
        "\n",
        "    $$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=-f(r,\\theta), \\quad 0 < r < 1 $$\n",
        "\n",
        "    $$ u(1,\\theta) = 0, \\quad 0 \\leq \\theta < 2\\pi $$\n",
        "\n",
        "  * The Green function technique (impulse-response method) consists of two steps:\n",
        "\n",
        "    * Finding the potential $\\,G(r,\\theta,\\rho,\\phi)\\,$ at $\\,(r,\\theta)$, $\\,$which we force to be zero on the \n",
        "      boundary and which is due to a single charge (magnitude 1) at $\\,(\\rho,\\phi)$\n",
        "    * Summing the individual responses $\\,G(r,\\theta,\\rho,\\phi)\\,$ weighted by $\\,f(\\rho,\\phi)\\,$ over all \n",
        "    $\\,(\\rho,\\phi)\\,$ in the circle to get the solution\n",
        "\n",
        "    $$ u(r,\\theta)=\\int_0^{2\\pi} \\int_0^1 G(r,\\theta,\\rho,\\phi)\\, f(\\rho,\\phi)\\,\\rho\\, d\\rho d\\phi$$\n",
        "\n",
        "**STEP 1** $\\,$ Since the function\n",
        "\n",
        "$$ \\frac{1}{2\\pi} \\ln \\frac{1}{R} $$\n",
        "\n",
        "is the potential at $\\,(r,\\theta)\\,$ due to a single unit charge at $\\,(\\rho,\\phi)$, $\\,$where $\\,R\\,$ is the distance from $\\,(r,\\theta)\\,$ to $\\,(\\rho,\\phi)\\,$, $\\,$the only thing left to do is to modify the function so that it is zero on the boundary\n",
        "\n",
        "**STEP 2** $\\,$ The strategy is to place a sink outside the circle at such a point that the potential due to both is constant on the circle at $\\,r=1$. $\\,$We can then subtract this constant value to obtain a zero potential on the boundary. $\\,$The big question is, $\\,$of course, $\\,$where do we place the sink outside circle, $\\,$so that the potential on the boundary is constant?\n",
        "\n",
        "Without going into the details, $\\,$we can show rather easily that if the sink is placed at $\\,(1/\\rho,\\phi)$, $\\,$then the potential due to the source and the sink will be constant on the circle $\\,r=1$  \n",
        "\n",
        "$$\\begin{aligned} \n",
        " \\displaystyle u^*(r,\\theta) \n",
        "   &= \\frac{1}{2\\pi} \\ln \\frac{1}{R} \n",
        "   -\\frac{1}{2\\pi} \\ln \\frac{1}{\\bar{R}} \n",
        "   = \\frac{1}{2\\pi} \\ln\\frac{\\bar{R}}{R} \\\\[2pt]\n",
        "   &=\\frac{1}{2\\pi} \n",
        "   \\ln \\frac{\\sqrt{r^2 +1/\\rho^2 \n",
        "    -2r/\\rho \\cos(\\theta-\\phi)}}{\\sqrt{r^2 +\\rho^2 \n",
        "     -2r\\rho \\cos(\\theta -\\phi)}} \\\\[2pt]\n",
        "   &\\Downarrow \\;\\; r=1 \\\\\n",
        "   u^*(1,\\theta) &= -\\frac{1}{2\\pi} \\ln \\rho\n",
        "\\end{aligned}$$\n",
        "\n",
        "With these steps in mind, $\\,$we construct Green's function\n",
        "\n",
        "$$ G(r,\\theta,\\rho,\\phi)=\\frac{1}{2\\pi}\\ln \\frac{1}{R} -\\frac{1}{2\\pi}\\ln \\frac{1}{\\bar{R}} + \\frac{1}{2\\pi}\\ln \\rho $$\n",
        "\n",
        "![](figures/pde03_figure13.jpg \"potential field due to two opposite\"){width=\"85%\" fig-align=\"center\"}\n",
        "\n",
        "To find the solution to our orginal problem, $\\,$we merely superimpose the impulse functions; $\\,$this brings us to the final solution\n",
        "\n",
        "$$ \\color{red}{u(r,\\theta) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\int_0^1 \\ln \\left(\\rho\\frac{\\bar{R}}{R}\\right) \\, f(\\rho,\\phi)\\, \\rho\\,d\\rho\\,d\\phi}\n",
        "\\tag{CG}\\label{eq:CG} $$\n",
        "\n",
        "This is Green's function solution of Poisson's equation inside a circle\n",
        "\n",
        "**NOTES**\n",
        "\n",
        "**1.** It is also possible to solve\n",
        "\n",
        "$$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=0, \\;\\;\\;0 < r < 1 $$\n",
        "\n",
        "$$ u(1,\\theta) = g(\\theta), \\;\\;\\; 0 \\leq \\theta < 2\\pi $$\n",
        "\n",
        "by means of the Green's function approach\n",
        "\n",
        "* Choose any point $\\,(r_0,\\phi_0)\\,$ inside a circle. $\\,$Let $\\,v(r,\\phi)\\,$ be any twice continuously differentiable function in a circle such that $\\,v=g\\,$ on the boundary, $\\,$and $\\,v=0\\,$ near $\\,(r_0,\\phi_0)$. $\\,$Let $w = u -v$. $\\,$Then $\\,w\\,$ satisfies\n",
        "\n",
        "  $$ \\nabla^2w = -\\nabla^2v, \\;\\;\\;0 < r < 1 $$\n",
        "\n",
        "  $$ w(1,\\theta) = 0, \\;\\;\\; 0 \\leq \\theta < 2\\pi $$\n",
        "\n",
        "  Therefore\n",
        "\n",
        "  $$ w(r_0,\\theta_0)=-\\int_0^{2\\pi} \\int_0^1 G(r_0,\\theta_0,\\rho,\\phi)\\, \\nabla^2 v\\,\\rho\\, d\\rho d\\phi $$\n",
        "\n",
        "* Since $\\,v=0\\,$ near the singularity $\\,(r_0,\\theta_0)\\,$ of $\\,G$, $\\,$we can apply the divergence theorem to the identity\n",
        "\n",
        "  $$ G\\nabla^2 v = G \\nabla^2 v -v\\nabla^2 G = \\nabla \\cdot \\left( G\\nabla v -v\\nabla G\\right)$$\n",
        "\n",
        "  to find that\n",
        "\n",
        "  $$ \\begin{aligned} w(r_0,\\theta_0)&=-\\int_0^{2\\pi} \\int_0^1 G(r_0,\\theta_0,\\rho,\\phi)\\, \\nabla^2 v\\,\\rho\\, d\\rho d\\phi \\\\\n",
        "  &\\Downarrow \\;\\;{\\scriptstyle \\text{Divergence Theorem}} \\\\\n",
        "  &=-\\int_0^{2\\pi} \\left[ G(r_0,\\theta_0,1,\\phi) \\frac{\\partial v}{\\partial r} -v\\frac{\\partial G}{\\partial r}(r_0,\\theta_0,1,\\phi)\\right]\\,d\\phi \\\\\n",
        "  &\\Downarrow \\;\\;{\\scriptstyle \\text{ On the boundary, } G\\, =\\, 0, \\; v\\, = g} \\\\\n",
        "  &= \\int_0^{2\\pi} \\frac{\\partial G}{\\partial r}(r_0,\\theta_0,1,\\phi) \\,g(\\phi)\\,d\\phi \n",
        "  \\end{aligned} $$\n",
        "\n",
        "* But $\\,v(r_0,\\theta_0)=0$, $\\,$so that $\\,w(r_0,\\theta_0)=u(r_0,\\theta_0).$ $\\,$Since $\\,(r_0,\\theta_0)\\,$ was any point in a circle, $\\,$the solution is\n",
        "\n",
        "  $$ u(r,\\theta) = \\int_0^{2\\pi} \\frac{\\partial G}{\\partial r}(r,\\theta,1,\\phi)\\,g(\\phi)\\,d\\phi $$\n",
        "\n",
        "  which, $\\,$if we compute $\\,\\displaystyle\\frac{\\partial G}{\\partial r}$, $\\,$gives\n",
        "\n",
        "  $$ u(r,\\theta) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\left[ \\frac{1 - r^2}{1 +r^2 -2r\\cos(\\theta -\\phi)} \\right]\\,g(\\phi)\\,d\\phi \n",
        "  \\tag{PI}\\label{eq:PI}$$\n",
        "\n",
        "  which is the Poisson integral formula\n",
        "\n",
        "**2.** The solution to the general Dirichlet problem\n",
        "\n",
        "$$ u_{rr} +\\frac{1}{r}u_r + \\frac{1}{r^2} u_{\\theta\\theta}=-f(r,\\theta), \\;\\;\\;0 < r < 1 $$\n",
        "\n",
        "$$ u(1,\\theta) = g(\\theta), \\;\\;\\; 0 \\leq \\theta < 2\\pi $$\n",
        "\n",
        "would be the sum of solutions \\eqref{eq:CG} and \\eqref{eq:PI}  \n",
        "\n",
        "$~$\n",
        "\n",
        "* **Poisson's Equation Inside a Sphere**\n",
        "\n",
        "  * We consider the problem\n",
        "\n",
        "    $$\\begin{aligned}\n",
        "    u_{rr} &+\\frac{2}{r} u_r \n",
        "     +\\frac{1}{r^2}u_{\\phi\\phi} \n",
        "     +\\frac{\\cot\\phi}{r^2} u_{\\phi} \n",
        "     +\\frac{1}{r^2\\sin^2\\phi}u_{\\theta\\theta} \n",
        "      = -F(r,\\phi,\\theta), \\;\\; r < R \\\\ \n",
        "     &u(R,\\phi,\\theta) = 0\n",
        "    \\end{aligned}$$\n",
        "\n",
        "  * The solution procedure consists of two steps:\n",
        "    \n",
        "    * Solve by taking the finite Fourier Transforms\n",
        "\n",
        "      $$\\scriptsize\n",
        "      \\begin{aligned}\n",
        "       \\mathcal{F}_{ac,nm} \n",
        "        \\left[f(r,\\phi,\\theta)\\right] \n",
        "         &= \\frac{2n +1}{2\\pi} \\frac{(n -m)!}{(n +m)!} \n",
        "         \\int_{0}^{2\\pi} \\int_{0}^\\pi f(r,\\phi,\\theta) \n",
        "         \\,P_n^m(\\cos\\phi) \\,\\cos m\\theta \n",
        "         \\,\\sin\\phi \\,d\\phi \\,d\\theta \\\\\n",
        "       \\mathcal{F}_{as,nm} \n",
        "        \\left[f(r,\\phi,\\theta)\\right]\n",
        "         &= \\frac{2n +1}{2\\pi} \\frac{(n -m)!}{(n +m)!} \n",
        "         \\int_{0}^{2\\pi} \\int_{0}^\\pi f(r,\\phi,\\theta) \n",
        "         \\,P_n^m(\\cos\\phi) \\,\\sin m\\theta \n",
        "         \\,\\sin\\phi \\,d\\phi \\,d\\theta\n",
        "      \\end{aligned}$$\n",
        "\n",
        "    * Derive $\\,G(r,\\phi,\\theta; \\rho, \\varphi, \\vartheta)\\,$ in the equivalent integral formula\n",
        "\n",
        "      $$\\scriptsize u(r,\\phi,\\theta) \n",
        "      = \\int_0^{2\\pi} \\int_0^\\pi \\int_0^R \n",
        "      G(r,\\phi,\\theta; \\rho,\\varphi,\\vartheta)\\, \n",
        "      F(\\rho, \\varphi,\\vartheta) \n",
        "      \\,\\rho^2 \\sin\\varphi \n",
        "      \\,d\\rho \\,d\\varphi \\, d\\vartheta$$\n",
        "\n",
        "**STEP 1** $\\,$Using the finite Fourier transforms of $\\,u\\,$ and $\\,F$:\n",
        "\n",
        "$$\\begin{aligned}\n",
        " a_{nm}(r) &= \\mathcal{F}_{ac,nm}\n",
        "  \\left[u(r,\\phi,\\theta)\\right]\\\\ \n",
        " b_{nm}(r) &= \\mathcal{F}_{as,nm}\n",
        "  \\left[u(r,\\phi,\\theta)\\right]\\\\ \n",
        " A_{nm}(r) &= \\mathcal{F}_{ac,nm}\n",
        "  \\left[F(r,\\phi,\\theta)\\right]\\\\ \n",
        " B_{nm}(r) &= \\mathcal{F}_{as,nm}\n",
        "  \\left[F(r,\\phi,\\theta)\\right]\n",
        "\\end{aligned}$$\n",
        "\n",
        "we obtain the finite Fourier transforms of the differential equation and integrating by parts leads to the system\n",
        "\n",
        "$$\\begin{aligned}\n",
        " r^2 a_{nm}'' +2r a_{nm}' &-n(n +1) a_{nm} = -r^2 A_{nm}, \\; \n",
        " a_{nm}(R)= 0, \\; \\left|a_{nm}\\right| < \\infty\\\\ \n",
        " r^2 b_{nm}'' +2r b_{nm}' &-n(n +1) b_{nm} = -r^2 B_{nm}, \\; \n",
        " b_{nm}(R)= 0, \\; \\left|b_{nm}\\right| < \\infty \n",
        "\\end{aligned}$$\n",
        "\n",
        "These problems have the solutions\n",
        "\n",
        "$$\\begin{aligned}\n",
        " a_{nm}(r) \n",
        "  &=\\int_0^R G_n(r,\\rho)\\,A_{nm}(\\rho)\n",
        "   \\,\\rho^2 \\,d\\rho \\\\ \n",
        " b_{nm}(r) \n",
        "  &=\\int_0^R G_n(r,\\rho)\\,B_{nm}(\\rho)\n",
        "   \\,\\rho^2 \\,d\\rho\n",
        "\\end{aligned}\n",
        " \\tag{SG}\\label{eq:SG}$$ \n",
        "\n",
        "where (See @sec-GF)\n",
        "\n",
        "$$ \\scriptsize G_n(r,\\rho) = \n",
        "\\begin{cases}\n",
        " \\displaystyle\\frac{1}{(2n +1)R}\\left(\\frac{r}{R} \\right)^n\\left[\\left(\\frac{\\rho}{R} \\right)^{-(n+1)} -\\left(\\frac{\\rho}{R} \\right)^{n} \\right] & \\text{ for } r \\leq \\rho \\\\ \n",
        " \\displaystyle\\frac{1}{(2n +1)R}\\left(\\frac{\\rho}{R} \\right)^n\\left[\\left(\\frac{r}{R} \\right)^{-(n+1)} -\\left(\\frac{r}{R} \\right)^{n} \\right]& \\text{ for } r \\geq \\rho \n",
        "\\end{cases}$$\n",
        "\n",
        "Thus the problem \\eqref{eq:SG} has a solution\n",
        "\n",
        "$$ u(r,\\phi,\\theta) = \\sum_{n=0}^\\infty \\left[ \\frac{1}{2} a_{n0}(r) P_n(\\cos\\phi) +\\sum_{m=1}^n \\left(a_{nm}(r) \\cos m\\theta +b_{nm}(r) \\sin m\\theta \\right) P_n^m(\\cos\\phi) \\right]\n",
        "\\tag{SS}\\label{eq:SS}$$\n",
        "\n",
        "**STEP 2** $\\,$We substitute the definitions of $\\,A_{nm}(r)\\,$ and $\\,B_{nm}(r)\\,$ in \\eqref{eq:SG}, $\\,$and formally interchange integration and summation in \\eqref{eq:SS}. $\\,$This process gives the formal solution \n",
        "\n",
        "$$ u(r,\\phi,\\theta) = \\int_0^{2\\pi} \\int_0^\\pi \\int_0^R G(r,\\phi,\\theta; \\rho,\\varphi,\\vartheta)\\, F(\\rho, \\varphi,\\vartheta) \\,\\rho^2 \\sin\\varphi \\,d\\rho \\,d\\varphi \\, d\\vartheta $$\n",
        "\n",
        "where for $\\,r > \\rho$\n",
        "\n",
        "$$\\scriptsize \\begin{aligned}\n",
        " G(r,\\phi,\\theta;\\rho,\\varphi,\\vartheta) &=\\sum_{n=0}^\\infty \\frac{1}{(2n +1)R}\n",
        "  \\left(\\frac{\\rho}{R} \\right)^n \n",
        "  \\left[ \\left(\\frac{r}{R} \\right)^{-(n +1)} -\\left(\\frac{r}{R} \\right)^{n} \\right] \n",
        "  K_n(\\phi,\\theta;\\varphi,\\vartheta)\\\\ \n",
        " &= \\frac{1}{4\\pi R} \\sum_{n=0}^\\infty \\left(\\frac{\\rho}{R} \\right)^n \n",
        "  \\left[ \\left(\\frac{r}{R} \\right)^{-(n +1)} -\\left(\\frac{r}{R} \\right)^{n} \\right] P_n(\\cos\\varphi') \n",
        "\\end{aligned}$$\n",
        "\n",
        "For $\\,r < \\rho$, $\\,$we must only interchange $\\,r\\,$ and $\\,\\rho\\,$ in this formula\n",
        "\n",
        "To evaluate the series in the above equation, $\\,$we use the generating function:\n",
        "\n",
        "$$\\begin{aligned}\n",
        " G(r,\\phi,\\theta;\\rho,\\varphi,\\vartheta) &=\\frac{1}{4\\pi} \\frac{1}{\\sqrt{r^2+\\rho^2-2r\\rho\\cos\\varphi'}}\n",
        " -\\frac{1}{4\\pi} \\frac{1}{\\sqrt{R^2 +\\frac{r^2\\rho^2}{R^2} -2r\\rho\\cos\\varphi'}}\n",
        "\\end{aligned}\n",
        "$$\n",
        "\n",
        "This, $\\,$then, $\\,$is the Green's function for $\\,r > \\rho$. $\\,$It is already symmetric in $\\,r\\,$ and $\\,\\rho$, $\\,$so that the same formula holds for $\\,r < \\rho$, and even for $\\,r=\\rho$. $\\,$We note that $\\,G=0\\,$ for $\\,r=R$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Hydrogen Atom {#sec-x3-37}\n",
        "\n",
        "* As the electron circles around the nucleus, $\\,$the system (the proton and the electron) rotates around the center of gravity. $\\,$For the rotating system, $\\,$we can write the reduced mass, $\\,\\mu$, $\\,$as\n",
        "\n",
        "  $$ \\frac{1}{\\mu} = \\frac{1}{m_e} + \\frac{1}{m_p} $$\n",
        "\n",
        "  <center>$~$or</center>\n",
        "\n",
        "  $$ \\mu = \\frac{m_em_p}{m_e +m_p} $$\n",
        "\n",
        "  Since the mass of the electron is so much less than that of the proton, $\\,m_e +m_p \\approx m_p\\,$ and $\\,\\mu = m_e$. $\\,$Assuming that the nucleus is stationary and that the electron does all of the moving (known as the Born-Oppenheimer approximation) leads to the same result\n",
        "\n",
        "* The Hamiltonian can be written as the sum of the kinetic and potential energies\n",
        "\n",
        "  $$H = T + V$$\n",
        "\n",
        "  in which $\\,T = p^2/2\\mu\\,$ and the potential energy $\\,V$ $\\,$for the interaction of the electron with the proton is $-e^2/r$. $\\,$Therefore, $\\,$the Hamiltonian operator $\\,H\\,$ is\n",
        "\n",
        "  $$ H=-\\frac{\\hbar^2}{2\\mu} \\nabla^2 -\\frac{e^2}{r} $$\n",
        "\n",
        "* Therefore, $\\,$the time-independent wave function $\\psi$ gives\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "  H \\psi &= E \\psi \\\\ \n",
        "  &\\Downarrow \\\\\n",
        "  \\nabla^2 \\psi +\\color{red}{\\frac{2\\mu}{\\hbar^2}} &\\color{red}{\\left( \\frac{e^2}{r} +E \\right) \\psi} =0 \\\\\n",
        "  &\\Downarrow \\\\\n",
        "  \\frac{1}{r^2}\\left( r^2 \\psi_r \\right)_r +\\frac{1}{r^2\\sin\\phi} \\left( \\sin\\phi\\, \\psi_\\phi \\right)_\\phi \n",
        "    &+\\frac{1}{r^2\\sin^2\\phi} \\psi_{\\theta\\theta} +\\frac{2\\mu}{\\hbar^2} \\left( \\frac{e^2}{r} +E \\right) \\psi =0 \n",
        "  \\end{aligned}$$\n",
        "\n",
        "* We assume that $\\,\\psi(r,\\phi,\\theta)=R(r)\\,\\Phi(\\phi)\\,\\Theta(\\theta)\\,$ and make the substitution. $\\,$For simplicity, $\\,$we will write the partial solutions as $\\,R$, $\\,\\Phi$, and $\\,\\Theta\\,$ without showing the functionality. $\\,$We now divide both sides by $\\,R\\,\\Phi\\,\\Theta\\,$ and multiply by $\\,r^2\\sin^2\\phi$:\n",
        "   \n",
        "  $$\\frac{\\sin^2\\phi}{R}\\left( r^2 R_r \\right)_r +\\frac{\\sin\\phi}{\\Phi} \\left( \\sin\\phi\\, \\Phi_\\phi \\right)_\\phi \n",
        "  +\\frac{1}{\\Theta} \\Theta_{\\theta\\theta} +\\frac{2\\mu r^2\\sin^2\\phi}{\\hbar^2} \\left( \\frac{e^2}{r} +E \\right) =0 $$\n",
        "\n",
        "* Inspection shows that, $\\,$of the four terms on the left side of the equation, $\\,$there is no functional dependence on $\\,\\theta\\,$ except in the third term. $\\,$Therefore, $\\,$with respect to the other variables, $\\,$the third term can be treated as a constant:\n",
        "\n",
        "  $$\\begin{aligned}\n",
        "    \\scriptsize\n",
        "    -\\frac{\\sin^2\\phi}{R}\\left( r^2 R_r \\right)_r -\\frac{\\sin\\phi}{\\Phi} \\left( \\sin\\phi\\, \\Phi_\\phi \\right)_\\phi \n",
        "      &\\scriptsize\n",
        "      -\\frac{2\\mu r^2\\sin^2\\phi}{\\hbar^2} \\left( \\frac{e^2}{r} +E \\right) \n",
        "      = \\frac{1}{\\Theta} \\Theta_{\\theta\\theta} = -\\lambda <0 \\\\ \n",
        "    &\\Downarrow \\\\\n",
        "    \\Theta_{\\theta\\theta} &+\\lambda \\Theta = 0, \\;\\;\\Theta(0)=\\Theta(2\\pi)\\\\\n",
        "      &\\Downarrow \\;\\;e^{\\pm i2\\pi \\sqrt{\\lambda}} =1\\\\\n",
        "      \\lambda_m = m^2, &\\;m=0,\\pm 1, \\pm 2,\\cdots \\\\ \n",
        "      \\Theta_m(\\theta) &= \\frac{1}{\\sqrt{2\\pi}} e^{im\\theta} \n",
        "  \\end{aligned}$$\n",
        "\n",
        "  Actually, $\\,$there are two solutions: $\\,e^{im\\theta}\\,$ and $\\,e^{-im\\theta}$, $\\,$but we cover the latter by allowing $\\,m\\,$ to run negative\n",
        "\n",
        "* We can now write the wave equation as\n",
        "\n",
        "  $$\\scriptsize \\frac{\\sin^2\\phi}{R}\\left( r^2 R_r \\right)_r +\\frac{\\sin\\phi}{\\Phi} \\left( \\sin\\phi\\, \\Phi_\\phi \\right)_\\phi \n",
        "    -m^2 +\\frac{2\\mu r^2\\sin^2\\phi}{\\hbar^2} \\left( \\frac{e^2}{r} +E \\right) \n",
        "    = 0$$\n",
        "    \n",
        "  If we divide the equation by $\\sin^2\\phi$ and rearrange, $~$we obtain\n",
        "\n",
        "  $$\\scriptsize \\begin{aligned}\n",
        "  \\frac{1}{R}\\left( r^2 R_r \\right)_r +\\frac{2\\mu r^2}{\\hbar^2} \\left( \\frac{e^2}{r} +E \\right) &+\\frac{1}{\\Phi\\sin\\phi} \n",
        "    \\left( \\sin\\phi\\, \\Phi_\\phi \\right)_\\phi -\\frac{m^2}{\\sin^2\\phi} = 0 \\\\\n",
        "  &\\Downarrow \\\\\n",
        "    \\frac{1}{\\Phi\\sin\\phi} \\left( \\sin\\phi\\, \\Phi_\\phi \\right)_\\phi &-\\frac{m^2}{\\sin^2\\phi} = -\\beta \\\\\n",
        "    \\frac{1}{R}\\left( r^2 R_r \\right)_r +\\frac{2\\mu r^2}{\\hbar^2} &\\left( \\frac{e^2}{r} +E \\right) = \\beta \\\\[2pt]\n",
        "  &\\Downarrow \\;\\;\n",
        "  \\frac{1}{\\sin\\phi} \\left( \\sin\\phi\\, \\Phi_\\phi \\right)_\\phi +\\left( \\beta-\\frac{m^2}{\\sin^2\\phi}\\right)\\Phi = 0 \\\\[2pt]\n",
        "  \\frac{1}{r^2}\\left( r^2 R_r \\right)_r +\\color{red}{\\frac{2\\mu}{\\hbar^2}} &\\color{red}{\\left( \\frac{e^2}{r} +E \\right)R -\\frac{\\beta}{r^2}R}=0\n",
        "\\end{aligned}$$\n",
        "\n",
        "* We will now turn our attention to the equation involving $\\,\\phi$. $\\,$The standard method for solving this equation is to make the transformation $\\,x=\\cos\\phi$\n",
        "\n",
        "  $$\\scriptsize\\begin{aligned}\n",
        "    \\frac{1}{\\sin\\phi} \\frac{d}{d\\phi} \\left( \\frac{\\sin^2\\phi}{\\sin\\phi}\\, \\frac{d\\Phi}{d\\phi} \\right) &+\\left( \\beta-\\frac{m^2}{\\sin^2\\phi}\\right)\\Phi = 0 \\\\ \n",
        "    &\\Downarrow\\;\\;x=\\cos\\phi,\\;dx=-\\sin\\phi\\,d\\phi \\\\ \n",
        "    \\frac{d}{dx} \\left[ \\left(1 -x^2\\right) \\frac{d\\Phi}{dx} \\right] &+ \\left( \\beta-\\frac{m^2}{1 -x^2}\\right)\\Phi = 0 \\\\ \n",
        "    &\\Downarrow \\\\\n",
        "    \\left(1 -x^2\\right) \\frac{d^2\\Phi}{dx^2} -2x \\frac{d\\Phi}{dx} &+ \\left( \\beta-\\frac{m^2}{1 -x^2}\\right)\\Phi = 0 \n",
        "  \\end{aligned}$$\n",
        "\n",
        "* This is the associated Legendre equation. $\\,$If you start with the Legendre equation and differentiate it $\\,|m|\\,$ times, $\\,$you end up with a new differential equation \n",
        "\n",
        "  $$\\scriptsize\\begin{aligned}\n",
        "    \\left(1 -x^2\\right)P_l''(x) -\\,&\\,2xP_l'(x) +l(l+1)P_l(x) = 0,\\;\\;\\; l=0,1,2,\\cdots \\\\[5pt] \n",
        "    &\\Downarrow\\;\\; {\\scriptstyle \\text{differentiate it } |m| \\text{ times}, \\;\\;y = \\left(\\frac{d}{dx}\\right)^{|m|} P_l(x),\\; \\; |m|\\, \\leq\\, l} \\\\[5pt] \n",
        "    \\left(1 -x^2\\right)y'' -2 |m| x y'&-|m|(|m| -1)y -2x y' -2|m|y +l(l +1)y = 0\\\\ \n",
        "    &\\Downarrow\\\\ \n",
        "    \\left(1 -x^2\\right)y'' -2x(|m| +1)&y' +\\left[l(l +1) -|m|(|m| +1)\\right] y = 0 \n",
        "  \\end{aligned}$$\n",
        "\n",
        "* And the substitution\n",
        "\n",
        "  $$\\scriptsize\\begin{aligned}\n",
        "  y&= \\left(1 -x^2\\right)^{-|m|/2} \\Phi \\\\ \n",
        "  y'&= \\left(1 -x^2\\right)^{-|m|/2} \\left[\\frac{d\\Phi}{dx} +\\frac{|m|x}{1 -x^2}\\Phi \\right] \\\\ \n",
        "  y''&= \\left(1 -x^2\\right)^{-|m|/2} \\left[\\frac{d^2\\Phi}{dx^2} +\\frac{2|m|x}{1 -x^2}\\frac{d\\Phi}{dx} \n",
        "    +\\frac{|m|+|m|x^2 +|m|^2x^2}{(1-x^2)^2} \\Phi \\right]\n",
        "  \\end{aligned}$$\n",
        "\n",
        "  puts the equation into standard form with respect to $\\,\\Phi$. $\\,$Then the standard solutions of the associated Legendre equation were found to be\n",
        "\n",
        "  $$\\scriptsize \\Phi(x) = P_l^{|m|}(x) = \\left(1 -x^2\\right)^{|m|/2} \\left(\\frac{d}{dx}\\right)^{|m|} P_l(x) = \\left(1 -x^2\\right)^{|m|/2} \\frac{1}{2^l l!} \\left(\\frac{d}{dx}\\right)^{|m|+l} \\left(x^2 -1\\right)^l $$\n",
        "\n",
        "  and $\\,P_l^{|m|}(x)\\,$ are orthogonal with the weight function $1$\n",
        "\n",
        "  $$ \\scriptsize \\int_{-1}^1 P_l^{|m|}(x)\\, P_{l'}^{|m|}(x)\\,dx = \\frac{2}{2l +1} \\frac{(l +|m|)!}{(l -|m|)!} \\,\\delta_{ll'} $$\n",
        "\n",
        "* Notice that $\\,l\\,$ must be a nonnegative integer. $\\,$For any given $\\,l,$ $\\,$then, $\\,$there are $\\,(2l +1)\\,$ possible values of $\\,m$:\n",
        "\n",
        "  $$l=0,1,2,\\cdots; \\;\\;m =-l, -1 +1, \\cdots, -1, 0, 1, \\cdots, l -1, l $$\n",
        "\n",
        "  For historical reasons, $\\,l\\,$ is called the azimuthal quantum number, $\\,$and $\\,m\\,$ the magnetic quantum number\n",
        "\n",
        "* The normalized angular wave functions are called <font color=\"red\">spherical harmonics</font>:\n",
        "\n",
        "  $$ \\color{red}{Y_l^{m}(\\phi,\\theta)=\\epsilon \\sqrt{\\frac{(2l +1)}{4\\pi} \\frac{(l -|m|)!}{(l +|m|)!}} P_l^{|m|}(\\cos\\phi) e^{im\\theta}} $$\n",
        "\n",
        "  where $\\,\\epsilon=(-1)^m\\,$ for $\\,m \\geq 0\\,$ and $\\,\\epsilon=1\\,$ for $\\,m < 0$\n",
        "\n",
        "* Notice that the angular part of the wave function, $\\,Y(\\phi,\\theta)$, $\\,$is the same for all spherically symmetric potentials; $\\,$the actual shape of the potential $\\,V(r)$ $\\,$affects only the radial part of the wave function, $\\,R(r)$, $\\,$which is determined by\n",
        "\n",
        "  $$ \\frac{1}{r^2}\\left( r^2 R_r \\right)_r +\\frac{2\\mu}{\\hbar^2} \\left( \\frac{e^2}{r} +E \\right)R -\\frac{l(l +1)}{r^2}R=0$$\n",
        "\n",
        "  This equation simplifies if we change variables:\n",
        "\n",
        "  $$\\scriptsize \\begin{aligned}\n",
        "  \\text{Let } u(r) &= rR(r) \\\\ \n",
        "  &\\Downarrow \\;{\\tiny\\text{so that}} \\\\ \n",
        "  R = \\frac{u}{r}, \\;\\; \\frac{dR}{dr} = \\frac{1}{r^2} \n",
        "    &\\left( r\\frac{du}{dr} -u \\right), \n",
        "    \\;\\; \\frac{d}{dr} \n",
        "    \\left[ r^2 \\frac{dR}{dr} \\right] \n",
        "    = r\\frac{d^2 u}{dr^2} \\\\\n",
        "  &\\Downarrow \\;\n",
        "  {\\tiny \\kappa = \\frac{\\sqrt{-2\\mu E}}{\\hbar}\n",
        "    \\;\\;\\text{ and } \n",
        "    \\;\\rho_0 = \\frac{2\\mu e^2}{\\hbar^2 \\kappa}} \\\\\n",
        "    \\frac{d^2u}{dr^2} \n",
        "    =\\left[-\\frac{\\rho_0 \\kappa}{ r} \n",
        "    +\\kappa^2 +\\frac{l(l +1)}{r^2} \\right] u \\;\\; \n",
        "      &\\overset{\\rho=\\kappa r}{\\rightarrow} \n",
        "      \\;\\;\\frac{d^2u}{d\\rho^2} \n",
        "      =\\left[1 -\\frac{\\rho_0}{\\rho}\\right. \n",
        "        +\\left.\\frac{l(l +1)}{\\rho^2} \\right] u\n",
        "  \\end{aligned}$$\n",
        "\n",
        "* The next step is to peel off the asymptotic behavior, $\\,$introducing the new function $\\,v(\\rho)$\n",
        "\n",
        "  $$u(\\rho)=\\rho^{l +1} e^{-\\rho} v(\\rho)$$\n",
        "\n",
        "  in the hope that $\\,v(\\rho)\\,$ will turn out to be simpler than $\\,u(\\rho)$. In terms of $\\,v(\\rho)$, $\\,$then, $\\,$the radial equation reads\n",
        "\n",
        "  $$ \\rho \\frac{d^2v}{d\\rho^2} +2(l +1 -\\rho) \\frac{dv}{d\\rho} +\\left[ \\rho_0 -2(l +1) \\right]v=0 $$\n",
        "\n",
        "* Finally, $\\,$we assume the solution can be expressed as a power series in $\\,\\rho$:\n",
        "\n",
        "  $$ v(\\rho) = \\sum_{k = 0}^\\infty c_k \\rho^k $$\n",
        "\n",
        "  Inserting the power series into the equation and equating the coefficients of like powers yields\n",
        "\n",
        "  $$ c_{k +1} = \\frac{2(k +l +1) -\\rho_0}{(k +1)(k +2l +2)} c_k$$\n",
        "\n",
        "* Now let's see what the coefficients look like for large $\\,k$. $\\,$In this regime the recursion formula says\n",
        "\n",
        "  $$c_{k +1} \\approx \\frac{2}{k +1} c_k$$\n",
        "\n",
        "  Suppose for a moment that this were exact. $\\,$Then\n",
        "\n",
        "  $$c_k = \\frac{2^k}{k!} c_0$$\n",
        "\n",
        "* so\n",
        "  $$v(\\rho) = c_0 \\sum_{k=0}^\\infty \\frac{2^k}{k!} \\rho^k = c_0 e^{2\\rho} \\;\\;\n",
        "  \\Rightarrow \\;\\; u(\\rho)=c_0\\rho^{l +1} e^\\rho $$\n",
        "\n",
        "  which blows up at large $\\,\\rho$. $\\,$The positive exponential is precisely the asymptotic behavior we didn't want\n",
        "\n",
        "* There is only one way out of this dilemma: *The series must terminate*. $\\,$There must occur some maximal integer, $\\,k_{max}$, $\\,$such that\n",
        "\n",
        "  $$ c_{k_{max}\\, +1} = 0 $$\n",
        "\n",
        "  and beyond which all coefficient vanish automatically. $\\,$Evidently\n",
        "\n",
        "  $$ 2(k_{max} +l +1) -\\rho_0 = 0 $$\n",
        "\n",
        "* Defining the so-called principle quantum number\n",
        "\n",
        "  $$ n = k_{max} +l +1 $$\n",
        "\n",
        "  we have \n",
        "\n",
        "  $$ \\rho_0 = 2n $$\n",
        "\n",
        "* But $\\,\\rho_0\\,$ determine $\\,E$\n",
        "\n",
        "  $$ E = -\\frac{\\hbar^2 \\kappa^2}{2 \\mu} = -\\frac{2\\mu e^4}{\\hbar^2 \\rho_0^2} $$\n",
        "\n",
        "  so the allowed energies are\n",
        "\n",
        "  $$ E_n = - \\left[ \\frac{\\mu e^4}{2\\hbar^2} \\right] \\frac{1}{n^2}, \\;\\;\\;n=1,2,3,\\cdots $$\n",
        "\n",
        "  This is the famous **Bohr formula**. $\\,$The ground state (that is, $\\,$the state of lowest energy) is the case $\\,n=1$; $\\,$putting in the accepted values for the physical constants, $\\,$we get\n",
        "\n",
        "  $$ E_1 = - \\left[ \\frac{\\mu e^4}{2\\hbar^2} \\right] =-13.6\\,eV $$\n",
        "\n",
        "  and we find that \n",
        "\n",
        "  $$ \\kappa = \\frac{\\mu e^2}{\\hbar^2} \\frac{1}{n} = \\frac{1}{a_0 n},\\;\\;\\rho = \\frac{r}{a_0 n} $$\n",
        "\n",
        "  where\n",
        "\n",
        "  $$ a_0 = \\frac{\\hbar^2}{\\mu e^2} = 0.529 \\times 10^{-10} m $$\n",
        "\n",
        "  is the so-called **Bohr radius**\n",
        "\n",
        "* Anyway the radial equation gives\n",
        "\n",
        "  $$ \\color{red}{R_{nl}(r) = \\frac{1}{r} \\rho^{l +1} e^{-\\rho} v(\\rho)} $$\n",
        "\n",
        "  in which $\\,v(\\rho)\\,$ is a polynomial of degree $\\,k_{max} = n -l -1\\,$ in $\\,\\rho,$ $\\,$whose coefficients are determined by the recursion formula\n",
        "\n",
        "  $$ c_{k +1} = \\frac{2(k +l +1 -n)}{(k +1)(k +2l +2)} c_k $$\n",
        "\n",
        "  For arbitrary $\\,n$, $\\,$the possible values of $\\,l\\,$ are\n",
        "\n",
        "  $$ l=0,1,2,\\cdots,n-1 $$\n",
        "\n",
        "  and for each $\\,l$, $\\,$there are $\\,(2l +1)\\,$ possible values of $\\,m$, $\\,$so the total degeneracy of the energy level $\\,E_n\\,$ is\n",
        "\n",
        "  $$ d(n)=\\sum_{l=0}^{n-1}(2l +1)=n^2 $$\n",
        "\n",
        "* The polynomial $\\,v(\\rho)\\,$ is a function well known to applied mathematicians;  $\\,$it can be written as\n",
        "\n",
        "  $$ \\color{red}{v(\\rho) = L_{n -l -1}^{2l +1}(2\\rho)} $$\n",
        "\n",
        "  where\n",
        "\n",
        "  $$ L_{q-p}^p(x)=(-1)^p \\left( \\frac{d}{dx} \\right)^p L_q(x) =\\sum_{k=0}^{q-p} \\frac{(-1)^k}{k!} \\binom{q}{q-p-k} x^k $$\n",
        "\n",
        "  is a generalized Laguerre polynomial, $\\,$and\n",
        "\n",
        "  $$ L_q(x) =\\frac{e^x}{q!} \\left( \\frac{d}{dx} \\right)^q (e^{-x} x^q) = \\sum_{k=0}^q \\frac{(-1)^k}{k!} \\binom{q}{k} x^k  $$\n",
        "\n",
        "  is the $\\,q$-th Laguerre polynomial\n",
        "\n",
        "* The radial wave functions are given by\n",
        "\n",
        "  $$ \\color{red}{R_{nl}(r) = \\sqrt{\\left( \\frac{2}{na_0}\\right)^3 \\frac{(n -l -1)!}{2n (n +l)!}} e^{-r/na_0}\n",
        "  \\left( \\frac{2r}{na_0} \\right)^l \\, L_{n -l -1}^{2l +1} \\left( \\frac{2r}{na_0} \\right)} $$\n",
        "\n",
        "  The combinatorial factor in front assures that $\\,R_{nl}(r)\\,$ are normalized with respect to an integration over $\\,r$:\n",
        "\n",
        "  $$ \\int_0^\\infty R^2_{nl}(r) \\, r^2 dr = 1$$\n",
        "\n",
        "  Note that the volume element here is $\\,r^2 dr$, which is the $\\,r\\,$ part of the spherical coordinate volume element $\\,r^2 \\sin \\phi \\,dr \\,d\\phi \\,d\\theta$\n",
        "\n",
        "* The complete hydrogen atomic wave functions are\n",
        "\n",
        "  $$ \\color{red}{\\psi_{nlm}(r, \\phi, \\theta) = R_{nl}(r)\\,Y_l^m(\\phi,\\theta)} $$\n",
        "\n",
        "* The normalization condition is\n",
        "\n",
        "  $$ \\scriptsize\\int_0^{2\\pi} \\int_0^{\\pi} \\int_0^\\infty \\psi_{nlm}^2(r,\\phi,\\theta) \\,r^2 \\sin\\phi \\,dr \\,d\\phi \\, d\\theta = 1 $$\n",
        "\n",
        "* The functions $\\,\\psi_{nml}\\,$ must also be orthogonal. $\\,$This orthonomality relationship is given by\n",
        "\n",
        "  $$ \\scriptsize\\int_0^{2\\pi} \\int_0^{\\pi} \\int_0^\\infty \\psi^*_{nlm}(r',\\phi',\\theta')\\,\\psi_{nlm}(r,\\phi,\\theta) \\,r^2 \\sin\\phi \\,dr \\,d\\phi \\, d\\theta = \\delta_{nn'} \\delta_{ll'}\\delta_{mm'}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Worked Exercises {.unnumbered}\n",
        "\n",
        "**1.** $~$ Solve the exterior Dirichlet problem in a circle:\n",
        "$$\n",
        "\\begin{align*}\n",
        " \\nabla^2 u &= 0, \\;\\;1 < r < \\infty \\\\ \n",
        " &u(1,\\theta) =  \\sin\\theta + \\cos 3\\theta\n",
        "\\end{align*}\n",
        "$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "**Step 1:** $~$ General Solution in Polar Coordinates\n",
        "\n",
        "The general solution to Laplaces equation in polar coordinates for $r > 1$ (the exterior region) is:\n",
        "\n",
        "$$\\scriptsize u(r, \\theta) = a_0 + b_0 \\ln r + \\sum_{n=1}^\\infty \\left( a_n r^n + b_n r^{-n} \\right) \\cos n\\theta + \\sum_{n=1}^\\infty \\left( c_n r^n + d_n r^{-n} \\right) \\sin n\\theta$$\n",
        "\n",
        "**Step 2:** $~$ Apply the decay condition $u(r,\\theta) \\to 0$ as $r \\to \\infty$\n",
        "\n",
        "This requires:\n",
        "\n",
        "* $a_0 = 0$\n",
        "* $b_0 = 0$\n",
        "* $a_n = 0$, $c_n = 0$ for all $n \\ge 1$\n",
        "\n",
        "Hence, the solution becomes:\n",
        "\n",
        "$$u(r, \\theta) = \\sum_{n=1}^\\infty b_n r^{-n} \\cos n\\theta + \\sum_{n=1}^\\infty d_n r^{-n} \\sin n\\theta$$\n",
        "\n",
        "**Step 3:** $~$ Use Boundary Condition $u(1, \\theta) = \\sin\\theta + \\cos 3\\theta$\n",
        "\n",
        "At $r = 1$, we get:\n",
        "\n",
        "$$u(1, \\theta) = \\sum_{n=1}^\\infty b_n \\cos n\\theta + \\sum_{n=1}^\\infty d_n \\sin n\\theta = \\sin\\theta + \\cos 3\\theta$$\n",
        "\n",
        "So:\n",
        "\n",
        "* $b_3 = 1$, $d_1 = 1$\n",
        "* All other $b_n$, $d_n$ are $0$\n",
        "\n",
        "**Final Solution**\n",
        "\n",
        "$$\n",
        "u(r, \\theta) = \\frac{\\cos 3\\theta}{r^3} + \\frac{\\sin\\theta}{r}\n",
        "$$\n",
        "\n",
        "This satisfies Laplaces equation in $r > 1$, the boundary condition at $r = 1$, and decays at infinity\n",
        "\n",
        "$~$\n",
        "\n",
        "**2.** $~$ Solve the interior Dirichlet problem in a sphere\n",
        "$$\n",
        "\\begin{align*}\n",
        " \\nabla^2 u &= 0, \\;r <1\\\\ \n",
        " &u(1,\\phi) = 1 + \\cos\\phi\n",
        "\\end{align*}\n",
        "$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "We are solving the interior Dirichlet problem for Laplaces equation inside the unit sphere. The boundary condition is given only in terms of $\\phi$, which suggests axial symmetry (i.e., the function does not depend on the azimuthal angle $\\theta$).\n",
        "Hence, we can solve the axisymmetric Laplace equation in spherical coordinates\n",
        "\n",
        "**Step 1:** $~$ Axisymmetric Laplace Equation\n",
        "\n",
        "In spherical coordinates with axial symmetry (no \\theta dependence), Laplaces equation becomes:\n",
        "\n",
        "$$\\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial u}{\\partial r} \\right) +\\frac{1}{r^2 \\sin \\phi} \\frac{\\partial}{\\partial \\phi} \\left( \\sin \\phi \\frac{\\partial u}{\\partial \\phi} \\right) = 0$$\n",
        "\n",
        "**Step 2:** $~$ Separation of Variables\n",
        "\n",
        "Assume $u(r, \\phi) = R(r) P(\\phi)$. Substituting and separating variables gives:\n",
        "\n",
        "$$\\frac{1}{R} \\frac{d}{dr} \\left( r^2 \\frac{dR}{dr} \\right)\n",
        "\t+\\frac{1}{P \\sin \\phi} \\frac{d}{d\\phi} \\left( \\sin \\phi \\frac{dP}{d\\phi} \\right) = 0$$\n",
        "\n",
        "Set both parts equal to $\\ell(\\ell+1)$. Then:\n",
        "\n",
        "* $R(r) = A_\\ell r^\\ell$ (we discard $r^{-(\\ell+1)}$ since $u$ must be finite at $r = 0$),\n",
        "* $P(\\phi)$ satisfies Legendres equation:\n",
        "\n",
        "$$\\frac{1}{\\sin \\phi} \\frac{d}{d\\phi} \\left( \\sin \\phi \\frac{dP}{d\\phi} \\right) + \\ell(\\ell+1) P = 0 \\Rightarrow P(\\phi) = P_\\ell(\\cos\\phi)$$ \n",
        "\n",
        "**Step 3:** $~$ General Solution\n",
        "\n",
        "The general solution is:\n",
        "\n",
        "$$u(r, \\phi) = \\sum_{\\ell=0}^\\infty A_\\ell r^\\ell P_\\ell(\\cos\\phi)$$\n",
        "\n",
        "**Step 4:** $~$ Apply Boundary Condition\n",
        "\n",
        "At $r = 1$, the boundary condition is:\n",
        "\n",
        "$$u(1, \\phi) = \\sum_{\\ell=0}^\\infty A_\\ell P_\\ell(\\cos\\phi) = 1 + \\cos\\phi$$\n",
        "\n",
        "We expand $1 + \\cos\\phi$ in terms of Legendre polynomials\n",
        "\n",
        "* $P_0(\\cos\\phi) = 1$\n",
        "* $P_1(\\cos\\phi) = \\cos\\phi$\n",
        "\n",
        "So:\n",
        "\n",
        "$$1 + \\cos\\phi = P_0(\\cos\\phi) + P_1(\\cos\\phi)\n",
        "\\Rightarrow A_0 = 1, \\; A_1 = 1, \\; A_\\ell = 0 \\text{ for } \\ell \\geq 2$$\n",
        "\n",
        "**Final Solution**\n",
        "\n",
        "$$u(r, \\phi) = P_0(\\cos\\phi) + r P_1(\\cos\\phi)\n",
        "= 1 + r \\cos\\phi$$\n",
        "\n",
        "This satisfies Laplaces equation inside the unit ball and matches the boundary condition\n",
        "\n",
        "$~$\n",
        "\n",
        "**3.** $~$ Solve the exterior Dirichlet problem in a sphere\n",
        "$$\n",
        "\\begin{align*}\n",
        " \\nabla^2 u &= 0, \\;1 < r \\\\ \n",
        " &u(1,\\phi) = 1 + \\cos2\\phi\n",
        "\\end{align*}\n",
        "$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "We are solving the exterior Dirichlet problem for Laplaces equation in a spherically symmetric setting. The boundary condition depends only on the polar angle $\\phi$, so we assume axial symmetry (i.e., no $\\theta$-dependence)\n",
        "\n",
        "**Step 1:** $~$ General Axisymmetric Solution to Laplaces Equation (Exterior)\n",
        "\n",
        "The axisymmetric solution to Laplaces equation in spherical coordinates (no $\\theta$ dependence) is:\n",
        "\n",
        "$$u(r, \\phi) = \\sum_{\\ell=0}^{\\infty} \\left( A_\\ell r^{-\\ell-1} + B_\\ell r^\\ell \\right) P_\\ell(\\cos\\phi)$$\n",
        "\n",
        "To ensure the solution decays at infinity:\n",
        "\n",
        "* Set $B_\\ell = 0$\n",
        "\n",
        "So the solution becomes:\n",
        "\n",
        "$$u(r, \\phi) = \\sum_{\\ell=0}^{\\infty} A_\\ell r^{-\\ell - 1} P_\\ell(\\cos\\phi)$$\n",
        "\n",
        "**Step 2:** $~$ Apply Boundary Condition\n",
        "\n",
        "At $r = 1$, the boundary condition is:\n",
        "\n",
        "$$u(1, \\phi) = \\sum_{\\ell=0}^\\infty A_\\ell P_\\ell(\\cos\\phi) = 1 + \\cos 2\\phi$$\n",
        "\n",
        "Recall:\n",
        "\n",
        "* $P_0(\\cos\\phi) = 1$\n",
        "* $P_2(\\cos\\phi) = \\frac{1}{2}(3\\cos^2\\phi - 1) = \\cos 2\\phi$ (identity on the sphere)\n",
        "\n",
        "So this corresponds to:\n",
        "\n",
        "$$A_0 = 1, \\quad A_2 = 1, \\quad A_\\ell = 0 \\text{ for } \\ell \\ne 0,2$$\n",
        "\n",
        "**Final Solution**\n",
        "\n",
        "$$u(r, \\phi) = \\frac{1}{r} P_0(\\cos\\phi) + \\frac{1}{r^3} P_2(\\cos\\phi)\n",
        "= \\frac{1}{r} + \\frac{1}{r^3} \\cos 2\\phi$$\n",
        "\n",
        "This is harmonic for $r > 1$, satisfies the boundary condition at $r = 1$, and decays as $r \\to \\infty$\n",
        "\n",
        "$~$\n",
        "\n",
        "**4.** $~$ Solve the Dirichlet problem in a circle:\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        " \\nabla^2 u &= 0, \\;\\;1 < r < 2 \\\\ \n",
        " u(1,\\theta) &=  \\frac{1}{2} + \\cos\\theta\\\\ \n",
        " u(2,\\theta) &= 1 + \\sin\\theta \n",
        "\\end{aligned}\n",
        "$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "We solve this using separation of variables in polar coordinates $(r, \\theta)$, where the Laplacian is:\n",
        "\n",
        "$$\\nabla^2 u = \\frac{\\partial^2 u}{\\partial r^2} + \\frac{1}{r} \\frac{\\partial u}{\\partial r} + \\frac{1}{r^2} \\frac{\\partial^2 u}{\\partial \\theta^2}$$\n",
        "\n",
        " General Solution to Laplaces Equation in Annulus\n",
        "\n",
        "We use the standard separation-of-variables solution:\n",
        "\n",
        "$$\\scriptsize u(r, \\theta) = a_0 + b_0 \\log r + \\sum_{n=1}^{\\infty} \\left( A_n r^n + B_n r^{-n} \\right)\\cos(n\\theta) + \\left( C_n r^n + D_n r^{-n} \\right)\\sin(n\\theta)$$\n",
        "\n",
        "Since $r \\in (1, 2)$, both $r^n$ and $r^{-n}$ are bounded, so we retain all terms\n",
        "\n",
        "**Step 1:** $~$ Fourier Series of Boundary Data\n",
        "\n",
        "We write the boundary functions as Fourier series\n",
        "\n",
        "$$u(r,\\theta) = a_0 + b_0 \\log r + (A_1 r + B_1 r^{-1}) \\cos\\theta + (C_1 r + D_1 r^{-1}) \\sin\\theta$$\n",
        "\n",
        "Well determine the constants $a_0$, $b_0$, $A_1$, $B_1$, $C_1$, $D_1$ by applying the boundary conditions at $r = 1$ and $r = 2$\n",
        "\n",
        "At $r = 1$:\n",
        "\n",
        "$$u(1, \\theta) = a_0 + (A_1 + B_1)\\cos\\theta + (C_1 + D_1)\\sin\\theta\n",
        "= \\frac{1}{2} + \\cos\\theta$$\n",
        "\n",
        "this gives:\n",
        "\n",
        "* $a_0 = \\frac{1}{2}$\n",
        "* $A_1 + B_1 = 1$\n",
        "* $C_1 + D_1 = 0$\n",
        "\n",
        "At $r = 2$:\n",
        "\n",
        "$$u(2, \\theta) = a_0 + b_0 \\log 2 + (2A_1 + \\frac{1}{2}B_1)\\cos\\theta + (2C_1 + \\frac{1}{2}D_1)\\sin\\theta = 1 + \\sin\\theta$$\n",
        "\n",
        "Match terms:\n",
        "\n",
        "* $a_0 + b_0 \\log 2 = 1$\n",
        "* $2A_1 + \\frac{1}{2}B_1 = 0$\n",
        "* $2C_1 + \\frac{1}{2}D_1 = 1$\n",
        "\n",
        "Now solve the system\n",
        "\n",
        "**Step 2:** $~$ Solve the System\n",
        "\n",
        "We already have:\n",
        "\n",
        "* $a_0 = \\frac{1}{2}$\n",
        "* $a_0 + b_0 \\log 2 = 1 \\Rightarrow \\frac{1}{2} + b_0 \\log 2 = 1 \\Rightarrow b_0 = \\frac{1}{2 \\log 2}$\n",
        "\n",
        "Solve for $A_1$, $B_1$:\n",
        "\n",
        "*\t$A_1 + B_1 = 1$\n",
        "* $2A_1 + \\frac{1}{2}B_1 = 0$\n",
        "\n",
        "Multiply first by 2 and subtract by second:\n",
        "\n",
        "$$(2A_1 + 2B_1) - (2A_1 + \\tfrac{1}{2}B_1) = 2 - 0 \\Rightarrow \\tfrac{3}{2}B_1 = 2 \\Rightarrow B_1 = \\frac{4}{3},\\; A_1 = 1 - \\frac{4}{3} = -\\frac{1}{3}$$\n",
        "\n",
        "Solve for $C_1$, $D_1$:\n",
        "\n",
        "* $C_1 + D_1 = 0$\n",
        "* $2C_1 + \\frac{1}{2}D_1 = 1$\n",
        "\n",
        "Substitute $D_1 = -C_1$ into second:\n",
        "\n",
        "$$2C_1 - \\frac{1}{2}C_1 = 1 \\Rightarrow \\frac{3}{2}C_1 = 1 \\Rightarrow C_1 = \\frac{2}{3},\\; D_1 = -\\frac{2}{3}$$\n",
        "\n",
        "**Final Solution**\n",
        "\n",
        "$$\\boxed{\n",
        "\\begin{aligned}\n",
        "u(r, \\theta) &= \\frac{1}{2} + \\frac{1}{2 \\log 2} \\log r + \\left( -\\frac{1}{3}r + \\frac{4}{3}r^{-1} \\right)\\cos \\theta \\\\\n",
        "&\\quad + \\left( \\frac{2}{3}r - \\frac{2}{3}r^{-1} \\right)\\sin \\theta\n",
        "\\end{aligned}\n",
        "}$$\n",
        "\n",
        "This is the harmonic function in the annulus $1 < r < 2$ satisfying the given Dirichlet boundary conditions"
      ],
      "id": "19b4825a"
    }
  ],
  "metadata": {
    "kernelspec": {
      "name": "python3",
      "language": "python",
      "display_name": "Python 3 (ipykernel)",
      "path": "/opt/miniconda3/share/jupyter/kernels/python3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}