{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "---\n",
        "jupyter: python3\n",
        "---\n",
        "\n",
        "# Introduction to Differential Equations {#sec-1}\n",
        "\n",
        "## Definitions and Terminology\n",
        "\n",
        "* A **differential equation (DE)** is an equation containing the **derivatives** of **one or more dependent variables** with respect to **one or more independent variables**\n",
        "\n",
        "* Notation\n",
        "  * Leibniz notation $~\\displaystyle\\color{blue}{\\frac{d^2y}{dx^2}}$\n",
        "    \n",
        "  * Prime notation $~\\color{blue}{y''}$\n",
        "  * Newton's dot notation $~\\color{blue}{\\ddot{y}}$\n",
        "  * Subscript notation $~\\color{blue}{u_{xx} + u_{yy} = 0}$\n",
        "\n",
        "### Classification by Type\n",
        "\n",
        "* **Ordinary differential equation (ODE):** $\\,$ Derivatives are with respect to <font color=\"blue\">a single independent variable</font>\n",
        "\n",
        "  $$\\frac{dx}{d\\color{blue}{t}} + \\frac{dy}{d\\color{blue}{t}} = 3x + 2y$$\n",
        "\n",
        "* **Partial differential equation (PDE):** $\\,$ Derivatives are with respect to <font color=\"blue\">two or more independent variables</font>\n",
        "\n",
        "  $$\\frac{\\partial u}{\\partial \\color{blue}{y}} = -\\frac{\\partial u}{\\partial \\color{blue}{x}}$$\n",
        "\n",
        "### Classification by Order\n",
        "\n",
        "* The order of an ODE or PDE is the order of the <font color=\"blue\">highest derivatives</font> in the equation\n",
        "\n",
        "  $$\\underbrace{\\color{blue}{\\frac{d^2y}{dx^2}}}_{\\mathrm{highest\\; order}} +5\\left ( \\frac{dy}{dx} \\right )^3 - 4y = e^x$$\n",
        "\n",
        "  $$\\underbrace{2\\color{blue}{\\frac{\\partial^4 u}{\\partial x^4}}}_{\\mathrm{highest\\; order}} +\\frac{\\partial^2 u}{\\partial t^2} = 0$$\n",
        "\n",
        "### Classification by Linearity\n",
        "\n",
        "* An $n$-th order ODE, $F\\left( x, y, y', \\cdots, y^{(n)} \\right) = 0$, $\\,$is **linear** in the variable $y\\,$ <font color=\"blue\">if $\\,F$ is linear in $y, y',\\cdots,y^{(n)}$</font>\n",
        "\n",
        "* An ODE is **nonlinear** if\n",
        "  * The coefficients of $y, y',\\cdots,y^{(n)}$ contain the dependent variable $y$ or its derivatives\n",
        "  * Powers of $y, y',\\cdots,y^{(n)}$ appear in the equation *or*\n",
        "  * Nonlinear functions of the dependent variable or its derivatives (e.g., $\\sin y$ or $e^{y'}$) appear in the equation\n",
        "\n",
        "### Solution of an ODE\n",
        "\n",
        "* Any function $\\phi$, defined on an interval $I$ and possessing at least $n$ derivatives that are continuous on $I$, which when substituted into an   ODE reduces the equation to an identity, is **a solution**\n",
        "* Interval $I$ can be an open interval $(a,b)$, a closed interval $[a,b]$, an infinite interval $(a,\\infty)$, etc.\n",
        "* A solution of a differential equation that is identically zero on an interval $I$ is a **trivial solution**\n",
        "* The graph of a solution $\\phi$ of an ODE is a **solution curve** and it is continuous on its interval $I$ while the domain of $\\phi$ may differ from the interval $I$\n",
        "* An **explicit solution** is one in which the dependent variable is expressed solely in terms of the independent variable and constants\n",
        "* $G(x,y)=0\\,$ is an **implicit solution**, if at least one function $\\phi$ exists, that satisfies the relation $G$ and the ODE on $I$\n",
        "\n",
        "### Families of Solutions\n",
        "\n",
        "* Similar to integration, we obtain a solution to a first-order differential equation containing an arbitrary constant $c$\n",
        "* A solution with a constant $c$ represents a set $G(x,y,c)=0$ of solutions, called a **one-parameter family of solutions**\n",
        "* An $n$-parameter family of solutions \n",
        "  $$ G(x,y,c_1,c_2,\\cdots,c_n)=0 $$ \n",
        "    \n",
        "  solves an $n$-th order differential equation\n",
        "\n",
        "### Systems of Differential Equations\n",
        "\n",
        "* Two or more equations involving the derivatives of two or more unknown functions of a single independent variable are called the **system of differential equations**\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    \\frac{dx}{dt} &= f(t,x,y) \\\\\n",
        "     \\frac{dy}{dt} &= g(t,x,y)\n",
        "  \\end{aligned}$$\n",
        "    \n",
        "* A solution of a system is a set of functions defined on a common interval $I$ that satisfies each equation of the system on this interval\n",
        "\n",
        "## Initial-Value Problems - IVP {#sec-1-2}\n",
        "\n",
        "In an <font color=\"red\">**IVP**</font>, we seek a solution $y(x)$ of a differential equation so that $y(x)$ satisfies **initial conditions** at $x_0$ \n",
        "\n",
        "* $n$-th order differential equation and Initial conditions\n",
        "   \n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    \\frac{d^ny}{dx^n} &= f \\left ( x,y,y',\\cdots,y^{(n-1)} \\right ) \\\\ \n",
        "    y(x_0) &= y_0, \\;y'(x_0) = y_1, \\cdots, \\;y^{(n-1)}(x_0) = y_{n-1} \\\\ \\\\\n",
        "    &\\Downarrow \\\\ \\\\\n",
        "    \\frac{d\\mathbf{y}}{dx} &= \\mathbf{f}(x, \\mathbf{y}), \n",
        "       \\;\\;\\mathbf{y}=\\mathbf{y}_0\n",
        "  \\end{aligned}$$\n",
        "\n",
        "When solving an IVP, consider whether a solution exists and whether the solution is unique\n",
        "\n",
        "* **Existence:** $\\,$ Does the differential equation possess solutions and do any of the solution curves pass through the initial point $(x_0, y_0)$?\n",
        "* **Uniqueness:** $\\,$ When can we be certain there is precisely one solution curve passing through the initial point $(x_0, y_0)$?\n",
        "\n",
        ":::{#thm-existence-and-uniqueness} \n",
        "gives conditions that are sufficient to guarantee the existence and uniqueness of a solution $y(x)$ to a first-order IVP\n",
        "\n",
        "![](figures/ch01_figure01.png \"Rectangular Region R\"){width=\"35%\" fig-align=\"center\"}\n",
        "\n",
        "* <font color=\"blue\">$f(x,y)$ and $\\displaystyle\\frac{\\partial f}{\\partial y}$ are continuous on the region $\\,R\\,$ for the interval $\\,I_0$</font>\n",
        ":::\n",
        "\n",
        "**Example** $\\,$ First-order IVP\n",
        "\n",
        "* $y(x)=ce^x$ is a one-parameter family of solutions of the first-order DE $~y'=y$\n",
        "\n",
        "* Find a solution of the first-order IVP with initial condition $y(0)=3$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "* From the initial condition, we obtain $3=ce^0$\n",
        "\n",
        "* Solving, we find $c=3$\n",
        "\n",
        "* The solution of the IVP is $y=3e^x$\n",
        "\n",
        "**Example** $\\,$ Second-order IVP\n",
        "\n",
        "* $x(t) = c_1 \\cos 4t +c_2 \\sin 4t$ $\\,$is a two-parameter family of solutions of the second-order DE $~x''+16x=0$\n",
        "\n",
        "* Find a solution of the second-order IVP with initial conditions\n",
        "$~x\\left( \\frac{\\pi}{2} \\right) =-2, \\;x'\\left (\\frac{\\pi}{2} \\right)=1$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "* Substituting for initial conditions and solving for constants, we find $c_1=-2$ and $c_2=1/4$\n",
        "* The solution of the IVP is $~x(t)=-2\\cos 4t +\\frac{1}{4}\\sin 4t$\n",
        "\n",
        "## Differential Equations as Mathematical Models {#sec-1-3}\n",
        "\n",
        "* A **mathematical model** is a description of a system or a phenomenon\n",
        "* Differential equation models are used to describe behavior in various fields\n",
        "  * Biology\n",
        "  * Chemistry\n",
        "  * Physics\n",
        " \n",
        "* Steps of the modeling process\n",
        "\n",
        "![](figures/ch01_figure02.png \"modeling process\"){width=\"60%\" fig-align=\"center\"}\n",
        "\n",
        "**Example** $\\,$ Radioactive Decay\n",
        "\n",
        "* In modeling the phenomenon, it is assumed that the rate $\\displaystyle\\frac{dA}{dt}$ at which the nuclei of a substance decays is proportional to the amount $A(t)$ remaining at time $t$ given an initial amount of radioactive substance on hand $A_0$\n",
        "   \n",
        "  $$\\frac{dA}{dt} = -kA, \\;A(0)=A_0$$\n",
        "    \n",
        "* This differential equation also describes a first-order chemical reaction\n",
        "\n",
        "**Example** $\\,$ Draining Tank\n",
        "\n",
        "![](figures/ch01_figure03.png \"Water draining from a tank\"){width=\"20%\" fig-align=\"center\"}\n",
        "\n",
        "* Toricelli's law states that the exit speed $v$ of water through a sharp-edged hole at the bottom of a tank filled to a depth $h$ is the same as the speed it would acquire falling from a height $h$, $\\,$$v=\\sqrt{2gh}$\n",
        "\n",
        "* Volume $V$ leaving the tank per second is proportional to the area of the hole $A_h$\n",
        "  $$\\frac{dV}{dt}=-A_h\\sqrt{2gh}$$    \n",
        "\n",
        "* The volume in the tank at $t$ $\\,$is$\\,$ $V(t)=A_w h$, $\\,$ in which  $\\,$ $A_w$ is the *constant* area of the upper water surface\n",
        "\n",
        "* Combining expressions gives the differential equation for the height of water at time $t$\n",
        "  $$\\frac{dh}{dt}=-\\frac{A_h}{A_w}\\sqrt{2gh}$$\n",
        "\n",
        "## Worked Exercises {.unnumbered}\n",
        "\n",
        "**[-@sec-1-2]: 1.** $~y=1/(1 +c_1 e^{-x})$ is a one-parameter family of solutions of the first-order DE $y'=y -y^2$. $\\,$ Find a solution of the first-order IVP consisting of this differential equation and the given initial condition:\n",
        "\n",
        "$$y(0)=-\\frac{1}{3}$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        " y &= \\frac{1}{1 +c_1 e^{-x}}\\\\ \n",
        " &\\Downarrow {\\scriptstyle \\text{at } x = 0}\\\\ \n",
        " -\\frac{1}{3} &= \\frac{1}{1 +c_1} \\\\\n",
        " &\\Downarrow \\\\\n",
        " c_1 &= -4 \\\\\n",
        " &\\Downarrow \\\\ \n",
        " y &= \\frac{1}{1 -4 e^{-x}}\n",
        "\\end{aligned}$$\n",
        "\n",
        "**[-@sec-1-2]: 3.** $~y=1/(x^2 +c)$ is a one-parameter family of solutions of the first-order DE $y' +2xy^2=0$. Find a solution of the first-order IVP consisting of this differential equation and the given initial condition. Give the largest interval $I$ over which the solution is defined\n",
        "\n",
        "$$y(2)=\\frac{1}{3}$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "  y &= \\frac{1}{x^2 +c}\\\\ \n",
        "     &\\Downarrow {\\scriptstyle \\text{at } x = 2}\\\\ \n",
        "  \\frac{1}{3} &= \\frac{1}{4 +c} \\\\\n",
        "     &\\Downarrow \\\\ \n",
        "  c = -1 \\, &, \\;\\; I =(1,\\infty) \\\\\n",
        "   &\\Downarrow \\\\ \n",
        "   y &= \\frac{1}{x^2 -1} \n",
        "\\end{aligned}$$"
      ],
      "id": "6144350a"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "# | fig-cap: \"Exercises 1.2: 3\"\n",
        "import numpy as np\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "x = np.linspace(-5, 5, 200)\n",
        "y = 1.0 /(x**2 -1)\n",
        "\n",
        "threshold = 20\n",
        "y[y > threshold] = np.inf\n",
        "y[y <-threshold] = np.inf\n",
        "\n",
        "plt.plot(x,y)\n",
        "plt.scatter(2, 1/3, color='red')\n",
        "\n",
        "plt.title(r'$y=\\frac{1}{x^2 -1}$')\n",
        "plt.xlabel('$x$')\n",
        "plt.ylabel('$y$')\n",
        "plt.grid()\n",
        "\n",
        "plt.show()"
      ],
      "id": "ef9344be",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**[-@sec-1-2]: 7.** $\\,x(t)=c_1\\cos t +c_2\\sin t$ is a two-parameter family of solutions of the second-order DE $x''+x=0$. Find a solution of the second-order IVP consisting of this differential equation and the given initial conditions\n",
        "\n",
        "$$x(0)=-1, \\; x'(0)=8$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "  x(t) &= c_1\\cos t +c_2\\sin t \\\\ \n",
        "       &\\Downarrow \\;{\\scriptstyle x(0)=-1, \\; x'(0)=8}\\\\ \n",
        "    -1 &= c_1 \\\\\n",
        "     8 &= c_2 \\\\\n",
        "       &\\Downarrow \\\\\n",
        "  x(t) &= -\\cos t +8\\sin t\n",
        "\\end{aligned}$$\n",
        "\n",
        "**[-@sec-1-2]: 17.** $\\,$ Determine a region of the xy-plane for which the given differential equation would have a unique solution whose graph passes through a point $(x_0, y_0)$ in the region.\n",
        "\n",
        "$$\\frac{dy}{dx}=y^{2/3}$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "**Step 1:** $~$Identify the Function and Its Partial Derivative\n",
        "\n",
        "Let:\n",
        "\n",
        "$$f(x, y) = y^{2/3}$$\n",
        "\n",
        "Then the partial derivative with respect to $y$ is:\n",
        "\n",
        "$$\\frac{\\partial f}{\\partial y} = \\frac{2}{3} y^{-1/3}$$\n",
        "\n",
        "**Step 2:** $~$Analyze Continuity\n",
        "\n",
        "* $f(x, y) = y^{2/3}$ is continuous for all real values of $x$ and $y$\n",
        "\n",
        "* However, $\\frac{\\partial f}{\\partial y} = \\frac{2}{3} y^{-1/3}$ is undefined at $y = 0$, since $y^{-1/3}$ is not defined at $y = 0$\n",
        "\n",
        "**Step 3:** $~$Apply the Existence and Uniqueness Theorem\n",
        "\n",
        "* The Existence and Uniqueness Theorem requires both $f(x, y)$ and $\\frac{\\partial f}{\\partial y}$ to be continuous in a neighborhood of the initial point $(x_0, y_0)$\n",
        "* So, a unique solution exists through $(x_0, y_0)$ only if $y_0 \\ne 0$\n",
        "\n",
        "$~$\n",
        "\n",
        "**[-@sec-1-2]: 29.** \n",
        "\n",
        "1. By inspection, find a one-parameter family of solutions of the differential equation $xy'=y$. Verify that each member of the family is a solution of the initial value problem $xy'=y, \\,y(0)=0$\n",
        "1. Explain part 1. by determining a region $R$ in the $xy$-plane for which the differential equation $xy'=y$ would have a unique solution through a point $(x_0, y_0)$ in  $R$\n",
        "1. Verify that the piecewise-defined function\n",
        "\n",
        "   $$y= \\begin{cases}\n",
        "     0, & x < 0 \\\\ \n",
        "     x, & x \\ge 0 \n",
        "   \\end{cases}$$\n",
        "\n",
        "   satisfies the condition $y(0)=0$. Determine whether this function is also a solution of the initial-value problem in part 1\n",
        "\n",
        "**Solution**\n",
        "\n",
        "**Step 1:** $~$Solve by Inspection\n",
        "\n",
        "Let’s try separating variables or guessing solutions:\n",
        "\n",
        "Given:\n",
        "$$xy’ = y \\quad \\Rightarrow \\quad y’ = \\frac{y}{x}$$\n",
        "\n",
        "This is separable:\n",
        "\n",
        "$$\\frac{dy}{y} = \\frac{dx}{x}$$\n",
        "\n",
        "Integrate both sides:\n",
        "\n",
        "$$\\ln |y| = \\ln |x| + C_1$$\n",
        "\n",
        "Exponentiate:\n",
        "\n",
        "$$|y| = C_2|x| \\quad \\Rightarrow \\quad y = Cx$$\n",
        "\n",
        "for some constant $C \\in \\mathbb{R}$, because the sign of $C_2$ absorbs the absolute values. So the one-parameter family of solutions is:\n",
        "\n",
        "$$y = Cx$$\n",
        "\n",
        "**Step 2:** $~$Verify with the Initial Condition\n",
        "\n",
        "We are given the initial value problem:\n",
        "\n",
        "$$xy’ = y, \\quad y(0) = 0$$\n",
        "\n",
        "Let’s plug $x = 0$ into the general solution:\n",
        "\n",
        "$$y = Cx \\Rightarrow y(0) = C \\cdot 0 = 0$$\n",
        "\n",
        "So for any value of $C$, the condition $y(0) = 0$ is satisfied.\n",
        "\n",
        "❗ But Wait – What About Uniqueness?\n",
        "\n",
        "Let’s look back at the original differential equation:\n",
        "\n",
        "$$y’ = \\frac{y}{x}$$\n",
        "\n",
        "This function $f(x, y) = \\frac{y}{x}$ is not defined at $x = 0$, so the existence and uniqueness theorem does not apply at $x = 0$\n",
        "\n",
        "That means:\n",
        "\n",
        "* Infinitely many solutions of the form $y = Cx$ pass through $(0, 0)$,\n",
        "* But there is no unique solution to the initial value problem,\n",
        "* So although each $y = Cx$ satisfies both the differential equation and the initial condition, the IVP does not have a unique solution\n",
        "\n",
        "$~$\n",
        "\n",
        "**[-@sec-1-3]: 5.** $\\,$ A cup of coffee cools according to Newton's law of cooling. Use data from the graph of the temperature $T(t)$ in figure to estimate the constants $T_m$, $T_0$, and $k$ in a model of the form of the first-order initial-value problem\n",
        "\n",
        "$$ \\frac{dT}{dt}=k(T -T_m), \\;\\;T(0)=T_0 $$\n",
        "\n",
        "![](figures/ch01_exer01.png \"Newton's law of cooling\"){width=\"30%\" fig-align=\"center\"}\n",
        "\n",
        "**Solution**\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        " \\frac{dT}{dt} &=k(T -T_m), \\;\\;T(0)=T_0 \\\\ \n",
        "    &\\Downarrow \\\\ \n",
        " T(0) &= T_0 \\\\\n",
        " T(\\infty) &= T_m \\\\\n",
        " \\ln \\left( \\frac{T -T_m}{T_0 -T_m} \\right) &= k t \\\\\n",
        "    &\\Downarrow \\\\  \n",
        "    k \\text{ is the slope of the graph of }\\, & t \\text{ vs. } \\ln \\left( \\frac{T -T_m}{T_0 -T_m}\\right) \n",
        "\\end{aligned}$$\n",
        "\n",
        "**[-@sec-1-3]: 19.** After a mass $m$ is attached to a spring, it stretches $s$ units and then hangs at rest in the equilibrium position as shown in Figure (b). After the spring/mass system has been set in motion, let $x(t)$ denote the directed distance of the mass beyond the equilibrium position. As indicated in Figure (c), assume that the downward direction is positive, that the motion takes place in a vertical straight line through the center of gravitiy of the mass, and that the only forces acting on the system are the weight of the mass and the restoring force of the stretched spring. Use Hooke's law: The restoring force of a spring is proportional to its total elongation. Determine a differential equation for the displacement $x(t)$ a time $t$\n",
        "\n",
        "![](figures/ch01_exer03.png \"spring mass system\"){width=\"60%\" fig-align=\"center\"}\n",
        "\n",
        "**Solution**\n",
        "\n",
        "To model the vertical motion of a spring-mass system as described, we need to:\n",
        "\n",
        "* Use Newton’s Second Law: $~F = ma$,\n",
        "* Use Hooke’s Law: The restoring force is proportional to the total elongation of the spring,\n",
        "* Let $y(t)$ denote the displacement from equilibrium (positive downward),\n",
        "* Assume only gravity and the spring’s restoring force act\n",
        "\n",
        "**Step 1:** $~$Define the Forces\n",
        "\n",
        "Let:\n",
        "\n",
        "* $m =$ mass (kg),\n",
        "* $g =$ acceleration due to gravity (m/s²),\n",
        "* $k =$ spring constant (N/m),\n",
        "* $y(t) =$ displacement from equilibrium (m), with positive direction downward\n",
        "\n",
        "From equilibrium condition:\n",
        "\n",
        "* When the mass is at rest (before any motion), gravity is balanced by the spring force:\n",
        "\n",
        "$$mg = k \\Delta l \\quad \\text{(equilibrium stretch)}$$\n",
        "\n",
        "**Step 2:** $~$After the System is Set in Motion\n",
        "\n",
        "When displaced by $y(t)$ from equilibrium:\n",
        "\n",
        "* Weight (constant force downward): $~F_g = mg$\n",
        "* Spring force (upward restoring force): $~F_s = -k(\\Delta l + y)$\n",
        "\n",
        "But since we’re measuring $y(t)$ from equilibrium, the net restoring force becomes:\n",
        "\n",
        "$$F_{\\text{net}} = -k y(t)$$\n",
        "\n",
        "Thus, from Newton’s second law:\n",
        "\n",
        "$$m \\ddot{y}(t) = -k y(t)$$\n",
        "\n",
        "**Step 3:** $~$Final Differential Equation\n",
        "\n",
        "$$m \\ddot{y} + k y = 0$$\n",
        "\n",
        "This is a second-order linear differential equation that governs the vertical motion of the mass from equilibrium"
      ],
      "id": "c7822203"
    }
  ],
  "metadata": {
    "kernelspec": {
      "name": "python3",
      "language": "python",
      "display_name": "Python 3 (ipykernel)",
      "path": "/opt/miniconda3/share/jupyter/kernels/python3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}