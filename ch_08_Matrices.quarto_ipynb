{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "---\n",
        "jupyter: python3\n",
        "---\n",
        "\n",
        "# Matrices {#sec-8}\n",
        "\n",
        "## Prerequisites\n",
        "\n",
        "* Vector Spaces (@sec-7-6)\n",
        "* Gram-Schmidt Orthogonalization Process (@sec-7-7)\n",
        "\n",
        "## Matrix Algebra {#sec-8-1}\n",
        "\n",
        "* A **matrix** is any rectangular array of numbers or functions\n",
        "\n",
        "  $$\\begin{pmatrix}\n",
        "    a_{11} & a_{12} & \\cdots & a_{1n}\\\\ \n",
        "    a_{21} & a_{22} & \\ddots & a_{2n} \\\\ \n",
        "    \\vdots & \\ddots & \\ddots & \\vdots \\\\ \n",
        "    a_{m1} & a_{m2} & \\cdots & a_{mn}\n",
        "  \\end{pmatrix}$$ \n",
        "   \n",
        "  * The numbers or functions in the array are **entries** or **elements**\n",
        "  * An $n \\times n$ matrix  is a **square** matrix of **order $n$**\n",
        "\n",
        "* **Column** and **row vectors** are $n \\times 1$ and $1 \\times n$ matrices\n",
        "\n",
        "  $$\n",
        "  \\begin{pmatrix}\n",
        "    a_1\\\\ \n",
        "    a_2\\\\ \n",
        "    \\vdots\\\\ \n",
        "    a_n\n",
        "  \\end{pmatrix},\\;\n",
        "  \\begin{pmatrix}\n",
        "    a_1 & a_2 & \\cdots & a_n\n",
        "  \\end{pmatrix}  \n",
        "  $$\n",
        "\n",
        "* **Equality of Matrices** \n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "   \\mathbf{A} = \\left(a_{ij}\\right)_{m \\times n} \\; \\text{ and } \\;&\\mathbf{B} = \\left(b_{ij}\\right)_{m \\times n} \\;\\text{ are equal } \\\\[5pt]\n",
        "   \\text{ if } a_{ij}=b_{ij} \\;&\\text{ for each } i \\text{ and } j\n",
        "   \\end{aligned}$$\n",
        "\n",
        "* **Matrix Addition**\n",
        "\n",
        "  $$\\mathbf{A} +\\mathbf{B} = \\left(a_{ij} +b_{ij}\\right)_{m \\times n}$$\n",
        "\n",
        "* **Scalar Multiplication**\n",
        "\n",
        "  $$k\\mathbf{A} = \\left(ka_{ij}\\right)_{m \\times n}$$\n",
        "\n",
        "* **Properties of Matrix Addition and Scalar Multiplication**\n",
        "\n",
        "  Suppose $\\mathbf{A}$, $\\mathbf{B}$, and $\\mathbf{C}$ are $m \\times n$ matrices and $k_1$ and $k_2$ are scalars. Then\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    \\mathbf{A} +\\mathbf{B} &= \\mathbf{B} +\\mathbf{A} \\\\ \n",
        "    \\mathbf{A} +\\left(\\mathbf{B} +\\mathbf{C}\\right) &= \\left(\\mathbf{A} +\\mathbf{B}\\right) +\\mathbf{C} \\\\\n",
        "    \\left(k_1 k_2\\right)\\mathbf{A} &= k_1 \\left(k_2\\mathbf{A}\\right) \\\\\n",
        "    k_1\\left(\\mathbf{A} +\\mathbf{B}\\right)&=k_1\\mathbf{A} +k_1\\mathbf{B} \\\\\n",
        "    \\left(k_1 +k_2\\right)\\mathbf{A} &= k_1 \\mathbf{A} +k_2\\mathbf{A}  \n",
        "  \\end{aligned}$$\n",
        "\n",
        "* **Matrix multiplication** \n",
        "  \n",
        "  $$\\mathbf{A}\\mathbf{B}=\\left(\\sum_{k=1}^p a_{ik} b_{kj}\\right)_{m \\times n}$$\n",
        "  \n",
        "  where $\\mathbf{A}$ is an $m \\times p$ matrix, $~\\mathbf{B}$ is a $p \\times n$ matrix, and\n",
        "  $~\\mathbf{A}\\mathbf{B}$ is the $m \\times n$ matrix\n",
        "  \n",
        "  * In general, $~\\mathbf{A}\\mathbf{B}\\neq\\mathbf{B}\\mathbf{A}$\n",
        "  \n",
        "  * **Associative Law:** $~\\mathbf{A}\\left(\\mathbf{B}\\mathbf{C}\\right)=\\left(\\mathbf{A}\\mathbf{B}\\right)\\mathbf{C}$ \n",
        "  \n",
        "  * **Distributive Law:** $~\\mathbf{A}\\left(\\mathbf{B}+\\mathbf{C}\\right)=\\mathbf{A}\\mathbf{B} +\\mathbf{A}\\mathbf{C}$ \n",
        "\n",
        "* **Transpose of a Matrix**\n",
        "\n",
        "$$\\mathbf{A}^T =\n",
        "   {\\scriptsize\\begin{pmatrix}\n",
        "     a_{11} & a_{21} & \\cdots & a_{m1}\\\\ \n",
        "     a_{12} & a_{22} & \\ddots & a_{m2} \\\\ \n",
        "     \\vdots & \\ddots & \\ddots & \\vdots \\\\ \n",
        "     a_{1n} & a_{2n} & \\cdots & a_{mn}\n",
        "   \\end{pmatrix}}$$\n",
        "\n",
        "* **Properties of Transpose**\n",
        "\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "     \\left(\\mathbf{A}^T\\right)^T &= \\mathbf{A} \\\\ \n",
        "     \\left(\\mathbf{A} +\\mathbf{B}\\right)^T \n",
        "       &=\\mathbf{A}^T +\\mathbf{B}^T \\\\         \n",
        "     \\left(\\mathbf{A}\\mathbf{B}\\right)^T\n",
        "       &=\\mathbf{B}^T\\mathbf{A}^T \\\\ \n",
        "     \\left(k\\mathbf{A}\\right)^T\n",
        "      &=k\\mathbf{A}^T\n",
        "  \\end{aligned}$$\n",
        "\n",
        "* **Special Matrices**\n",
        "\n",
        "  * In a **zero matrix**, $~$all entries are zeros\n",
        "  \n",
        "  * In a **triangular matrix**, $~$all entries above or below the main diagonal are zeros (lower triangular or upper triangular)\n",
        "  \n",
        "  * In a **diagonal matrix**, $~$all entries not on the main diagonal are zeros\n",
        "\n",
        "  * A **scalar matrix** is a diagonal one where all entries on the main diagonal are equal.\n",
        "    $~$If those entries are $1$'s, it is an **identity matrix**, $\\mathbf{I}$ \n",
        "    (or $~\\mathbf{I}_n$ when there is a need to emphasize the order of the matrix)\n",
        "    \n",
        "  * An $n \\times n$ matrix $\\mathbf{A}$ is **symmetric** $~$if $\\mathbf{A}^T=\\mathbf{A}$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ \n",
        "If $~\\mathbf{A}=\n",
        "   \\begin{pmatrix}\n",
        "     \\phantom{-}2 & -3 \\\\ \n",
        "     -5 & \\phantom{-}4 \n",
        "   \\end{pmatrix}$ and \n",
        "  $~\\mathbf{B}=\n",
        "    \\begin{pmatrix}\n",
        "       -1 & 6 \\\\ \n",
        "       \\phantom{-}3 & 2 \n",
        "    \\end{pmatrix}$,\n",
        "    \n",
        "find $~$(a) $\\mathbf{AB}$, $~$(b) $\\mathbf{BA}$, $~$(c) $\\mathbf{A}^2$, $~$(d) $\\mathbf{B}^2$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Show that if $\\mathbf{A}$ is an $m\\times n$ matrix, $~$then $\\mathbf{AA}^T$ is symmetric\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ In matrix theory, $~$many of the familiar properties of the real number system are not valid. $~$If $a$ and $b$ are real numbers, then $ab=0\\;$ implies that $a=0$ or $b=0$. $~$Find two matrices such that $\\mathbf{AB}=\\mathbf{0}~$ but $\\mathbf{A}\\neq\\mathbf{0}$ and $\\mathbf{B}\\neq \\mathbf{0}$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Let $\\mathbf{A}$ and $\\mathbf{B}$ be $n\\times n$ matrices. Explain why, in general, the given formula is not valid\n",
        "\n",
        "$$(\\mathbf{A} + \\mathbf{B})^2 = \\mathbf{A}^2 + 2\\mathbf{A}\\mathbf{B} +\\mathbf{B}^2$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the resulting vector $\\mathbf{b}$ if the given vector $\\mathbf{a} = \\langle 1, 1 \\rangle$ is rotated through the indicated angle\n",
        " $\\theta=\\pi/2$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Verify that the quadratic form $ax^2 +bxy +cy^2$ is the same as\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        "      x & y \n",
        "    \\end{pmatrix}\n",
        "    \\begin{pmatrix}\n",
        "      a & \\frac{1}{2}b \\\\ \n",
        "     \\frac{1}{2}b & c \n",
        "    \\end{pmatrix}\n",
        "    \\begin{pmatrix}\n",
        "      x \\\\ y \n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Systems of Linear Algebraic Equations {#sec-8-2}\n",
        "\n",
        "* **General Form**\n",
        "\n",
        "  A system of <font color=\"red\">$m$ linear equations</font> in <font color=\"red\">$n$ unknowns</font> has the general form\n",
        "  \n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    a_{11} x_1 +a_{12} x_2 + \\cdots +a_{1n} x_n \n",
        "      & = b_1\\\\ \n",
        "    a_{21} x_1 +a_{22} x_2 + \\cdots +a_{2n} x_n \n",
        "      & = b_2\\\\ \n",
        "     &\\;\\, \\vdots \\\\ \n",
        "     a_{m1} x_1 +a_{m2} x_2 + \\cdots +a_{mn} x_n \n",
        "      & = b_m\n",
        "  \\end{aligned}$$\n",
        "\n",
        "* The **coefficients** of the unknowns can be abbreviated as $a_{ij}$. The numbers $b_1, b_2, \\cdots, b_m$ are called the **constants** of the system. \n",
        "  If all the constants are zero, the system is said to be **homogeneous**, otherwise it is **nonhomogeneous**\n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    \\mathbf{A} \n",
        "    &= \n",
        "    \\begin{pmatrix}\n",
        "      a_{11} & a_{12} & \\cdots & a_{1n} \\\\ \n",
        "      a_{21} & a_{22} & \\cdots & a_{2n} \\\\ \n",
        "      \\vdots &   & \\ddots & \\\\ \n",
        "      a_{m1} & a_{m2} & \\cdots & a_{mn} \\\\ \n",
        "    \\end{pmatrix}, \\;\\;\n",
        "    \\mathbf{x} = \n",
        "    \\begin{pmatrix}\n",
        "       x_1  \\\\ x_2 \\\\ \\vdots \\\\ x_n\n",
        "    \\end{pmatrix}, \\;\\; \n",
        "    \\mathbf{b} = \n",
        "    \\begin{pmatrix}\n",
        "       b_1 \\\\ b_2 \\\\ \\vdots \\\\ b_m\n",
        "    \\end{pmatrix}\n",
        "  \\end{aligned}$$\n",
        "\n",
        " $$\\mathbf{A} \\mathbf{x} = \\mathbf{b}$$ \n",
        "\n",
        "* A linear system of equations is said to be **consistent** if it has at least one solution and **inconsistent** if it has no solutions. If a linear system is consistent, $~$it has either\n",
        "\n",
        "  * a unique solution (that is, precisely one solution), or\n",
        "  * infinitely many solutions\n",
        "\n",
        "$~$\n",
        "\n",
        "![](figures/ch08_figure01.png \"Equal\"){width=\"80%\" fig-align=\"center\"}\n",
        "\n",
        "* **Augmented Matrix**\n",
        "\n",
        "  $$\n",
        "  \\left(\\begin{array}{cccc|c}\n",
        "    a_{11} & a_{12} & \\cdots & a_{1n} & b_1\\\\ \n",
        "    a_{21} & a_{22} & \\ddots & a_{2n} & b_2\\\\ \n",
        "    \\vdots & \\ddots & \\ddots & \\vdots & \\vdots\\\\ \n",
        "    a_{m1} & a_{m2} & \\cdots & a_{mn} & b_m\n",
        "  \\end{array}\\right)$$\n",
        "\n",
        "\n",
        "* A system can be solved with **elementary operations** (**row reduction** for matrices)\n",
        "  on an augmented matrix\n",
        "  \n",
        "| Elementary<br>Operations | Meaning |\n",
        "|:--------|:----------------------------|\n",
        "| $R_{ij}$        | Interchange rows $i$ and $j$                       |\n",
        "| $cR_{i}$        | Multiply the row $i$ by the nonzero constant $c$   | \n",
        "| $cR_{i}+R_{j}$  | Multiply the row $i$ by $c$ and add to the row $j$ |\n",
        "\n",
        "$~$\n",
        "\n",
        "* In the **Gaussian elimination**, $~$ we row-reduce the augmented matrix until we arrive \n",
        "  at a row-equivalent augmented matrix in **row-echelon form**\n",
        "  \n",
        "  * <font color='green'>The first nonzero entry in a nonzero row is a $1$</font>\n",
        "\n",
        "  * <font color='blue'>In consecutive nonzero rows, $~$the first entry $1$ in the lower row appears to the right of the $1$ in the higher row</font>\n",
        "  \n",
        "  * <font color='green'>Rows consisting of all zeros are at the bottom of the matrix</font>\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Solve\n",
        "  \n",
        "$$\\begin{pmatrix}\n",
        "    2 & 6 & \\phantom{-}1\\\\ \n",
        "    1 & 2 & -1\\\\ \n",
        "    5 & 7 & -4\n",
        "  \\end{pmatrix}\n",
        "  \\begin{pmatrix}\n",
        "    x_1\\\\ \n",
        "    x_2\\\\ \n",
        "    x_3\n",
        "  \\end{pmatrix}=\n",
        "  \\begin{pmatrix}\n",
        "    \\phantom{-}7\\\\ \n",
        "    -1\\\\ \n",
        "    \\phantom{-}9\n",
        "  \\end{pmatrix}$$\n",
        "\n",
        "$~$  \n",
        "\n",
        "Using row operations on the augmented matrix, $~$ we obtain\n",
        "  \n",
        "$${\\scriptsize\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    2 & 6 &  1 & 7\\\\ \n",
        "    1 & 2 & -1 & -1\\\\ \n",
        "    5 & 7 & -4 & 9\n",
        "  \\end{array}\\right) \n",
        "  \\overset{ R_{12}}{\\Longrightarrow}}\n",
        "  {\\scriptsize\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 2 & -1 & -1\\\\   \n",
        "    2 & 6 &  1 & 7\\\\ \n",
        "    5 & 7 & -4 & 9\n",
        "  \\end{array}\\right)\n",
        "  \\overset{\\begin{matrix} -2R_1 +R_2 \\\\ -5R_1 +R_3 \\end{matrix}}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 2 & -1 & -1\\\\   \n",
        "    0 & 2 &  3 & 9\\\\ \n",
        "    0 & -3 & 1 & 14\n",
        "  \\end{array}\\right)}$$\n",
        "  \n",
        "$${\\scriptsize\n",
        "  \\overset{\\frac{1}{2}R_2}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 2 & -1 & -1\\\\   \n",
        "    0 & 1 &  \\frac{3}{2} & \\frac{9}{2} \\\\\n",
        "    0 & -3 & 1 & 14\n",
        "  \\end{array}\\right)\n",
        "  \\overset{ 3R_2 +R_3}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 2 & -1 & -1\\\\   \n",
        "    0 & 1 &  \\frac{3}{2} & \\frac{9}{2} \\\\\n",
        "    0 & 0 & \\;\\frac{11}{2} & \\;\\frac{55}{2}\n",
        "  \\end{array}\\right)}$$\n",
        "$${\\scriptsize\\overset{\\frac{2}{11}R_3}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 2 & -1 & -1\\\\   \n",
        "    0 & 1 &  \\frac{3}{2} & \\frac{9}{2} \\\\\n",
        "    0 & 0 & 1 & 5\n",
        "  \\end{array}\\right)}$$\n",
        "\n",
        "The last matrix is in row-echelon form. $~$We can make the last matrix above to be in reduced row-echelon form\n",
        "\n",
        "$${\\scriptsize\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 2 & -1 & -1\\\\   \n",
        "    0 & 1 &  \\frac{3}{2} & \\frac{9}{2} \\\\\n",
        "    0 & 0 & 1 & 5\n",
        "  \\end{array}\\right)  \n",
        "  \\overset{ -2R_2 +R_1}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 0 & -4 & -10\\\\   \n",
        "    0 & 1 &  \\frac{3}{2} & \\frac{9}{2} \\\\\n",
        "    0 & 0 & 1 & 5\n",
        "  \\end{array}\\right)   \n",
        "  \\overset{\\begin{matrix}\n",
        "           -4R_3 +R_1 \\\\\n",
        "          -\\frac{3}{2}R_3 +R_2 \n",
        "           \\end{matrix}}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 0 & 0 & 10\\\\   \n",
        "    0 & 1 & 0 & -3 \\\\\n",
        "    0 & 0 & 1 & 5\n",
        "  \\end{array}\\right)}$$\n",
        "  \n",
        "We see that the solution is $x_1=10$, $~x_2=-3$, $~x_3=5$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Solve\n",
        "  \n",
        "$$\n",
        "  \\left(\\begin{array}{rrr}\n",
        "    1 & 3 & -2\\\\ \n",
        "    4 & 1 & 3\\\\ \n",
        "    2 & -5 & 7\n",
        "  \\end{array}\\right) \n",
        "  \\begin{pmatrix}\n",
        "    x_1\\\\ \n",
        "    x_2\\\\ \n",
        "    x_3\n",
        "  \\end{pmatrix}=\n",
        " \\left(\\begin{array}{r}\n",
        "    -7\\\\ \n",
        "     5\\\\ \n",
        "    19\n",
        "  \\end{array}\\right)$$\n",
        "\n",
        "$~$\n",
        "\n",
        "Using row operations on the augmented matrix, we obtain\n",
        "  \n",
        "$${\\scriptsize\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 3 & -2 & -7\\\\ \n",
        "    4 & 1 &  3 & 5\\\\ \n",
        "    2 & -5 & 7 & 19\n",
        "  \\end{array}\\right) \n",
        "  \\overset{\\begin{matrix}\n",
        "           -4R_1 +R_2 \\\\\n",
        "           -2R_1 +R_3 \n",
        "           \\end{matrix}}\n",
        "  {\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 3 & -2 & -7\\\\ \n",
        "    0 & -11 & 11 & 33\\\\ \n",
        "    0 & -11 & 11 & 33\n",
        "  \\end{array}\\right) \n",
        "  \\overset{\\begin{matrix}\n",
        "           -R_2 +R_3 \\\\\n",
        "           -\\frac{1}{11}R_2 \n",
        "           \\end{matrix}}\n",
        "  {\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rr|r|r}\n",
        "    1 & 3 & -2 & -7\\\\ \n",
        "    0 & 1 & -1 & -3\\\\ \\hline\n",
        "    0 & 0 & 0 & {\\color{Red}0 }\n",
        "  \\end{array}\\right)}$$\n",
        "\n",
        "In this case, $~$the last matrix implies that the original system of three equations is really equivalent to two equations\n",
        "  \n",
        "$${\n",
        "  \\overset{-3R_2 +R_1}\n",
        "  {\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rr|r|r}\n",
        "    1 & 0 & 1 & 2\\\\ \n",
        "    0 & 1 & -1 & -3\\\\ \n",
        "    \\hline\n",
        "    0 & 0 & 0 & 0\n",
        "  \\end{array}\\right)}$$\n",
        "  \n",
        "If we let $x_3=t$, $x_1=-t +2$ and $x_2=t -3$, $~$then we see that the system has infinitely many solutions\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Solve\n",
        "  \n",
        "$$\n",
        "  \\left(\\begin{array}{rr}\n",
        "    1 & 1 \\\\ \n",
        "    4 & -1 \\\\ \n",
        "    2 & -3\n",
        "  \\end{array}\\right) \n",
        "  \\begin{pmatrix}\n",
        "    x_1\\\\ \n",
        "    x_2\n",
        "  \\end{pmatrix}=\n",
        " \\left(\\begin{array}{r}\n",
        "    1\\\\ \n",
        "   -6\\\\ \n",
        "    8\n",
        "  \\end{array}\\right)$$\n",
        "\n",
        "$~$\n",
        "\n",
        "Using row operations on the augmented matrix, $~$we obtain\n",
        "  \n",
        "$${\\scriptsize\n",
        "  \\left(\\begin{array}{rr|r}\n",
        "    1 & 1 & 1\\\\ \n",
        "    4 & -1 & -6\\\\ \n",
        "    2 & -3 & 8\n",
        "  \\end{array}\\right) \n",
        "  \\overset{\\begin{matrix}\n",
        "           -4R_1 +R_2 \\\\ \n",
        "           -2R_1 +R_3 \n",
        "           \\end{matrix}}\n",
        "  {\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rr|r}\n",
        "    1 & 1 & 1\\\\ \n",
        "    0 & -5 & -10\\\\ \n",
        "    0 & -5 & 6\n",
        "  \\end{array}\\right) \n",
        "  \\overset{\\begin{matrix}\n",
        "           -R_2 +R_3 \\\\ \n",
        "           -\\frac{1}{5}R_2 \n",
        "           \\end{matrix}}\n",
        "  {\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rr|r}\n",
        "    1 & 1 & 1\\\\ \n",
        "    0 & 1 & 2\\\\ \\hline\n",
        "    0 & 0 & {\\color{Red}{16}}\n",
        "  \\end{array}\\right)}$$\n",
        "  \n",
        "The system has no solution\n",
        "\n",
        "$~$\n",
        "\n",
        "* A **homogeneous system** of linear equations is **always consistent**. The solution consisting of all zeros is called the **trivial solution**. A homogeneous system either possesses only the trivial solution or possesses the trivial solution along with infinitely many nontrivial solutions\n",
        "\n",
        "* <font color='blue'>**A homogeneous system possesses nontrivial solutions if the number $m$ of equations is less than the number $n$ of unknowns $(m<n)$**</font>\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the positive integers $x_1$, $x_2$, $x_3$, and $x_4$ so that\n",
        "\n",
        "$$x_1 \\mathrm{C_2H_6} +x_2 \\mathrm{O_2} \\rightarrow x_3 \\mathrm{CO_2} +x_4 \\mathrm{H_2O}$$\n",
        "\n",
        "Because the number of atoms of each element must be the same on each side of the last equation, $~$we have:\n",
        "\n",
        "| Atom       |                      |\n",
        "|   -------- | :------------------- |\n",
        "|$\\mathrm{C}$ |$2x_1=x_3$           |\n",
        "|$\\mathrm{H}$ |$6x_1=2x_4$          |\n",
        "|$\\mathrm{O}$ |$2x_2=2x_3 +x_4$     |\n",
        "\n",
        "$${\\scriptsize\n",
        "  \\left(\\begin{array}{rrrr|r}\n",
        "    2 & 0 & -1 &  0 & 0\\\\   \n",
        "    6 & 0 &  0 & -2 & 0\\\\\n",
        "    0 & 2 & -2 & -1 & 0\n",
        "  \\end{array}\\right)\n",
        "  \\overset{\\begin{matrix}\n",
        "             R_{12} \\\\ \n",
        "             R_{23} \n",
        "           \\end{matrix}}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrrr|r}\n",
        "    6 & 0 &  0 & -2 & 0\\\\\n",
        "    0 & 2 & -2 & -1 & 0\\\\\n",
        "    2 & 0 & -1 &  0 & 0  \n",
        "  \\end{array}\\right) \n",
        "  \\overset{\\;\\,\\text{ row } \\\\ \\text{operations}}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r|r} \n",
        "    1 & 0 & 0 & -\\frac{1}{3} & 0\\\\   \n",
        "    0 & 1 & 0 & -\\frac{7}{6} & 0\\\\\n",
        "    0 & 0 & 1 & -\\frac{2}{3} & 0\n",
        "  \\end{array}\\right)}$$\n",
        "\n",
        "Then when we let  $x_4=t$, $~x_1=\\frac{1}{3}t$, $x_2=\\frac{7}{6}t$, $x_3=\\frac{2}{3}t$. $\\,$ If we pick $t=6$, $\\,x_1=2$, $\\,x_2=7$, $\\,x_3=4$, $\\,x_4=6$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Use either Gaussian elimination or Gauss-Jordan elimination to solve the given system or show that no solution exists\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "   x_1 - x_2 &= 11\\\\ \n",
        "   4x_1 +3x_2 &=-5 \n",
        "\\end{aligned}$$\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "   9x_1 +3x_2 &= -5\\\\ \n",
        "   2x_1 +x_2 &= -1 \n",
        "\\end{aligned}$$\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "    x_1 -x_2 -x_3 &= -3\\\\ \n",
        "    2x_1 +3x_2 +5x_3 &= 7\\\\\n",
        "    x_1 -2x_2 +3x_3 &=-11 \n",
        "\\end{aligned}$$\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "    x_1 +x_2 +x_3 &= 0\\\\ \n",
        "    x_1 +x_2 +3x_3 &=0 \n",
        "\\end{aligned}$$\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "    &x_1 -x_2 -x_3 = 8\\\\ \n",
        "    &x_1 -x_2 +x_3 = 3\\\\\n",
        "    -&x_1 +x_2 +x_3 = 4 \n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Balance the given chemical equation:\n",
        "  \n",
        "$$\\mathrm{C}_5\\mathrm{H}_8 +\\mathrm{O}_2 \\rightarrow \\mathrm{CO}_2 + \\mathrm{H}_2\\mathrm{O}$$\n",
        "\n",
        "$$\\mathrm{Cu} + \\mathrm{HNO}_3 \\rightarrow \\mathrm{Cu(NO}_3\\mathrm{)}_2 + \\mathrm{H}_2\\mathrm{O} +\\mathrm{NO}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Compute the given product for an arbitrary $~3 \\times 3$ matrix $\\mathbf{A}$\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " 0 & 1 & 0\\\\ \n",
        " 1 & 0 & 0\\\\ \n",
        " 0 & 0 & 1\n",
        "\\end{pmatrix}\n",
        "\\begin{pmatrix}\n",
        " 1 & 0 & 0\\\\ \n",
        " 0 & 1 & 0\\\\ \n",
        " 0 & c & 1\n",
        "\\end{pmatrix} \\mathbf{A}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Rank of a Matrix {#sec-8-3}\n",
        "\n",
        "* The **rank** of an $m \\times n$ matrix $\\mathbf{A}$, $~\\mathrm{rank}(\\mathbf{A})$, $\\,$ is \n",
        "  **the maximum number of linearly independent row vectors**. If a matrix $\\mathbf{A}$ is now equivalent to\n",
        "  a row-echelon form $\\mathbf{B}$, $~$then\n",
        "\n",
        "  * the row space of $\\mathbf{A}$ = the row space of $\\mathbf{B}$\n",
        "  * the nonezero rows of $\\mathbf{B}$ form a basis for the row space of $\\mathbf{A}$, $~$and\n",
        "  * $\\mathrm{rank}(\\mathbf{A})$ = the number of nonzero rows in $\\mathbf{B}$\n",
        "\n",
        "* <font color='red'>**Consistency of** $~\\mathbf{A}\\mathbf{x}=\\mathbf{b}$</font>\n",
        "\n",
        "  * A linear system of equations $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$ is <font color='red'>consistent if and only if $~\\mathrm{rank}(\\mathbf{A})=\\mathrm{rank}(\\mathbf{A}|\\mathbf{b})$</font>\n",
        "\n",
        "  * Suppose a linear system $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$ with $m$ equations and $n$ unknowns is consistent.\n",
        "  $~$If <font color='blue'>$\\mathrm{rank}(\\mathbf{A})=r\\leq n$</font>, then the solution of the system contains <font color='blue'>$n -r$ parameters</font>. This means that we have the <font color='blue'>unique solution when $r=n$</font>\n",
        "\n",
        "$${\\scriptsize\n",
        "  \\left(\\begin{array}{cccc|c}\n",
        "    a_{11} & a_{12} & \\cdots & a_{1n} & b_1\\\\ \n",
        "    a_{21} & a_{22} & \\ddots & a_{2n} & b_2\\\\ \n",
        "    \\vdots & \\ddots & \\ddots & \\vdots & \\vdots\\\\ \n",
        "    a_{m1} & a_{m2} & \\cdots & a_{mn} & b_m\n",
        "  \\end{array}\\right)\n",
        "  \\overset{\\text{row operations}}{\\Longrightarrow}} \\\\ \n",
        "  {\\scriptsize\n",
        "  \\left(\\begin{array}{cccc|ccc|c}\n",
        "    1      & a_{12}' & \\cdots & a_{1{\\color{red}r}}'& a_{1r+1}' & \\cdots   & a_{1n}' & b_1' \\\\ \n",
        "    0      & 1       & \\ddots & \\vdots & a_{2r+1}' & \\ddots   & a_{2n}' & b_2' \\\\\n",
        "    \\vdots & \\ddots  & \\ddots & \\vdots & \\vdots    & \\ddots   & \\vdots  & \\vdots \\\\    \n",
        "    0      & \\cdots  & 0      & 1      & a_{{\\color{red}r}r+1}' & \\cdots   & a_{rn}' & b_r' \\\\ \\hline     \n",
        "    0      & 0       & 0      & 0      & 0         & 0        & 0       & {\\color{red} 0} \\\\\n",
        "    \\vdots & \\vdots  & \\vdots & \\vdots & \\vdots    & \\vdots   & \\vdots  & {\\color{red} \\vdots} \\\\    \n",
        "    0      & 0       & 0      & 0      & 0         & 0        & 0       & {\\color{red} 0}    \n",
        "  \\end{array}\\right)}$$\n",
        "\n",
        "![](figures/ch08_figure02.png \"Equal\"){width=\"60%\" fig-align=\"center\"}\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the rank of the given matrix\n",
        "\n",
        "$${\\scriptsize\\begin{pmatrix}\n",
        "     \\phantom{-}2 & \\phantom{-}1 & \\phantom{-}3 \\\\ \n",
        "     \\phantom{-}6 & \\phantom{-}3 & \\phantom{-}9 \\\\ \n",
        "     -1 & -\\frac{1}{2} & -\\frac{3}{2} \n",
        "    \\end{pmatrix}}$$\n",
        "\n",
        "$${\\scriptsize\\begin{pmatrix}\n",
        "     1 & 1 & 1\\\\ \n",
        "     1 & 0 & 4\\\\ \n",
        "     1 & 4 & 1\n",
        "   \\end{pmatrix}}$$\n",
        "\n",
        "$${\\scriptsize\\begin{pmatrix}\n",
        "    0 & 2 & 4 & 2 & 2\\\\ \n",
        "    4 & 1 & 0 & 5 & 1\\\\ \n",
        "    2 & 1 & \\frac{2}{3} & 3 & \\frac{1}{3} \\\\ \n",
        "    6 & 6 & 6 & 12 & 0 \n",
        "   \\end{pmatrix}}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Determine whether the given set of vectors is linearly dependent or linearly independent\n",
        "\n",
        "$$\\mathbf{u}_1 = \\langle 1, 2, 3 \\rangle, \\;\\mathbf{u}_2 = \\langle 1, 0, 1 \\rangle, \\; \\mathbf{u}_3 = \\langle 1, -1, 5 \\rangle$$\n",
        "\n",
        "$$\\mathbf{u}_1 = \\langle 1, -1, 3, -1 \\rangle, \\;\\mathbf{u}_2 = \\langle 1, -1, 4, 2 \\rangle, \\; \\mathbf{u}_3 = \\langle 1, -1, 5, 7 \\rangle$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Suppose the system $\\mathbf{Ax}=\\mathbf{b}~$ is consistent and $~\\mathbf{A}$ is a $5\\times 8~$ matrix and $~\\mathrm{rank}\\,\\mathbf{A}=3.$ $~$How many parameters does the solution of the system have?\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Let $\\mathbf{A}$ be a nonzero $4 \\times 6~$ matrix\n",
        "\n",
        "| **1.** $~$ What is the maximum rank that $~\\mathbf{A}$ can have?\n",
        "\n",
        "$~$ \n",
        "\n",
        "| **2.** $~$ If $\\mathrm{rank}(\\mathbf{A}|\\mathbf{b})=2$, $~$then for what value(s) of $\\mathrm{rank}(\\mathbf{A})$ is the system $~\\mathbf{Ax}=\\mathbf{b}$, $~\\mathbf{b}\\neq \\mathbf{0}$, inconsistent? Consistent?\n",
        "\n",
        "$~$\n",
        "\n",
        "| **3.** $~$ If $\\mathrm{rank}(\\mathbf{A})=3$, $~$then how many parameters does the solution of the system $~\\mathbf{Ax}=\\mathbf{0}~$ have?\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Let $\\mathbf{v}_1$, $\\mathbf{v}_2$, and $~\\mathbf{v}_3~$ be the first, second, and third column vectors, respectively, of the matrix\n",
        "\n",
        "$$\\mathbf{A} = \n",
        "\\begin{pmatrix}\n",
        " \\phantom{-}2 & 1 & 7\\\\ \n",
        " \\phantom{-}1 & 0 & 2\\\\ \n",
        " -1 & 5 & 13 \n",
        "\\end{pmatrix}$$\n",
        "\n",
        "  What can we conclude about $\\mathrm{rank} (\\mathbf{A})$ from the observation $2\\mathbf{v}_1 +3\\mathbf{v}_2 -\\mathbf{v}_3=\\mathbf{0}$?\n",
        "\n",
        "$~$\n",
        "\n",
        "## Determinants {#sec-8-4}\n",
        "\n",
        "* **Determinant of a $2 \\times 2$ Matrix**\n",
        "\n",
        "$$\\mathrm{det}(\\mathbf{A})={\\scriptsize\n",
        "   \\begin{vmatrix}\n",
        "     a_{11} & a_{12}\\\\ \n",
        "     a_{21} & a_{22}\n",
        "   \\end{vmatrix}=a_{11}a_{22}-a_{12}a_{21}}$$\n",
        "\n",
        "* **Determinant of a $3 \\times 3$ Matrix**\n",
        "\n",
        "$$\n",
        "   \\mathrm{det}(\\mathbf{A})={\\scriptsize\n",
        "   \\begin{vmatrix}\n",
        "     a_{11} & a_{12} & a_{13}\\\\ \n",
        "     a_{21} & a_{22} & a_{23}\\\\\n",
        "     a_{31} & a_{32} & a_{33}\n",
        "   \\end{vmatrix}}\\\\{\\scriptsize=\n",
        "   a_{11}(-1)^{1+1} \n",
        "   \\begin{vmatrix}\n",
        "     a_{22} & a_{23}\\\\ \n",
        "     a_{32} & a_{33}\n",
        "   \\end{vmatrix} +\n",
        "   a_{12}(-1)^{1+2} \n",
        "   \\begin{vmatrix}\n",
        "     a_{21} & a_{23}\\\\ \n",
        "     a_{31} & a_{33}\n",
        "   \\end{vmatrix} +\n",
        "   a_{13}(-1)^{1+3} \n",
        "   \\begin{vmatrix}\n",
        "     a_{21} & a_{22}\\\\ \n",
        "     a_{31} & a_{32}\n",
        "   \\end{vmatrix}}$$\n",
        "\n",
        "* **Determinant of a $n\\times n$ Matrix**\n",
        "\n",
        "  $$\\mathrm{det}\\,\\mathbf{A} = \\sum (-1)^h a_{1l_1} a_{2l_2} \\cdots a_{nl_n}$$\n",
        "\n",
        "  where the summation is over all permutations $l_1,$ $l_2,$ $\\cdots,$ $l_n$ of $1,$ $2,$ $\\cdots,$ $n$ and the sign accords with the parity of the permutation\n",
        "\n",
        "* **Cofactor and Minor**\n",
        "\n",
        "  The **cofactor of $\\,a_{ij}$** is the determinant\n",
        "  \n",
        "  $$C_{ij}=(-1)^{i +j} M_{ij}$$\n",
        "  \n",
        "  where $M_{ij}$ is the determinant of the submatrix obtained by deleting the $i$-th row and the $j$-th column of $\\mathbf{A}$. The determinant $M_{ij}$ is called a **minor determinant**\n",
        "\n",
        "* **Cofactor Expansion of a Determinant: Laplace Development**\n",
        "\n",
        "   Let $\\mathbf{A}=\\left(a_{ij}\\right)_{n \\times n}$ be an $n \\times n$ matrix. $~$For each $1 \\leq i \\leq n$, \n",
        "  $~$ **the cofactor expansion of $\\mathrm{det}(\\mathbf{A})$ along the $i$-th row** is\n",
        "  \n",
        "  $${\\mathrm{det}(\\mathbf{A})=\\sum_{k=1}^na_{ik}C_{ik}}$$\n",
        "\n",
        "   For each $1 \\leq j \\leq n$, $~$**the cofactor expansion of $\\mathrm{det}(\\mathbf{A})$ along the $j$-th column** is\n",
        "  \n",
        "   $${\\mathrm{det}(\\mathbf{A})=\\sum_{k=1}^na_{kj}C_{kj}}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Suppose\n",
        "\n",
        "$$\\mathbf{A} = \\begin{pmatrix}\n",
        "    \\phantom{-}2 & \\phantom{-}3 & 4\\\\ \n",
        "    \\phantom{-}1 & -1 & 2\\\\ \n",
        "     -2 & \\phantom{-}3 & 5 \n",
        "   \\end{pmatrix}$$\n",
        "   \n",
        "   Evaluate the indicated minor determinant or cofactor\n",
        "   \n",
        "| **1.** $~M_{12}~$ **2.** $~M_{32}~$ **3.** $~C_{13}~$ **4.** $~C_{22}$\n",
        "   \n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Evaluate the determinant of the matrix\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " \\phantom{-}3 & 5 \\\\ \n",
        " -1 & 4 \n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " 1 - \\lambda & 3 \\\\ \n",
        " 2 & 2 - \\lambda \n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Evaluate the determinant of the given matrix by cofactor expansion\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " -2 & -1 & 4\\\\ \n",
        " -3 & \\phantom{-}6 & 1\\\\ \n",
        " -3 & \\phantom{-}4 & 8\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " 1 & 1 & 1\\\\ \n",
        " x & y & z\\\\ \n",
        " 2 & 3 & 4\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Properties of Determinants {#sec-8-5}\n",
        "\n",
        "* If $\\mathbf{A}^T$ is the transpose of the $n \\times n$ matrix $\\mathbf{A}$, \n",
        "  $~$then <font color='blue'>$\\mathrm{det}(\\mathbf{A}^T)=\\mathrm{det}(\\mathbf{A})$</font>\n",
        "  \n",
        "  $${\\scriptsize\\begin{vmatrix}\n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   a_{21} & a_{22} & a_{23}\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{vmatrix} =\n",
        "  \\begin{vmatrix}\n",
        "   a_{11} & a_{21} & a_{31}\\\\ \n",
        "   a_{12} & a_{22} & a_{32}\\\\ \n",
        "   a_{13} & a_{23} & a_{33}\n",
        "  \\end{vmatrix}}$$\n",
        " \n",
        "* <font color='blue'>If any two rows (columns) of an $n \\times n$ matrix $\\mathbf{A}$ are the same, $~$then $\\mathrm{det}(\\mathbf{A})=0$</font>\n",
        "\n",
        "  $${\\scriptsize\\begin{vmatrix}\n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{vmatrix} = 0}$$\n",
        "\n",
        "* <font color='blue'>If all the entries in a row (column) of an $n \\times n$ matrix $\\mathbf{A}$ are zero, $~$then $\\mathrm{det}(\\mathbf{A})=0$</font>\n",
        "\n",
        "  $${\\scriptsize\\begin{vmatrix}\n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   0 & 0 & 0\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{vmatrix} = 0}$$\n",
        "\n",
        "* <font color='green'>If $\\mathbf{B}$ is the matrix obtained by interchanging any two rows (columns) of an $n \\times n$ matrix $\\mathbf{A}$, $~$then $\\mathrm{det}(\\mathbf{B})=-\\mathrm{det}(\\mathbf{A})$</font>\n",
        "\n",
        "  $${\\scriptsize\\begin{vmatrix}\n",
        "   a_{21} & a_{22} & a_{23}\\\\ \n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{vmatrix} = -\n",
        "  \\begin{vmatrix}\n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   a_{21} & a_{22} & a_{23}\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{vmatrix}}$$\n",
        "\n",
        "* <font color='green'>If $\\mathbf{B}$ is the matrix obtained by multiplying a row (column) by a nonzero real number $k$,\n",
        "  $~$ then $\\mathrm{det}(\\mathbf{B})=k\\,\\mathrm{det}(\\mathbf{A})$</font>\n",
        "  \n",
        "  $${\\scriptsize\\begin{vmatrix}\n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   ka_{21} & ka_{22} & ka_{23}\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{vmatrix} = k\n",
        "  \\begin{vmatrix}\n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   a_{21} & a_{22} & a_{23}\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{vmatrix}}$$\n",
        "\n",
        "* <font color='blue'>If $\\mathbf{A}$ and $\\mathbf{B}$ are both $n \\times n$ matrices, $~$then $\\mathrm{det}(\\mathbf{AB})=\\mathrm{det}(\\mathbf{A})\\cdot \\mathrm{det}(\\mathbf{B})$</font>\n",
        "  \n",
        "  $${\\scriptsize\\begin{vmatrix} \n",
        "  \\begin{pmatrix}\n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   a_{21} & a_{22} & a_{23}\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{pmatrix}\n",
        "  \\begin{pmatrix}\n",
        "   b_{11} & b_{12} & b_{13}\\\\ \n",
        "   b_{21} & b_{22} & b_{23}\\\\ \n",
        "   b_{31} & b_{32} & b_{33}\n",
        "  \\end{pmatrix}\n",
        "  \\end{vmatrix}\n",
        "  =\n",
        "  \\begin{vmatrix}\n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   a_{21} & a_{22} & a_{23}\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{vmatrix}\n",
        "  \\begin{vmatrix}\n",
        "   b_{11} & b_{12} & b_{13}\\\\ \n",
        "   b_{21} & b_{22} & b_{23}\\\\ \n",
        "   b_{31} & b_{32} & b_{33}\n",
        "  \\end{vmatrix}}$$\n",
        "\n",
        "* <font color='blue'>Suppose $\\mathbf{B}$ is the matrix obtained from an $n \\times n$ matrix $\\mathbf{A}$ by multiplying  a row(column) by a nonzero $k$ and adding the result to another row(column). $~$ Then $\\mathrm{det}(\\mathbf{B})=\\mathrm{det}(\\mathbf{A})$</font>\n",
        "  \n",
        "  $${\\scriptsize\\begin{vmatrix} \n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   a_{21} & a_{22} & a_{23}\\\\ \n",
        "   ka_{21} +a_{31} & ka_{22}+a_{32} & ka_{23} +a_{33}\n",
        "  \\end{vmatrix}\n",
        "  =\n",
        "  \\begin{vmatrix}\n",
        "   a_{11} & a_{12} & a_{13}\\\\ \n",
        "   a_{21} & a_{22} & a_{23}\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{vmatrix}}$$\n",
        "\n",
        "* If $\\mathbf{A}$ is an $n \\times n$ triangular matrix, $~$then $\\mathrm{det}(\\mathbf{A})=a_{11} a_{22}\\cdots a_{nn}$\n",
        "\n",
        "  $${\\scriptsize\\begin{vmatrix}\n",
        "   a_{11} & 0 & 0\\\\ \n",
        "   a_{21} & a_{22} & 0\\\\ \n",
        "   a_{31} & a_{32} & a_{33}\n",
        "  \\end{vmatrix} = a_{11} a_{22} a_{33}}$$\n",
        "\n",
        "**Alien Cofactors**\n",
        "\n",
        "* Suppose $\\mathbf{A}$ is an $n \\times n$ matrix. If $a_{i1}, a_{i2}, \\cdots, a_{in}$ are the entries\n",
        "in the $i$-th row and $C_{p1}, C_{p2}, \\cdots, C_{pn}\\,$ are the cofactors of the entries in the $p$-th row, $~$then\n",
        "\n",
        "  $$\\sum_{k=1}^n a_{ik}C_{pk}=0\\;\\;\\text{for}\\; i \\neq p$$\n",
        "\n",
        "* If $a_{1j}, a_{2j}, \\cdots, a_{nj}$ are the entries\n",
        "in the $j$-th column and $C_{1p},$ $C_{2p},$ $\\cdots,$ $C_{np}$ are the cofactors of the entries in the $p$-th column, $~$then\n",
        "\n",
        "  $$\\sum_{k=1}^n a_{kj}C_{kp}=0\\;\\;\\text{for}\\; j \\neq p$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ State the appropriate theorem(s) in this section that justifies the given equality\n",
        "  \n",
        "$$\\begin{vmatrix}\n",
        " 1 & 2\\\\ \n",
        " 3 & 4\n",
        "\\end{vmatrix} = -\n",
        "\\begin{vmatrix}\n",
        " 3 & 4\\\\\n",
        " 1 & 2 \n",
        "\\end{vmatrix}$$\n",
        "\n",
        "$$\\begin{vmatrix}\n",
        " -5 & \\phantom{-}6\\\\ \n",
        " \\phantom{-}2 & -8\n",
        "\\end{vmatrix} =\n",
        "\\begin{vmatrix}\n",
        " \\phantom{-}1 & \\phantom{-}6\\\\\n",
        " -6 & -8 \n",
        "\\end{vmatrix}$$\n",
        "\n",
        "$${\\begin{vmatrix}\n",
        " 1 & 2 & \\phantom{--}3\\\\ \n",
        " 4 & 2 & \\phantom{-}18\\\\\n",
        " 5 & 9 & -12\n",
        "\\end{vmatrix} = 6\n",
        "\\begin{vmatrix}\n",
        " 1 & 2 & \\phantom{-}1\\\\ \n",
        " 2 & 1 & \\phantom{-}3\\\\\n",
        " 5 & 9 & -4\n",
        "\\end{vmatrix}}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Evaluate the determinant of the given matrix using the result\n",
        "\n",
        "$$\\begin{vmatrix}\n",
        " a_1 & a_2 & a_3\\\\ \n",
        " b_1 & b_2 & b_3\\\\\n",
        " c_1 & c_2 & c_3\n",
        "\\end{vmatrix} = 5$$\n",
        "\n",
        "**1.** $~$ ${\\scriptsize \\mathbf{A} =\n",
        "\\begin{pmatrix}\n",
        " a_3 & a_2 & a_1\\\\ \n",
        " b_3 & b_2 & b_1\\\\ \n",
        " c_3 & c_2 & c_1\n",
        "\\end{pmatrix}}$\n",
        "  \n",
        "**2.** $~$ ${\\scriptsize\\mathbf{A} =\n",
        "\\begin{pmatrix}\n",
        " 2a_1 & a_2 & a_3\\\\ \n",
        " 6b_1 & 3b_2 & 3b_3\\\\ \n",
        " 2c_1 & c_2 & c_3\n",
        "\\end{pmatrix}}$\n",
        "\n",
        "**3.** $~$ ${\\scriptsize\\mathbf{A} =\n",
        "\\begin{pmatrix}\n",
        " 4a_1 -2a_3 & a_2 & a_3\\\\ \n",
        " 4b_1 -2b_3 & b_2 & b_3\\\\ \n",
        " 2c_1 -c_3 & \\frac{1}{2}c_2 & \\frac{1}{2}c_3\n",
        "\\end{pmatrix}}$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Consider the matrix\n",
        "\n",
        "$${\\mathbf{A} =\n",
        "\\begin{pmatrix}\n",
        " 1 & 1 & 1\\\\ \n",
        " x & y & z\\\\ \n",
        " y+z & x+z & x+y\n",
        "\\end{pmatrix}}$$\n",
        "\n",
        "Without expanding, $~$show that $\\mathrm{det}\\, \\mathbf{A}=0$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Evaluate \n",
        "\n",
        "$${\\begin{vmatrix}\n",
        " 1 & 1 & 1 & 1\\\\ \n",
        " a & b & c & d\\\\ \n",
        " a^2 & b^2 & c^2 & d^2\\\\ \n",
        " a^3 & b^3 & c^3 & d^3\n",
        "\\end{vmatrix}}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "## Inverse of a Matrix {#sec-8-6}\n",
        "\n",
        "* If $\\mathbf{A}$ is an $n \\times n$ matrix and there exists an $n \\times n$ matrix $\\mathbf{B}$ such that\n",
        "\n",
        "  $$\\mathbf{A}\\mathbf{B}=\\mathbf{B}\\mathbf{A}=\\mathbf{I}$$\n",
        "  \n",
        "  then $\\mathbf{A}$ is said to be **nonsingular** or **invertible** and $\\mathbf{B}$ \n",
        "  is the **inverse** of $\\mathbf{A}$\n",
        "\n",
        "* An $n \\times n$ matrix that has no inverse is called **singular**. If $\\mathbf{A}$ is nonsingular, \n",
        "  $~$its inverse is denoted by $\\mathbf{B}=\\mathbf{A}^{-1}$\n",
        "\n",
        "* **Properties of the Inverse**\n",
        "\n",
        "  Let $\\mathbf{A}$ and $\\mathbf{B}~$ be nonsingular matrices. Then\n",
        "  \n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    \\left(\\mathbf{A}^{-1}\\right)^{-1}&=\\mathbf{A} \\\\\n",
        "    \\left(\\mathbf{A}\\mathbf{B}\\right)^{-1}&=\\mathbf{B}^{-1}\\mathbf{A}^{-1} \\\\\n",
        "    \\left(\\mathbf{A}^T\\right)^{-1}&=\\left(\\mathbf{A}^{-1}\\right)^T\n",
        "  \\end{aligned}$$\n",
        "\n",
        "* **Adjoint Matrix**\n",
        "\n",
        "  $$\\mathrm{adj}(\\mathbf{A})=\n",
        "   \\begin{pmatrix}\n",
        "     C_{11} & C_{12} & \\cdots & C_{1n}\\\\ \n",
        "     C_{21} & C_{22} & \\cdots & C_{2n}\\\\ \n",
        "     \\vdots &        &        & \\vdots\\\\ \n",
        "     C_{n1} & C_{n2} & \\cdots & C_{nn}\n",
        "   \\end{pmatrix}^T$$\n",
        "\n",
        "* **Finding the Inverse**\n",
        "  \n",
        "  Let $\\mathbf{A}$ be an $n \\times n$ matrix. $~$If $\\mathrm{det}(\\mathbf{A})\\neq 0$ (**nonsingular**), then\n",
        "  \n",
        "  $$\\mathbf{A}^{-1}=\\frac{\\mathrm{adj}(\\mathbf{A})}{\\mathrm{det}(\\mathbf{A})}$$\n",
        "\n",
        "  or\n",
        "\n",
        "  ![](figures/ch08_figure03.png \"Inverse\"){width=\"50%\" fig-align=\"center\"}\n",
        "\n",
        "* **Using the Inverse to Solve Systems**\n",
        "\n",
        "  The coefficient matrix $\\mathbf{A}$ is $n \\times n$. In particular, $~$if $\\mathbf{A}$ is nonsingular,\n",
        "  $~$the system $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$ can be solved by\n",
        "  \n",
        "  $$\\mathbf{x}=\\mathbf{A}^{-1}\\mathbf{b}$$\n",
        "  \n",
        "  A homogeneous system of $n$ linear equations in $~n$ unknowns <font color='blue'>$\\mathbf{A}\\mathbf{x}=\\mathbf{0}$</font> $~$has\n",
        "  \n",
        "  * only the trivial solution if and only if $\\mathbf{A}$ is nonsingular\n",
        "  \n",
        "  * <font color='blue'>a nontrivial solution if and only if $\\mathbf{A}$ is singular</font>\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Verify that the matrix $\\mathbf{B}$ is the inverse of the matrix $\\mathbf{A}$\n",
        "\n",
        "$$\\mathbf{A}=\\begin{pmatrix}\n",
        " 1 & \\frac{1}{2} \\\\ \n",
        " 2 & \\frac{3}{2}\n",
        "\\end{pmatrix}, \\;\\;\n",
        "\\mathbf{B}=\\begin{pmatrix}\n",
        " \\phantom{-}3 & -1 \\\\ \n",
        " -4 & \\phantom{-}2\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Determine whether the given matrix is singular or nonsingular. $\\,$If it is nonsingular, find the inverse using $\\mathbf{A}^{-1}=\\frac{\\mathrm{adj}\\,\\mathbf{A}}{\\mathrm{det}\\,\\mathbf{A}}$\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " 3&  0& \\phantom{-}0\\\\ \n",
        " 0&  6& \\phantom{-}0\\\\ \n",
        " 0&  0& -2 \n",
        "\\end{pmatrix}, \\;\\;\\;\n",
        "\\begin{pmatrix}\n",
        " 0 & -1 & \\phantom{-}1 & 4\\\\ \n",
        " 3 & \\phantom{-}2 & -2 & 1\\\\ \n",
        " 0 & \\phantom{-}4 & \\phantom{-}0 & 1\\\\ \n",
        " 1 & \\phantom{-}0 & -1 & 1 \n",
        "\\end{pmatrix}, \\;\\;\\;\n",
        "\\begin{pmatrix}\n",
        " 1 & \\phantom{-}0 & 0 & 0\\\\ \n",
        " 0 & \\phantom{-}1 & 0 & 0\\\\ \n",
        " 0 & -2 & 1 & 0\\\\ \n",
        " 0 & -3 & 0 & 1\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the inverse of the given matrix or show that no inverse exists\n",
        "  \n",
        "$$\\begin{pmatrix}\n",
        " 1 & 2 & 3\\\\ \n",
        " 4 & 5 & 6\\\\ \n",
        " 7 & 8 & 9 \n",
        "\\end{pmatrix},\\;\\;\n",
        "\\begin{pmatrix}\n",
        " \\phantom{-}4 & \\phantom{-}2 & 3 \\\\ \n",
        " \\phantom{-}2 & \\phantom{-}1 & 0\\\\ \n",
        " -1 & -2 & 0\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ If $\\mathbf{A}$ is nonsingular, then $\\left( \\mathbf{A}^T\\right)^{-1}=\\left( \\mathbf{A}^{-1}\\right)^T$, $~$verify this for\n",
        "  \n",
        "$$\\mathbf{A}=\\begin{pmatrix}\n",
        " 1 & 4\\\\ \n",
        " 2 & 10 \n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the inverse of the rotation matrix \n",
        "\n",
        "$$\\mathbf{M}=\\begin{pmatrix}\n",
        " \\cos\\theta & -\\sin\\theta\\\\ \n",
        " \\sin\\theta & \\phantom{-}\\cos\\theta \n",
        "\\end{pmatrix}$$\n",
        "  \n",
        "What does $\\mathbf{A}=\\mathbf{M}^{-1}\\mathbf{B}$ represents?\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ A nonsingular matrix $\\mathbf{A}$ is said to be **orthogonal** if $\\mathbf{A}^{-1}=\\mathbf{A}^T$ \n",
        "\n",
        "**1.** $~$ Verify tha the rotation matrix is orthogonal\n",
        "  \n",
        "**2.** $~$ Verify that \n",
        "$${\\scriptsize\\mathbf{A}=\\frac{1}{\\sqrt{6}}\\begin{pmatrix}\n",
        " \\sqrt{2} & \\phantom{-}0 & -2 \\\\ \n",
        " \\sqrt{2} & \\phantom{-}\\sqrt{3} & \\phantom{-}1\\\\ \n",
        " \\sqrt{2} &  -\\sqrt{3} & \\phantom{-}1\n",
        "\\end{pmatrix}}~$$ is an orthogonal matrix\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Answer the questions based on the supposition\n",
        "\n",
        "* Show that if $\\mathbf{A}$ is an orthogonal matrix, $~$then $\\mathrm{det}\\,\\mathbf{A}=\\pm 1$\n",
        "\n",
        "* Suppose $\\mathbf{A}$ and $\\mathbf{B}~$ are nonsingular $~n\\times n$ matrices. Then show that $\\mathbf{AB}~$ is nonsingular\n",
        "\n",
        "* Suppose $\\mathbf{A}$ and $\\mathbf{B}~$ are $~n\\times n$ matrices and that either $\\mathbf{A}$ or $\\mathbf{B}~$ is singular. $~$Then show that $\\mathbf{AB}~$ is singular\n",
        "\n",
        "* Suppose $\\mathbf{A}~$ is a nonsingular matrix. $~$Then show that $\\displaystyle\\mathrm{det}\\,\\mathbf{A}^{-1}=\\frac{1}{\\mathrm{det}\\,\\mathbf{A}}$\n",
        "\n",
        "* Suppose $\\mathbf{A}^2=\\mathbf{A}$. $~$Then show that either $\\mathbf{A}=\\mathbf{I}~$ or $~\\mathbf{A}~$ is singular \n",
        "\n",
        "* Suppose $\\mathbf{A}$ and $\\mathbf{B}~$ are $~n\\times n$ matrices. $~\\mathbf{A}~$ is nonsingular, $~$ and \n",
        "$\\mathbf{AB}=\\mathbf{0}$. $~$Then show that $\\mathbf{B}=\\mathbf{0}$\n",
        "\n",
        "* Suppose $\\mathbf{A}$ and $\\mathbf{B}~$ are $~n\\times n$ matrices. $~\\mathbf{A}~$ is nonsingular, $~$ and $\\mathbf{AB}=\\mathbf{AC}$. $~$Then show that $\\mathbf{B}=\\mathbf{C}$\n",
        "\n",
        "* Suppose $\\mathbf{A}$ and $\\mathbf{B}~$ are nonsingular $~n\\times n$ matrices. Is $~\\mathbf{A} +\\mathbf{B}~$ necessarily nonsingular?\n",
        "\n",
        "* Suppose $\\mathbf{A}~$ is a nonsingular matrix. $~$Then show that $\\mathbf{A}^T~$ is nonsingular\n",
        "\n",
        "* Suppose $\\mathbf{A}$ and $\\mathbf{B}~$ are $~n\\times n~$ nonzero matrices and $\\mathbf{AB}=\\mathbf{0}$. $~$Then show that both $\\mathbf{A}~$ and $~\\mathbf{B~}$ are singular\n",
        "\n",
        "\n",
        "## Cramer's Rule {#sec-8-7}\n",
        "\n",
        "If $\\mathrm{det}(\\mathbf{A}) \\neq 0$, $~$the solution of the system is given by\n",
        "\n",
        "$$x_k=\\frac{\\mathrm{det}(\\mathbf{A}_k)}{\\mathrm{det}(\\mathbf{A})}, \\;\\;{\\scriptsize k=1, 2, \\cdots, n}$$\n",
        "  \n",
        "where\n",
        "\n",
        "$${\\scriptsize\\mathbf{A}_k=\n",
        "  \\begin{pmatrix}\n",
        "    a_{11} & \\cdots & a_{1k-1} & {\\color{red} {b_1}}    & a_{1k+1} & \\cdots & a_{1n}\\\\ \n",
        "    a_{21} & \\cdots & a_{2k-1} & {\\color{red} {b_2}}    & a_{2k+1} & \\cdots & a_{2n} \\\\ \n",
        "    \\vdots &        & \\vdots   & {\\color{red} {\\vdots}} & \\vdots   &        & \\vdots\\\\ \n",
        "    a_{n1} & \\cdots & a_{nk-1} & {\\color{red} {b_n}}    & a_{nk+1} & \\cdots & a_{nn}\n",
        "  \\end{pmatrix}}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Solve the given system of equations by Cramer's rule\n",
        "\n",
        "$$\n",
        "  \\begin{aligned}\n",
        "   -3x_1 + x_2 &= 3 \\\\ \n",
        "    2x_1 -4x_2 &= -6 \\\\ \\\\\n",
        "    0.1x_1 -0.4x_2 &= 0.13 \\\\ \n",
        "    x_1 -x_2 &= 0.4 \\\\ \\\\\n",
        "    2x + y &=1\\\\\n",
        "    3x +2y &=-2\n",
        "  \\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Consider the system\n",
        "\n",
        "$$\n",
        "  \\begin{aligned}\n",
        "    x_1 + x_2 &= 1 \\\\ \n",
        "    x_1 +\\epsilon x_2 &= 2 \n",
        "  \\end{aligned}$$\n",
        "\n",
        "When $\\epsilon$ is close to $1$, $~$the lines that make up the system are almost parallel\n",
        "  \n",
        "**1.** Use Cramer's rule to show that a solution of the system is\n",
        "  \n",
        "  $${\\scriptsize x_1 = 1 -\\frac{1}{\\epsilon -1}, \\;\\;x_2 = \\frac{1}{\\epsilon - 1}}$$\n",
        "  \n",
        "**2.** The system is said to be ill-conditioned since small changes in the input data(for example, the coefficients) causes a significant or large change in the output or solution. $~$Verify this by finding the solution of the system for $\\epsilon=1.01$ and then for $\\epsilon=0.99$\n",
        "\n",
        "$~$\n",
        "\n",
        "## The Eigenvalue Problem {#sec-8-8}\n",
        "\n",
        "* Let $\\mathbf{A}$ be an $n \\times n~$ matrix. $~$A number $\\lambda$ is said to be an **eigenvalue** of \n",
        "  $\\mathbf{A}$ if there exists a nonzero solution vector $\\mathbf{k}$ of the linear system\n",
        "\n",
        "  $$\\mathbf{A}\\mathbf{k}=\\lambda\\mathbf{k}$$\n",
        "\n",
        "  and the solution vector $\\mathbf{k}$ is said to be an **eigenvector** corresponding to the eigenvalue $\\lambda$\n",
        "  \n",
        "* The problem of solving $~\\mathbf{A}\\mathbf{k}=\\lambda\\mathbf{k}~$ for nonzero vectors $\\mathbf{k}$ is\n",
        "  called to be the **eigenvalue problem** for $\\mathbf{A}$\n",
        "\n",
        "* We must solve the **characteristic equation** \n",
        "  $~\\mathrm{det}(\\mathbf{A} -\\lambda\\mathbf{I})=0~$ to find an eigenvalue $\\lambda$\n",
        "  \n",
        "* To find an eigenvector $\\mathbf{k}$ corresponding to an eigenvalue $\\lambda$, $~$we solve $~(\\mathbf{A} -\\lambda\\mathbf{I})\\mathbf{k}=\\mathbf{0}~$ by applying Gauss elimination \n",
        "  to $~(\\mathbf{A} -\\lambda\\mathbf{I}|\\mathbf{0})$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the eigenvalues and eigenvectors of\n",
        " \n",
        "$$\\mathbf{A}=\n",
        "  \\left(\\begin{array}{rrr}\n",
        "    1 & 2 &  1\\\\ \n",
        "    6 &-1 &  0\\\\ \n",
        "   -1 &-2 & -1\n",
        "  \\end{array}\\right)   \n",
        "  $$\n",
        "\n",
        "To find the eigenvalues, $~$ we solve\n",
        "  \n",
        "$${\\scriptsize\n",
        "  \\mathrm{det} (\\mathbf{A} -\\lambda\\mathbf{I}) =\n",
        "  \\begin{vmatrix}\n",
        "    1 -\\lambda & \\;\\;\\,2 & \\;\\;\\,1\\\\ \n",
        "    6 & -1 -\\lambda & \\;\\;\\,0\\\\ \n",
        "    -1\\;\\;\\, & -2 & -1 -\\lambda\n",
        "  \\end{vmatrix}=0}$$\n",
        "  \n",
        "It follows that the characteristic equation is \n",
        "  \n",
        "$$~-\\lambda^3 -\\lambda^2 +12\\lambda=-\\lambda(\\lambda+4)(\\lambda-3)=0$$\n",
        "  \n",
        "Hence the eigenvalues are $~\\lambda_1=-4$, $\\,\\lambda_2=0$, $\\,\\lambda_3=3$\n",
        "\n",
        "For $\\lambda_1=-4$, $~$we have\n",
        "  \n",
        "$$\n",
        "  (\\mathbf{A} +4\\mathbf{I}|\\mathbf{0}) = {\\scriptsize\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    5 & 2 &  1 & 0\\\\ \n",
        "    6 & 3 &  0 & 0\\\\ \n",
        "   -1 &-2 &  3 & 0\n",
        "  \\end{array}\\right)\n",
        "  \\overset{\\;\\text{row operations}\\;}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 0 & 1 & 0\\\\ \n",
        "    0 & 1 &-2 & 0\\\\ \\hline\n",
        "    0 & 0 & 0 & 0\n",
        "  \\end{array}\\right)}$$\n",
        "\n",
        "Thus $k_1=-k_3$, $\\text{ }k_2=2k_3$. Choosing $\\text{ }k_3=1$ gives the eigenvector\n",
        "  \n",
        "$$\\mathbf{k}_1=\n",
        "  \\left(\\begin{array}{r}\n",
        "    -1\\\\ \n",
        "     2\\\\ \n",
        "     1\n",
        "  \\end{array}\\right)$$\n",
        "\n",
        "For $\\lambda_2=0$, $~$we have\n",
        "  \n",
        "$$\n",
        "  (\\mathbf{A} -0\\mathbf{I}|\\mathbf{0}) = {\\scriptsize\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 2 &  1 & 0\\\\ \n",
        "    6 &-1 &  0 & 0\\\\ \n",
        "   -1 &-2 & -1 & 0\n",
        "  \\end{array}\\right)\n",
        "  \\overset{\\text{row operations}}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 0 & \\frac{1}{13} & 0\\\\ \n",
        "    0 & 1 & \\frac{6}{13} & 0\\\\ \\hline\n",
        "    0 & 0 & 0\\; & 0\n",
        "  \\end{array}\\right)}$$\n",
        "  \n",
        "Thus $k_1=-\\frac{1}{13}k_3$, $\\text{ }k_2=-\\frac{6}{13}k_3$. $~$Choosing $~k_3=1$ gives the eigenvector\n",
        "  \n",
        "$$\\mathbf{k}_2=\n",
        "  \\left(\\begin{array}{r}\n",
        "    -\\frac{1}{13}\\\\ \n",
        "    -\\frac{6}{13}\\\\ \n",
        "    1\\;\n",
        "  \\end{array}\\right)$$\n",
        "\n",
        "For $\\lambda_3=3$, $~$ we have\n",
        "  \n",
        "$$\n",
        "  (\\mathbf{A} -3\\mathbf{I}|\\mathbf{0}) = {\\scriptsize\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "   -2 & 2 &  1 & 0\\\\ \n",
        "    6 &-4 &  0 & 0\\\\ \n",
        "   -1 &-2 & -4 & 0\n",
        "  \\end{array}\\right)\n",
        "  \\overset{\\text{row operations}}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 0 & 1 & 0\\\\ \n",
        "    0 & 1 & \\frac{3}{2} & 0\\\\ \\hline\n",
        "    0 & 0 & 0 & 0\n",
        "  \\end{array}\\right)}$$\n",
        "  \n",
        "Thus $k_1=-k_3$, $\\text{ }k_2=-\\frac{3}{2}k_3$. $~$Choosing $\\text{ }k_3=1$ gives the eigenvector\n",
        "  \n",
        "$$\\mathbf{k}_3=\n",
        "  \\left(\\begin{array}{r}\n",
        "   -1\\\\ \n",
        "   -\\frac{3}{2}\\\\ \n",
        "    1\n",
        "  \\end{array}\\right)$$"
      ],
      "id": "e06cb76a"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "import sympy\n",
        "sympy.init_printing()\n",
        "\n",
        "A = sympy.Matrix([[1, 2, 1], [6, -1, 0], [-1, -2, -1]])\n",
        "\n",
        "A.eigenvects()"
      ],
      "id": "7ba42f1d",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the eigenvalues and eigenvectors of\n",
        " \n",
        "$$\\mathbf{A}=\n",
        "  \\left(\\begin{array}{rrr}\n",
        "    9 & 1 & 1\\\\ \n",
        "    1 & 9 & 1\\\\ \n",
        "    1 & 1 & 9\n",
        "  \\end{array}\\right)$$\n",
        "\n",
        "The characteristic equation\n",
        "  \n",
        "$${\\scriptsize\n",
        "  \\mathrm{det} (\\mathbf{A} -\\lambda\\mathbf{I}) =\n",
        "  \\begin{vmatrix}\n",
        "    9 -\\lambda & 1 & 1\\\\ \n",
        "    1 & 9 -\\lambda & 1\\\\ \n",
        "    1 & 1 & 9 -\\lambda\n",
        "  \\end{vmatrix}=-(\\lambda-11)(\\lambda-8)^2=0}$$\n",
        "  \n",
        "shows that $\\lambda_1=11$ and that $\\lambda_2=\\lambda_3=8$ is an eigenvalue of multiplicity 2\n",
        "\n",
        "For $\\lambda_1=11$, $~$we have\n",
        "  \n",
        "$${\\scriptsize\n",
        "  (\\mathbf{A} -11\\mathbf{I}|\\mathbf{0}) =\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "   -2 & 1 &  1 & 0\\\\ \n",
        "    1 &-2 &  1 & 0\\\\ \n",
        "    1 & 1 & -2 & 0\n",
        "  \\end{array}\\right)\n",
        "  \\overset{\\text{row operations}}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 0 & -1 & 0\\\\ \n",
        "    0 & 1 & -1 & 0\\\\ \\hline\n",
        "    0 & 0 & 0 & 0\n",
        "  \\end{array}\\right)}$$\n",
        "  \n",
        "Thus $k_1=k_3$, $k_2=k_3$. $~$Choosing $k_3=1$ gives the eigenvector\n",
        "  \n",
        "$$\\mathbf{k}_1=\n",
        "  \\left(\\begin{array}{r}\n",
        "    1\\\\ \n",
        "    1\\\\ \n",
        "    1\n",
        "  \\end{array}\\right)$$\n",
        "\n",
        "For $\\lambda_2=8$, $~$we have\n",
        "  \n",
        "$${\\scriptsize\n",
        "  (\\mathbf{A} -8\\mathbf{I}|\\mathbf{0}) =\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 1 &  1 & 0\\\\ \n",
        "    1 & 1 &  1 & 0\\\\ \n",
        "    1 & 1 &  1 & 0\n",
        "  \\end{array}\\right)\n",
        "  \\overset{\\text{row operations}}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rrr|r}\n",
        "    1 & 1 & 1 & 0\\\\ \\hline\n",
        "    0 & 0 & 0 & 0\\\\ \n",
        "    0 & 0 & 0 & 0\n",
        "  \\end{array}\\right)}$$\n",
        "  \n",
        "Here $k_1 +k_2 +k_3=0$, $~$we are free to select two of the variables arbitrarily\n",
        "\n",
        "Choosing, $\\,$ on the one hand, $~k_2=1$, $\\,k_3=0$, and on the other, $~k_2=0$, $\\,k_3=1$, $\\,$ we obtain two linearly independent eigenvectors\n",
        "  \n",
        "$$\\mathbf{k}_2=\n",
        "  \\left(\\begin{array}{r}\n",
        "   -1\\\\ \n",
        "    1\\\\ \n",
        "    0\n",
        "  \\end{array}\\right) \\text{ and } \n",
        "  \\mathbf{k}_3=\n",
        "  \\left(\\begin{array}{r}\n",
        "   -1\\\\ \n",
        "    0\\\\ \n",
        "    1\n",
        "  \\end{array}\\right)$$\n",
        "  \n",
        "corresponding to a single eigenvalue\n",
        "\n",
        "If instead we choose $k_2=1$, $k_3=1$ and then $k_2=1$, $k_3=-1$, $~$we obtain, respectively, two entirely different but orthogonal eigenvectors\n",
        "  \n",
        "$$\\mathbf{k}_2=\n",
        "  \\left(\\begin{array}{r}\n",
        "   -2\\\\ \n",
        "    1\\\\ \n",
        "    1\n",
        "  \\end{array}\\right) \\text{ and }\n",
        "  \\mathbf{k}_3=\n",
        "  \\left(\\begin{array}{r}\n",
        "    0\\\\ \n",
        "    1\\\\ \n",
        "   -1\n",
        "  \\end{array}\\right)$$"
      ],
      "id": "ae0f8015"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "A = sympy.Matrix([[9, 1, 1], [1, 9, 1], [1, 1, 9]])\n",
        "A.eigenvects()"
      ],
      "id": "b4e9c72b",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the eigenvalues and eigenvectors of \n",
        "\n",
        "$$\\mathbf{A}=\n",
        "   \\left(\\begin{array}{rr}\n",
        "     3 & 4 \\\\ \n",
        "    -1 & 7 \n",
        "   \\end{array}\\right)$$\n",
        "\n",
        "From the characteristic equation\n",
        "   \n",
        "$$\\scriptsize\n",
        "   \\mathrm{det}(\\mathbf{A} -\\lambda\\mathbf{I})=\n",
        "   \\left|\\begin{array}{cc}\n",
        "     3-\\lambda & 4 \\\\ \n",
        "    -1 & 7 -\\lambda \n",
        "   \\end{array}\\right|\n",
        "   =(\\lambda -5)^2=0$$\n",
        "\n",
        "we see $\\lambda_1=\\lambda_2=5$ is an eigenvalue of algebraic multiplicity 2\n",
        "\n",
        "To find\n",
        "   the eigenvector(s) corresponding to $\\lambda_1=5$, $~$we resort to \n",
        "   the system $(\\mathbf{A} -5\\mathbf{I}|\\mathbf{0})$\n",
        "   \n",
        "$${\\scriptsize\n",
        "  (\\mathbf{A} -5\\mathbf{I}|\\mathbf{0}) =\n",
        "  \\left(\\begin{array}{rr|r}\n",
        "   -2 & 4 & 0\\\\ \n",
        "   -1 & 2 & 0\n",
        "  \\end{array}\\right)\n",
        "  \\overset{\\text{row operations}}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rr|r}\n",
        "    1 &-2 & 0\\\\ \\hline\n",
        "    0 & 0 & 0\n",
        "  \\end{array}\\right)}$$\n",
        "  \n",
        "Thus $k_1=2k_2$. $~$If we choose $k_2=1$, $\\,$ we find the single eigenvector \n",
        "  \n",
        "$$\\mathbf{k}_1=\\begin{pmatrix}\n",
        "     2 \\\\ 1\n",
        "   \\end{pmatrix}$$\n",
        "\n",
        "We define the geometric multiplicity of an eigenvalue\n",
        "  to be the number of linearly independent eigenvectors for the eigenvalue   \n",
        "\n",
        "When the geometric multiplicity of an eigenvalue is less than the algebraic \n",
        "  multiplicity, $~$ we say the matrix is *defective*. $~$ In the case of defective matrices, $~$ we must search for additional system \n",
        "\n",
        "$${\\scriptsize\n",
        "  (\\mathbf{A} -5\\mathbf{I}|\\mathbf{k}_1) =\n",
        "  \\left(\\begin{array}{rr|r}\n",
        "   -2 & 4 & 2\\\\ \n",
        "   -1 & 2 & 1\n",
        "  \\end{array}\\right)\n",
        "  \\overset{\\text{row operations}}{\\Longrightarrow}\n",
        "  \\left(\\begin{array}{rr|r}\n",
        "    1 &-2 & -1\\\\ \\hline\n",
        "    0 & 0 & 0\n",
        "  \\end{array}\\right) }$$\n",
        "  \n",
        "Thus $k_1-2k_2=-1$. $~$If we choose $k_2=0$, $~$we find the generalized eigenvector\n",
        "  \n",
        "$$\\mathbf{k}_2=\\begin{pmatrix}\n",
        "     -1 \\\\ \\;\\;0\n",
        "   \\end{pmatrix}$$"
      ],
      "id": "da173ea7"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "A = sympy.Matrix([[3, 4], [-1, 7]])\n",
        "A.eigenvects()"
      ],
      "id": "b45f03b1",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "lambda1 = A.eigenvects()[0][0]\n",
        "k1 = A.eigenvects()[0][2][0]\n",
        "A1 = A -lambda1 *sympy.eye(2)\n",
        "A1.pinv_solve(k1)"
      ],
      "id": "f05a4b32",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "* Let $\\mathbf{A}$ be a square matrix with real entries. If $\\lambda=\\alpha +i\\beta$, $~\\beta \\neq 0$, $~$is a complex eigenvalue of $\\mathbf{A}$,\n",
        "  \n",
        "  $$\\mathbf{A}\\bar{\\mathbf{k}}=\\bar{\\lambda}\\bar{\\mathbf{k}}$$\n",
        "\n",
        "* $\\lambda=0~$ is an eigenvalue of $~\\mathbf{A}$ if and only if $~\\mathbf{A}$ is singular\n",
        "\n",
        "* If $~\\lambda~$ is an eigenvalue of nonsingular $~\\mathbf{A}$ with eigenvector $~\\mathbf{k}$, $~1/\\lambda$ is an eigenvalue of $~\\mathbf{A}^{-1}$ with the same eigenvector $~\\mathbf{k}$\n",
        "\n",
        "* The eigenvalues of an upper triangular, $~$lower triangular, $~$and diagonal matrix are the main diagonal entries\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the eigenvalues and eigenvectors of the given matrix. $~$State whether the matrix is singular or nonsingular\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " -1& 2\\\\ \n",
        " -7& 8\n",
        "\\end{pmatrix}, \\;\\;\n",
        "\\begin{pmatrix}\n",
        " 4 & \\phantom{-}8 \\\\ \n",
        " 0 & -5 \n",
        "\\end{pmatrix}, \\;\\;\n",
        "\\begin{pmatrix}\n",
        " 0 & 0 & -1 \\\\ \n",
        " 1 & 0 & \\phantom{-}0 \\\\ \n",
        " 1 & 1 & -1 \n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the eigenvalues and eigenvectors of the given nonsingular matrix $\\mathbf{A}$. $~$Then without finding $\\mathbf{A}^{-1}$, $~$find its eigenvalues and corresponding eigenvectors\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " 5& 1\\\\ \n",
        " 1& 5\n",
        "\\end{pmatrix}, \\;\\;\n",
        "\\begin{pmatrix}\n",
        " 4 & 2 & -1 \\\\ \n",
        " 0 & 3 & -2 \\\\ \n",
        " 0 & 0 & \\phantom{-}5 \n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ True or False: $~$ If $\\lambda$ is an eigenvalue of an $n \\times n~$ matrix $\\mathbf{A}$, $~$ then the matrix $\\mathbf{A}-\\lambda\\mathbf{I}~$ is singular. Justify your answer\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Suppose $\\lambda$ is an eigenvalue with corresponding eigenvector $~\\mathbf{k}~$ of an $n\\times n~$ matrix $\\mathbf{A}$\n",
        "  \n",
        "**1.** If $\\mathbf{A}^2=\\mathbf{AA}$, $~$ then show that $\\mathbf{A}^2\\mathbf{k}=\\lambda^2\\mathbf{k}$. $~$ Explain the meaning of the last equation\n",
        "  \n",
        "**2.** Verify the result obtained in part 1 for the matrix \n",
        "  \n",
        "$$\\mathbf{A}=\\begin{pmatrix}\n",
        " 2 & 3\\\\ \n",
        " 5 & 4\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "**3.** Generalize the result in part 1\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Let $\\mathbf{A}$ and $\\mathbf{B}$ be $n \\times n~$ matrices. The matrix $\\mathbf{B}$ is said to be **similar** to the matrix $\\mathbf{A}~$ if there exists a nonsingular matrix $\\mathbf{S}$ such that $\\mathbf{B}=\\mathbf{S}^{-1}\\mathbf{AS}$. $~$If $\\mathbf{B}$ is similar to $\\mathbf{A}$, $~$then show that $\\mathbf{A}$ is similar to $\\mathbf{B}$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Suppose $\\mathbf{A}$ and $\\mathbf{B}$ are similar matrices. Show that $\\mathbf{A}$ and $\\mathbf{B}$ have the same eigenvalues\n",
        "\n",
        "$~$\n",
        "\n",
        "## Powers of Matrices {#sec-8-9}\n",
        "\n",
        "* **Cayley-Hamilton Theorem**\n",
        "\n",
        "  If $(-1)^n \\lambda^n +c_{n-1}\\lambda^{n-1} + \\cdots +c_1 \\lambda +c_0 = 0~$ is the characteristic equation\n",
        "  of $n \\times n$ matrix $\\mathbf{A}$, $~$then\n",
        "  \n",
        "  $$(-1)^n \\mathbf{A}^n +c_{n-1}\\mathbf{A}^{n-1} + \\cdots +c_1 \\mathbf{A} +c_0 \\mathbf{I} = \\mathbf{0}$$\n",
        "\n",
        "  And we can write\n",
        "  \n",
        "  $$\\mathbf{A}^m = a_{n-1}\\mathbf{A}^{n-1} +a_{n-2}\\mathbf{A}^{n-2} + \\cdots +a_1 \\mathbf{A} +a_0 \\mathbf{I} $$\n",
        "    \n",
        "  and the equation for the eigenvalues\n",
        "    \n",
        "  $$\\lambda^m = a_{n-1}\\lambda^{n-1} +a_{n-2}\\lambda^{n-2} + \\cdots +a_1 \\lambda +a_0$$\n",
        "    \n",
        "  hold for the same constants\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Verify that the given matrix satisfies its own characteristic equation\n",
        "  \n",
        "$$~\\mathbf{A}=\\begin{pmatrix}\n",
        " 1 & -2\\\\ \n",
        " 4 & \\phantom{-}5\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Compute $\\mathbf{A}^m$\n",
        "\n",
        "$$\\mathbf{A}=\\begin{pmatrix}\n",
        " 8 & 5\\\\ \n",
        " 4 & 0\n",
        "\\end{pmatrix}; \\;\\;m=5,\\;\\;\n",
        "\\mathbf{A}=\\begin{pmatrix}\n",
        " 1 & 1 & 1\\\\ \n",
        " 0 & 1 & 2\\\\ \n",
        " 0 & 1 & 0\n",
        "\\end{pmatrix}; \\;\\;m=10$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Show that the given matrix has an eigenvalue $\\lambda_1$ of multiplicity two. $~$ As a consequence, $~$the equation $\\lambda^m=c_0+c_1\\lambda$ does not yield enough independent equations to form a system for determining the coefficients $c_i$. $~$Use the derivative (with respect to $\\lambda$) of this equation evaluated at $\\lambda_1$ as the extra needed equation to form a system. $~$Compute $\\mathbf{A}^m$ and use this result to compute the indicated power of the matrix $\\mathbf{A}$\n",
        "\n",
        "$$\\mathbf{A}=\\begin{pmatrix}\n",
        " \\phantom{-}7 & 3\\\\ \n",
        " -3 & 1\n",
        "\\end{pmatrix}; \\;\\;m=6$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ $\\lambda=0~$ is an eigenvalue of each matrix. $~$In this case, $~$ show that the coefficient $c_0$ in the characteristic equation\n",
        "\n",
        "$$(-1)^n\\mathbf{A}^n + c_{n-1}\\mathbf{A}^{n-1}+\\cdots+c_1\\mathbf{A}+c_0\\mathbf{I}=\\mathbf{0}$$\n",
        "  \n",
        "  is $0$. $~$Compute $\\mathbf{A}^m$ in each case. $~$In part (a), $~$explain why we do not have to solve any system for the coefficients $c_1$ in determining $\\mathbf{A}^m$\n",
        "  \n",
        "$$(a)\\;\\;\\mathbf{A}=\\begin{pmatrix}\n",
        " 1 & 1\\\\ \n",
        " 3 & 3\n",
        "\\end{pmatrix},\\;\\;(b)\\;\\;\n",
        "\\mathbf{A}=\\begin{pmatrix}\n",
        " 2 & 1 & \\phantom{-}1\\\\ \n",
        " 1 & 0 & -2\\\\ \n",
        " 1 & 1 & \\phantom{-}3\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ A non-zero $n \\times n$ matrix $\\mathbf{A}~$ is said to be **nilpotent of index $m$** $~$if $m$ is the smallest positive integer for which $\\mathbf{A}^m=\\mathbf{0}$. \n",
        "\n",
        "**1.** $~$Explain why any nilpotent matrix $~\\mathbf{A}$ is singular\n",
        "\n",
        "**2.** $~$Show that all the eigenvalues of a nilpotent matrix $~\\mathbf{A}$ are $0$ \n",
        "\n",
        "\n",
        "## Orthogonal Matrices {#sec-8-10}\n",
        "\n",
        "* <font color='red'>Let $\\mathbf{A}$ be a *symmetric* matrix ($\\mathbf{A}=\\mathbf{A}^T$) with *real* entries. Then the eigenvalues of $\\mathbf{A}$ are *real*</font>\n",
        "\n",
        "* <font color='blue'>Let $\\mathbf{A}$ be a *symmetric* matrix. Then eigenvectors corresponding to distinct(different) eigenvalues are *orthogonal*</font>\n",
        "\n",
        "* <font color='red'>An $n \\times n$ matrix $\\mathbf{A}$ is *orthogonal* ($\\mathbf{A}^{-1}=\\mathbf{A}^T$) $~$if and only if its columns $\\mathbf{x}_1,$ $\\mathbf{x}_2,$ $\\cdots,$ $\\mathbf{x}_n$ form an orthonormal set</font>\n",
        "  \n",
        "  $$\\mathbf{x}_i \\cdot \\mathbf{x}_j=0, \\;i \\neq j \\; \\text{and} \\;\\mathbf{x}_i \\cdot \\mathbf{x}_i=1$$\n",
        "\n",
        "* It may not be possible to find $n$ linearly independent eigenvectors for an $n \\times n$ matrix $\\mathbf{A}$\n",
        "  when some of eigenvalues are repeated (defective matrix)\n",
        "  \n",
        "* <font color='red'>But a symmetric matrix is an exception. $~$It can be proved that a set of \n",
        "  $n$ linearly independent eigenvectors can always be found for an $n \\times n$ symmetric matrix $\\mathbf{A}$ even\n",
        "  there is some repetition of the eigenvalues</font>\n",
        "\n",
        "* However, $~$this does not mean that all eigenvectors are mutually orthogonal for an $n \\times n$ symmetric matrix $\\mathbf{A}$.\n",
        "  The set of eigenvectors corresponding to distinct eigenvalues are orthogonal; $~$but different eigenvectors corresponding to \n",
        "  a repeated eigenvalue may not be orthogonal\n",
        "  \n",
        "* But it is always possible to *find* or *construct* a set of $n$ mutually orthogonal eigenvectors by using Gram-Schmidt orthogonalization. See @sec-7-7\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Construct an orthogonal matrix from the eigenvectors of\n",
        "\n",
        "$$\\mathbf{A}=\n",
        "  \\left(\\begin{array}{rrr}\n",
        "    7 & 4 & -4\\\\ \n",
        "    4 &-8 & -1\\\\ \n",
        "   -4 &-1 & -8\n",
        "  \\end{array}\\right)$$"
      ],
      "id": "4e9b697e"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "A = sympy.Matrix([[7, 4, -4], [4, -8, -1], [-4, -1, -8]])\n",
        "A.eigenvects()"
      ],
      "id": "eeb772bc",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "v1 = A.eigenvects()[0][2][0].T\n",
        "v2 = A.eigenvects()[0][2][1].T\n",
        "v3 = A.eigenvects()[1][2][0].T\n",
        "\n",
        "B = sympy.Matrix(sympy.GramSchmidt([v1, v2, v3], orthonormal=True)).T; B"
      ],
      "id": "c5606357",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "B.T *B"
      ],
      "id": "df31455b",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "**Example** $\\,$ Determine whether the given matrix is orthogonal\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " 0 & 1 & 0\\\\ \n",
        " 1 & 0 & 0\\\\ \n",
        " 0 & 0 & 1\n",
        "\\end{pmatrix}, \\;\\;\n",
        "\\begin{pmatrix}\n",
        " \\phantom{-}0 & 0 & 1\\\\ \n",
        " -\\frac{12}{13}& \\frac{5}{13} & 0\\\\ \n",
        " \\phantom{-}\\frac{5}{13}&  \\frac{12}{13}& 0\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ (a)$~$ Verify that the indicated column vectors are eigenvectors of the given symmetric matrix and $~$(b)$~$ identify the corresponding eigenvalues. $~$(c)$~$ Use Gram-Schmidt process to construct an orthogonal matrix $\\mathbf{P}$ from the eigenvectors\n",
        "\n",
        "$$\\mathbf{A}=\n",
        "\\begin{pmatrix}\n",
        " 0 & 2 & 2\\\\ \n",
        " 2 & 0 & 2\\\\ \n",
        " 2 & 2 & 0\n",
        "\\end{pmatrix}; \\;\\; \\mathbf{k}_1=\\begin{pmatrix}\n",
        "\\phantom{-}1\\\\ -1\\\\ \\phantom{-}0\n",
        "\\end{pmatrix}, \\;\\; \\mathbf{k}_2=\\begin{pmatrix}\n",
        "\\phantom{-}1\\\\ \\phantom{-}0\\\\ -1\n",
        "\\end{pmatrix}, \\;\\; \\mathbf{k}_3 = \\begin{pmatrix}\n",
        "1 \\\\ 1 \\\\ 1\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Answer the questions based on the supposition\n",
        "\n",
        "* Suppose $\\mathbf{A}$ and $\\mathbf{B}~$ are $~n\\times n$ orthogonal matrices. Then show that $\\mathbf{AB}~$ is orthogonal\n",
        "\n",
        "* Suppose $\\mathbf{A}$ is an orthogonal matrix. $~$Is $\\mathbf{A}^2~$ is orthogonal\n",
        "\n",
        "* Suppose $\\mathbf{A}~$ is an orthogonal matrix. $~$Then show that $\\mathbf{A}^{-1}$ is orthogonal\n",
        "\n",
        "* Suppose $\\mathbf{A}~$ is an orthogonal matrix such that $~\\mathbf{A}^2=\\mathbf{I}~$. $~$Then show that $\\mathbf{A}^T=\\mathbf{A}$\n",
        "\n",
        "* Show that the rotation matrix is orthogonal\n",
        "\n",
        "$~$\n",
        "\n",
        "## Approximation of Eigenvalues {#sec-8-11}\n",
        "\n",
        "* Let $\\lambda_1$, $\\lambda_2$, $\\cdots$, $\\lambda_k$, $\\cdots$, $\\lambda_n$ denote the eigenvalues of an $n \\times n$ matrix $\\mathbf{A}$. The eigenvalue $\\lambda_k$ is said to be the **dominant eigenvalue** of $\\mathbf{A}$ if $|\\lambda_k| > |\\lambda_i|$, $~i=1,2,\\cdots,n$, $~$but $\\text{ }i \\neq k$\n",
        "\n",
        "* An eigenvector corresponding to $\\lambda_k$ is called the **dominant eigenvector** of $\\mathbf{A}$\n",
        "\n",
        "* **Power Method**\n",
        "\n",
        "  Let us assume that the eigenvalues of $\\mathbf{A}$ are such that\n",
        "  $|\\lambda_1| > |\\lambda_2| \\geq |\\lambda_3| \\geq \\cdots \\geq |\\lambda_n|$\n",
        "  and that the corresponding $n$ eigenvectors $\\mathbf{k}_1$, $\\mathbf{k}_2$, $\\cdots$, $\\mathbf{k}_n$\n",
        "  are linearly independent. $~$Because of this last assumption, $~n$ eigenvectors\n",
        "  can serve as a basis for $\\mathbb{R}^n$. $~$For any nonzero $n \\times 1$ vector $\\mathbf{x}_0$, \n",
        "  \n",
        "  $$ \\mathbf{x}_0 =c_1 \\mathbf{k}_1 +c_2 \\mathbf{k}_2 +c_3 \\mathbf{k}_3 +\\cdots +c_n \\mathbf{k}_n $$\n",
        "\n",
        "  We shall also assume $\\mathbf{x}_0$ is chosen so that $c_1 \\neq 0$. $\\text{ }$ We do the following procedure\n",
        "  \n",
        "  $$\\scriptsize\n",
        "  \\begin{aligned}\n",
        "      \\mathbf{A}\\mathbf{x}_0 & = c_1 \\mathbf{A}\\mathbf{k}_1 +c_2 \\mathbf{A}\\mathbf{k}_2 \n",
        "         +c_3 \\mathbf{A}\\mathbf{k}_3 +\\cdots +c_n \\mathbf{A}\\mathbf{k}_n\\\\ \n",
        "     &\\;\\big\\Downarrow \\;\\;\\mathbf{x}_i=\\mathbf{A}\\mathbf{x}_{i -1}, \\;\\mathbf{A}\\mathbf{k}_j=\\lambda_j \\mathbf{k}_j\\\\ \n",
        "      \\mathbf{x}_1 & = c_1 \\lambda_1\\mathbf{k}_1 +c_2 \\lambda_2\\mathbf{k}_2 \n",
        "         +c_3 \\lambda_3\\mathbf{k}_3 +\\cdots +c_n \\lambda_n\\mathbf{k}_n\\\\ \n",
        "     &\\Downarrow \\\\\n",
        "     \\mathbf{A}\\mathbf{x}_1 & = c_1 \\lambda_1\\mathbf{A}\\mathbf{k}_1 +c_2 \\lambda_2\\mathbf{A}\\mathbf{k}_2 \n",
        "         +c_3 \\lambda_3\\mathbf{A}\\mathbf{k}_3 +\\cdots +c_n \\lambda_n\\mathbf{A}\\mathbf{k}_n\\\\ \n",
        "     &\\Downarrow \\\\\n",
        "     \\mathbf{x}_2 & = c_1 \\lambda_1^2\\mathbf{k}_1 +c_2 \\lambda_2^2\\mathbf{k}_2 \n",
        "         +c_3 \\lambda_3^2\\mathbf{k}_3 +\\cdots +c_n \\lambda_n^2\\mathbf{k}_n\\\\\n",
        "     &\\Downarrow \\\\\n",
        "     \\mathbf{x}_m & = c_1 \\lambda_1^m\\mathbf{k}_1 +c_2 \\lambda_2^m\\mathbf{k}_2 \n",
        "         +c_3 \\lambda_3^m\\mathbf{k}_3 +\\cdots +c_n \\lambda_n^m\\mathbf{k}_n\\\\ \n",
        "     & = \\lambda_1^m \\left[c_1 \\mathbf{k}_1 +c_2 \\left(\\frac{\\lambda_2}{\\lambda_1}\\right)^m\\mathbf{k}_2 \n",
        "         +c_3 \\left(\\frac{\\lambda_3}{\\lambda_1}\\right)^m\\mathbf{k}_3 +\\cdots +c_n \\left(\\frac{\\lambda_n}{\\lambda_1}\\right)^m\\mathbf{k}_n \\right]\\\\        & \\;\\big\\Downarrow \\;\\;m \\rightarrow \\infty\\\\\n",
        "      \\mathbf{x}_m &\\simeq \\lambda_1^m c_1 \\mathbf{k}_1   \n",
        "  \\end{aligned}$$\n",
        "\n",
        "*  For large values of $m$ and under all the assumptions that were made, $~$the $n \\times 1$ vector $\\mathbf{x}_m$ is an approximation to a dominant eigenvector associated with the dominant eigenvalue $\\lambda_1$\n",
        "\n",
        "* If $\\mathbf{x}_m$ is an approximation to a dominant eigenvector, $~$then the dominant eigenvalue $\\lambda_1$ can be approximated by the **Rayleigh quotient**\n",
        "  \n",
        "  $$\n",
        "   \\lambda_1=\\frac{\\mathbf{A}\\mathbf{x}_m \\cdot \\mathbf{x}_m}{\\mathbf{x}_m \\cdot \\mathbf{x}_m}\n",
        "  $$\n",
        "\n",
        "* Iteration often results in vectors whose entries become very large. $~$Large numbers can cause a problem in computation. One way around this difficulty is to use a **scaled-down** normalized vector\n",
        "  \n",
        "  $$\n",
        "  \\mathbf{x}_m \\leftarrow \n",
        "    \\frac{\\mathbf{x}_m}{\\left \\| \\mathbf{x}_m \\right \\|}$$"
      ],
      "id": "19ce0e1b"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "import numpy as np\n",
        "import pprint\n",
        "\n",
        "def power_method(A, n_iteration):\n",
        "    # Ideally choose a random vector\n",
        "    # To decrease the chance that \n",
        "    #   our vector is orthogonal to the eigenvector\n",
        "    k = np.random.rand(A.shape[1])\n",
        "\n",
        "    for _ in range(n_iteration):\n",
        "        # calculate the matrix-by-vector product Ak\n",
        "        k_1 = np.dot(A, k)\n",
        "\n",
        "        # calculate the norm\n",
        "        k_1_norm = np.linalg.norm(k_1)\n",
        "\n",
        "        # re normalize the vector\n",
        "        k = k_1 /k_1_norm\n",
        "\n",
        "    return k\n",
        "\n",
        "def Rayleigh_quotient(A, k):\n",
        "    # calculate Rayleigh quotient\n",
        "    lambda_ = np.dot(np.dot(A, k), k) /np.dot(k, k)\n",
        "    \n",
        "    return lambda_\n",
        "\n",
        "A = np.array([[4, 2], [3, -1]])\n",
        "k_1 = power_method(A, 10)\n",
        "lambda_1 = Rayleigh_quotient(A, k_1)\n",
        "\n",
        "print('A =')\n",
        "pprint.pprint(A)\n",
        "print('\\nDominant Eigenvector:', np.around(k_1, 3))\n",
        "print('Dominant Eigenvalue:', np.around(lambda_1, 3))"
      ],
      "id": "01ea8997",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "* **Method of Deflation**\n",
        "\n",
        "  * After we have found the dominant eigenvalue $\\lambda_1$ of a matrix $\\mathbf{A}$, $\\,$it may still be necessary to find nondominant eigenvalues. $\\,$We will limit the discussion to the case where $\\mathbf{A}$ is a *symmetric* matrix\n",
        "  \n",
        "  * Suppose $\\lambda_1$ and $\\mathbf{k}_1$ are, respectively, the dominant eigenvalue and a corresponding *normalized* eigenvector of a symmetric matrix $\\mathbf{A}$. $\\,$Furthermore, $\\,$suppose the eigenvalues of $\\mathbf{A}$ are such that\n",
        "  \n",
        "    $$ |\\lambda_1| > |\\lambda_2| > |\\lambda_3| > \\cdots > |\\lambda_n| $$\n",
        " \n",
        "    In this case, the matrix\n",
        "  \n",
        "    $$ \\mathbf{A}_1 =\\mathbf{A} -\\lambda_1\\mathbf{k}_1\\mathbf{k}_1^T $$\n",
        "  \n",
        "    has eigenvalues $0$, $|\\lambda_2|$, $|\\lambda_3|$, $\\cdots$, $|\\lambda_n|$ and that eigenvectors of $\\mathbf{A}_1$ are also eigenvectors of $\\mathbf{A}$. $~$ Note that $\\lambda_2$ is now the dominant eigenvalue of $\\mathbf{A}_1$"
      ],
      "id": "42a4f5ce"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "def deflation_method(A, n_iteration):\n",
        "    \n",
        "    n = A.shape[1]\n",
        "\n",
        "    K = np.zeros((n, n))\n",
        "    Lambda = np.zeros(n)\n",
        "    \n",
        "    k0 = np.zeros(n)\n",
        "    L0 = 0\n",
        "    for i in range(n):\n",
        "        A = A -L0 *np.outer(k0, k0)\n",
        "        k0 = power_method(A, n_iteration)\n",
        "        L0 = Rayleigh_quotient(A, k0)\n",
        "        K[i, :] = k0\n",
        "        Lambda[i] = L0\n",
        "        \n",
        "    return K, Lambda      \n",
        "\n",
        "# symmetric matrix\n",
        "A = np.array([[1, 2, -1], [2, 1, 1], [-1, 1, 0]])\n",
        "\n",
        "K, Lambda = deflation_method(A, 20)  \n",
        "\n",
        "print('A =')\n",
        "pprint.pprint(A)\n",
        "    \n",
        "print('\\nk_1 =', np.around(K[0, :], 3))\n",
        "print('k_2 =', np.around(K[1, :], 3))\n",
        "print('k_3 =', np.around(K[2, :], 3))\n",
        "\n",
        "print('\\nlambda_1 =', np.around(Lambda[0], 3))\n",
        "print('lambda_2 =', np.around(Lambda[1], 3))\n",
        "print('lambda_3 =', np.around(Lambda[2], 3))"
      ],
      "id": "42d68002",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "* **Inverse Power Method**\n",
        "\n",
        "  If we want to find the smallest eigenvalue instead of the largest one, then we perform power iteration for $\\mathbf{A}^{−1}$ (since the eigenvalues of $\\mathbf{A}^{-1}$ are the reciprocals of the eigenvalues of $\\mathbf{A}$). Of course, $~$we do not want to compute $\\mathbf{A}^{-1}$"
      ],
      "id": "174e0005"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "def inverse_power_method(A, n_iteration):\n",
        "    # Ideally choose a random vector\n",
        "    # To decrease the chance that \n",
        "    #   our vector is orthogonal to the eigenvector\n",
        "    k = np.random.rand(A.shape[1])\n",
        "\n",
        "    for _ in range(n_iteration):\n",
        "        # calculate the matrix-by-vector product Ak\n",
        "        w = np.linalg.solve(A, k)\n",
        "\n",
        "        # calculate the norm\n",
        "        w_norm = np.linalg.norm(w)\n",
        "\n",
        "        # re normalize the vector\n",
        "        k = w /w_norm\n",
        "\n",
        "    return k\n",
        "\n",
        "A = np.array([[4, 2], [3, -1]])\n",
        "k_2 = inverse_power_method(A, 10)\n",
        "lambda_2 = Rayleigh_quotient(A, k_2)\n",
        "\n",
        "print('A =')\n",
        "pprint.pprint(A)\n",
        "print('\\nEigenvector =', np.around(k_2, 3))\n",
        "print('Eigenvalue of Least Magnitude =', np.around(lambda_2, 3))"
      ],
      "id": "bb170573",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "## Diagonalization {#sec-8-12}\n",
        "\n",
        "* <font color='red'>For an $n \\times n$ matrix $\\mathbf{A}$, $~$can we find an $n \\times n\\,$ nonsingular matrix $\\mathbf{P}$ such that \n",
        "$\\mathbf{P}^{-1}\\mathbf{A}\\mathbf{P}=\\mathbf{D}$ is a diagonal matrix?</font>\n",
        "\n",
        "* An $n \\times n$ matrix $\\mathbf{A}$ is diagonalizable if and only if $\\mathbf{A}$ has $n$ linearly independent eigenvectors\n",
        "\n",
        "* Let $\\mathbf{k}_1$, $\\mathbf{k}_2$, $\\cdots$, $\\mathbf{k}_n$ be linearly independent eigenvectors corresponding to eigenvalues $\\lambda_1$, $\\lambda_2$, $\\cdots$, $\\lambda_n$. $~$Next form the matrix $~\\mathbf{P}~$ with column vectors $~\\mathbf{k}_1$, $\\mathbf{k}_2$, $\\cdots$, $\\mathbf{k}_n$\n",
        "  \n",
        "  <font color=\"blue\">\n",
        "  $${\n",
        "  \\mathbf{P}= \\begin{pmatrix}\n",
        "    \\mathbf{k}_1 & \\mathbf{k}_2 & \\cdots & \\mathbf{k}_n\n",
        "  \\end{pmatrix}}$$</font>\n",
        "  \n",
        "  We can wrtie the product $\\mathbf{A}\\mathbf{P}$ as\n",
        "  \n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "   \\mathbf{A}\\mathbf{P}\n",
        "      &= \n",
        "      \\begin{pmatrix}\n",
        "        \\mathbf{A}\\mathbf{k}_1 & \\mathbf{A}\\mathbf{k}_2 & \\cdots & \\mathbf{A}\\mathbf{k}_n \n",
        "      \\end{pmatrix} =\n",
        "      \\begin{pmatrix}\n",
        "        \\lambda_1\\mathbf{k}_1 & \\lambda_2\\mathbf{k}_2 & \\cdots & \\lambda_n\\mathbf{k}_n \n",
        "      \\end{pmatrix} \\\\\n",
        "      &=\\begin{pmatrix}\n",
        "           \\mathbf{k}_1 & \\mathbf{k}_2 & \\cdots & \\mathbf{k}_n\n",
        "        \\end{pmatrix}\n",
        "        \\begin{pmatrix}\n",
        "           \\lambda_1 &  &  & \\\\ \n",
        "                     & \\lambda_2 &  & \\\\ \n",
        "                     &  & \\ddots & \\\\ \n",
        "                     &  &  & \\lambda_n\n",
        "        \\end{pmatrix}=\\mathbf{P}\\mathbf{D}\n",
        "  \\end{aligned}$$\n",
        "  \n",
        "  Multiplying by $\\mathbf{P}^{-1}$ on the left then gives $\\mathbf{P}^{-1}\\mathbf{A}\\mathbf{P}=\\mathbf{D}$\n",
        "\n",
        "![](figures/ch08_figure04.png){width=\"50%\" fig-align=\"center\"}\n",
        "\n",
        "* If an $n \\times n$ matrix $\\mathbf{A}$ has $n$ distinct eigenvalues, $\\,$it is diagonalizable\n",
        "* An $n \\times n$ matrix $\\mathbf{A}$ can be *orthogonally* diagonalized if and only if $\\mathbf{A}$ is symmetric\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Diagonalize\n",
        "\n",
        "$$\\mathbf{A}=\n",
        "  \\left(\\begin{array}{rrr}\n",
        "    9 & 1 & 1\\\\ \n",
        "    1 & 9 & 1\\\\ \n",
        "    1 & 1 & 9\n",
        "  \\end{array}\\right)$$\n",
        "  \n",
        "* The eigenvalues and corresponding orthogonal eigenvectors are $\\lambda_1=11$, $\\lambda_2=\\lambda_3=8$\n",
        "  \n",
        "  $$\\mathbf{k}_1=\n",
        "  \\left(\\begin{array}{r}\n",
        "    1\\\\ \n",
        "    1\\\\ \n",
        "    1\n",
        "  \\end{array}\\right),  \n",
        "  \\mathbf{k}_2=\n",
        "  \\left(\\begin{array}{r}\n",
        "   -2\\\\ \n",
        "    1\\\\ \n",
        "    1\n",
        "  \\end{array}\\right) \\text{ and } \n",
        "  \\mathbf{k}_3=\n",
        "  \\left(\\begin{array}{r}\n",
        "    0\\\\ \n",
        "    1\\\\ \n",
        "   -1\n",
        "  \\end{array}\\right)$$\n",
        "\n",
        "* Multiplying these vectors, in turn, by the reciprocals of the norms $\\left \\| \\mathbf{k}_1 \\right \\|=\\sqrt{3}$, $\\,\\left \\| \\mathbf{k}_2 \\right \\|=\\sqrt{6}\\,$ and $\\,\\left \\| \\mathbf{k}_3 \\right \\|=\\sqrt{2}$, $\\,$we obtain an orthonormal set\n",
        "  \n",
        "  $${\\scriptsize\n",
        "  \\mathbf{k}_1=\n",
        "  \\left(\\begin{array}{r}\n",
        "    \\frac{1}{\\sqrt{3}}\\\\ \n",
        "    \\frac{1}{\\sqrt{3}}\\\\ \n",
        "    \\frac{1}{\\sqrt{3}}\n",
        "  \\end{array}\\right), \\; \n",
        "  \\mathbf{k}_2=\n",
        "  \\left(\\begin{array}{r}\n",
        "    -\\frac{2}{\\sqrt{6}}\\\\ \n",
        "     \\frac{1}{\\sqrt{6}}\\\\ \n",
        "     \\frac{1}{\\sqrt{6}}\n",
        "  \\end{array}\\right) \\;{\\text{ and }} \\;\n",
        "  \\mathbf{k}_3=\n",
        "  \\left(\\begin{array}{r}\n",
        "    0\\phantom{\\;\\,}\\\\ \n",
        "    \\frac{1}{\\sqrt{2}}\\\\ \n",
        "   -\\frac{1}{\\sqrt{2}}\n",
        "  \\end{array}\\right)}$$\n",
        "  \n",
        "  We then use these vectors as columns to construct an orthogonal matrix that diagonalizes $\\mathbf{A}$\n",
        "  \n",
        "  $${\\mathbf{P}=\n",
        "  \\left(\\begin{array}{rrr}\n",
        "    \\frac{1}{\\sqrt{3}} & -\\frac{2}{\\sqrt{6}} &  0\\phantom{\\;\\,}\\\\ \n",
        "    \\frac{1}{\\sqrt{3}} &  \\frac{1}{\\sqrt{6}} &  \\frac{1}{\\sqrt{2}}\\\\ \n",
        "    \\frac{1}{\\sqrt{3}} &  \\frac{1}{\\sqrt{6}} & -\\frac{1}{\\sqrt{2}}\n",
        "  \\end{array}\\right)}$$\n",
        "\n",
        "* This transforms $\\mathbf{A}$ to $\\mathbf{D}$\n",
        "  \n",
        "  $$\\mathbf{P}^{-1}\\mathbf{A}\\mathbf{P}=\\mathbf{P}^{T}\\mathbf{A}\\mathbf{P}=\n",
        "   \\begin{pmatrix}\n",
        "    11 & 0 & 0\\\\ \n",
        "     0 & 8 & 0\\\\ \n",
        "     0 & 0 & 8\n",
        "   \\end{pmatrix}=\\mathbf{D}$$\n",
        "   \n",
        "  The entries in $\\mathbf{D}$ are the eigenvalues of $\\mathbf{A}$ and the order in which these numbers appear on the diagonal corresponds to the order in which the eigenvectors are used as columns in the matrix $\\mathbf{P}$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example - Quadratic Forms:** $\\,$ Identify the conic section whose equation $\\,2x^2 +4xy -y^2 =1$\n",
        "\n",
        "* We can write the given equation as\n",
        "  \n",
        "  $$\n",
        "  \\begin{pmatrix}\n",
        "    x & y\n",
        "  \\end{pmatrix}\n",
        "  \\left(\\begin{array}{rr}\n",
        "    2 & 2\\\\ \n",
        "    2 &-1 \n",
        "  \\end{array}\\right)\n",
        "  \\begin{pmatrix}\n",
        "    x \\\\ \n",
        "    y\n",
        "  \\end{pmatrix}\n",
        "  =1 \\;\\text{ or }\\; \\mathbf{x}^T\\mathbf{A}\\mathbf{x}=1\n",
        "  $$\n",
        "  \n",
        "* The eigenvalues and corresponding eigenvectors of $\\mathbf{A}$ are found to be\n",
        "  \n",
        "  $$\\lambda_1=-2, \\,\\lambda_2=3, \\,\\mathbf{k}_1=\\left(\\begin{array}{r} 1\\\\ -2 \\end{array}\\right),\n",
        "  \\,\\mathbf{k}_2=\\left(\\begin{array}{r} 2\\\\ 1 \\end{array}\\right)$$\n",
        "\n",
        "$~$"
      ],
      "id": "4a533861"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "# | fig-align: center\n",
        "\n",
        "from sympy import symbols, Eq, plot_implicit\n",
        "\n",
        "x, y = symbols('x y')\n",
        "\n",
        "p1 = plot_implicit(Eq(2*x**2 +4*x*y -y**2, 1), \n",
        "                   (x, -3, 3), (y, -3, 3),\n",
        "                   aspect_ratio=(1, 1), size=(5, 5))"
      ],
      "id": "57d1bb1c",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "* Observe that $\\mathbf{k}_1$ and $\\mathbf{k}_2$ are orthogonal. $~$Moreover, \n",
        "  $~\\left \\| \\mathbf{k}_1 \\right \\| =\\left \\| \\mathbf{k}_2 \\right \\| =\\sqrt{5}$, $~$ and so the vectors\n",
        "  \n",
        "  $${\\mathbf{k}_1=\\left(\\begin{array}{r} \\frac{1}{\\sqrt{5}}\\\\ -\\frac{2}{\\sqrt{5}} \\end{array}\\right) \\;\\text{and}\n",
        "  \\; \\mathbf{k}_2=\\left(\\begin{array}{r} \\frac{2}{\\sqrt{5}}\\\\ \\frac{1}{\\sqrt{5}} \\end{array}\\right)}$$\n",
        "  \n",
        "  are orthogonal. $\\,$Hence, $\\,$the matrix\n",
        "  \n",
        "  $${\\mathbf{P}=\n",
        "     \\left(\\begin{array}{rr} \\frac{1}{\\sqrt{5}} & \\frac{2}{\\sqrt{5}}\\\\ \n",
        "    -\\frac{2}{\\sqrt{5}} & \\frac{1}{\\sqrt{5}}\n",
        "    \\end{array}\\right)}$$\n",
        "  \n",
        "  is orthogonal\n",
        "\n",
        "* If we define the change of variables $~\\mathbf{x}=\\mathbf{P}\\bar{\\mathbf{x}}\\text{ }$ \n",
        "  where $\\scriptsize \\bar{\\mathbf{x}}=\\begin{pmatrix} \\bar{x} \\\\ \\bar{y} \\end{pmatrix}$, $\\,$then the quadratic form can be written\n",
        "  \n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "      \\mathbf{x}^T\\mathbf{A}\\mathbf{x} \n",
        "     & = \n",
        "      \\bar{\\mathbf{x}}^T\\mathbf{P}^T\\mathbf{A}\\mathbf{P}\\bar{\\mathbf{x}}\n",
        "      =\\bar{\\mathbf{x}}^T\\mathbf{D}\\bar{\\mathbf{x}}\\\\ \n",
        "     & = \n",
        "     \\begin{pmatrix}\n",
        "       \\bar{x} & \\bar{y}\n",
        "     \\end{pmatrix}\n",
        "     \\left(\\begin{array}{rr}\n",
        "       -2 & 0\\\\ \n",
        "        0 & 3 \n",
        "     \\end{array}\\right)\n",
        "     \\begin{pmatrix}\n",
        "       \\bar{x} \\\\ \n",
        "       \\bar{y}\n",
        "     \\end{pmatrix}=1 \\\\\n",
        "     & \\text{ or} \\\\ \n",
        "     -2\\bar{x}^2 &+3\\bar{y}^2 =1\n",
        "  \\end{aligned}$$\n",
        "  \n",
        "  This last equation is recognized as the standard form of a hyperbola\n",
        "\n",
        "$~$"
      ],
      "id": "0981cdcf"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "# | fig-align: center\n",
        "bar_x, bar_y = symbols('bar_x bar_y')\n",
        "\n",
        "p1 = plot_implicit(Eq(-bar_x**2 +3*bar_y**2, 1), \n",
        "                   (bar_x, -3, 3), (bar_y, -3, 3), \n",
        "                   aspect_ratio=(1, 1), size=(5, 5),\n",
        "                   xlabel=r'$\\bar{x}$', ylabel=r'$\\bar{y}$')"
      ],
      "id": "deae6409",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "**Example** $\\,$ Determine whether the given matrix $\\mathbf{A}$ is diagonalizable. $~$ If so, find the matrix $\\mathbf{P}$ that diagonalizes $\\mathbf{A}$ and the disgonal matrix $\\mathbf{D}$ such that $\\mathbf{D}=\\mathbf{P}^{-1}\\mathbf{AP}$\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " -9 & 13\\\\ \n",
        " -2 & 6\n",
        "\\end{pmatrix}, \\;\\; \\begin{pmatrix}\n",
        " 1 & -1 & 1 \\\\ \n",
        " 0 & \\phantom{-}1 & 0\\\\ \n",
        " 1 &  -1&  1\n",
        "\\end{pmatrix}, \\;\\;\\begin{pmatrix}\n",
        " 1 & \\phantom{-}2 & 0\\\\ \n",
        " 2 & -1 & 0\\\\ \n",
        " 0 & \\phantom{-}0 & 1\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ The given matrix $\\mathbf{A}$ is symmetric. $~$ Find an orthogonal matrix $\\mathbf{P}$ that diagonalizes $\\mathbf{A}$ and the diagonal matrix $\\mathbf{D }$ such that $\\mathbf{D}=\\mathbf{P}^T\\mathbf{AP}$\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " 1 & 1\\\\ \n",
        " 1 & 1\n",
        "\\end{pmatrix}, \\;\\; \\begin{pmatrix}\n",
        " 0 & 1 & 0 \\\\ \n",
        " 1 & 0 & 0\\\\ \n",
        " 0 & 0 &  1\n",
        "\\end{pmatrix}, \\;\\;\\begin{pmatrix}\n",
        " 1 & 0 & 7\\\\ \n",
        " 0 & 1 & 0\\\\ \n",
        " 7 & 0 & 1\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Identify the given conic section\n",
        "\n",
        "$$\\phantom{-}5x^2 -2xy +5y^2 =24$$\n",
        "  \n",
        "$$-3x^2 +8xy +3y^2 =20$$\n",
        "  \n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find $3 \\times 3~$ symmetric matrix that has eigenvalues $~\\lambda_1=1$, $~\\lambda_2=3$, and $~\\lambda_3=5$ and corresponding eigenvectors\n",
        "\n",
        "$$\\mathbf{k}_1 = \\begin{pmatrix}\n",
        "  \\phantom{-}1 \\\\ -1 \\\\ 1\n",
        "\\end{pmatrix}, \\;\\;\n",
        "\\mathbf{k}_2 = \\begin{pmatrix}\n",
        "  \\phantom{-}1 \\\\ \\phantom{-}0 \\\\ -1\n",
        "\\end{pmatrix}, \\;\\;\n",
        "\\mathbf{k}_3 = \\begin{pmatrix}\n",
        "  1 \\\\ 2 \\\\ 1\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ If $\\mathbf{A}$ is an $n\\times n~$ diagonalizable matrix, then $\\mathbf{D}=\\mathbf{P}^{-1}\\mathbf{AP}$, $~$ where $\\mathbf{D}$ is a diagonal matrix. $~$ Show that if $m$ is a positive integer,  then $\\mathbf{A}^m=\\mathbf{PD}^m\\mathbf{P}^{-1}$\n",
        "\n",
        "$~$\n",
        "  \n",
        "**Example** $\\,$ Find the indicated power of the given matrix\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "  \\mathbf{A} &= \\begin{pmatrix}\n",
        "     1 & 1\\\\ \n",
        "     2 & 0\n",
        "  \\end{pmatrix},\\;\\;\\mathbf{A}^5\\\\ \n",
        "  \\mathbf{A} &= \\begin{pmatrix}\n",
        "     6 & -10\\\\ \n",
        "     3 & -5\n",
        "  \\end{pmatrix},\\;\\;\\mathbf{A}^{10}\n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Suppose $\\mathbf{A}$ is a nonsingular diagonalizable matrix. Then show that $\\mathbf{A}^{-1}$ is diagonalizable\n",
        "\n",
        "$~$\n",
        "  \n",
        "**Example** $\\,$ Suppose $\\mathbf{A}$ is a diagonalizable matrix. $~$Is the matrix $\\mathbf{P}$ unique?\n",
        "\n",
        "$~$\n",
        "\n",
        "## LU Factorization {#sec-8-13}\n",
        "\n",
        "* Let $\\mathbf{A}$ be a square matrix. $~$An *LU factorization* refers to the factorization of $\\mathbf{A}$ into two factors – a lower triangular matrix $\\mathbf{L}$ and an upper triangular matrix $\\mathbf{U}$:\n",
        "\n",
        "  $$\\mathbf{A}=\\mathbf{L}\\mathbf{U}$$\n",
        "\n",
        "* Without a proper ordering or permutations in the matrix, $~$the factorization may fail to materialize. $\\,$This is a procedural problem. $\\,$It can be removed by simply reordering the rows of $\\mathbf{A}$. $\\,$It turns out that a proper permutation in rows (or columns) is sufficient for LU factorization. $\\,$LU factorization with partial pivoting (LUP) refers often to LU factorization with row permutations only\n",
        "  \n",
        "  $$\\mathbf{P}\\mathbf{A}=\\mathbf{L}\\mathbf{U}$$\n",
        "  \n",
        "  where $\\mathbf{P}$ is a permutation matrix, which, when left-multiplied to $\\mathbf{A}$, reorders the rows of $\\mathbf{A}$. $\\,$It turns out that all square matrices can be factorized in this form\n",
        "\n",
        "* If $\\mathbf{A}$ is invertible, then it admits an LU factorization if and only if all its leading principal minors are nonzero. $\\,$If $\\mathbf{A}$ is a singular matrix of rank $k$, $\\,$then it admits an LU factorization if the first $k$ leading principal minors are nonzero\n",
        "\n",
        "* LU decomposition is basically a modified form of Gaussian elimination. $~$We transform the matrix $\\mathbf{A}$ into an upper triangular matrix $\\mathbf{U}$ by eliminating the entries below the main diagonal. $\\,$The **Doolittle algorithm** does the column-by-column elimination, starting from the left, by multiplying $\\mathbf{A}$ to the left with atomic lower triangular matrices. It results in a *unit* lower triangular matrix and an upper triangular matrix\n",
        "\n",
        "$~$\n",
        "\n",
        "* **Doolittle Algorithm**\n",
        "\n",
        "  * We define\n",
        "\n",
        "    $$\\mathbf{A}^{(0)}=\\mathbf{A}$$\n",
        "\n",
        "  * We eliminate the matrix elements below the main diagonal in the $k$-th column of $\\mathbf{A}^{(k -1)}$ by adding to the $i$-th row of this matrix the $k$-th row multiplied by\n",
        "  \n",
        "    $$l_{i,k}=\\frac{a_{i,k}^{(k-1)}}{a_{k,k}^{(k-1)}} \\;\\text{ for }\\; i=k+1, \\cdots, n$$\n",
        "\n",
        "    This can be done by multiplying $\\mathbf{A}^{(k -1)}$ to the left with the lower triangular matrix\n",
        "  \n",
        "    $${\\scriptsize\n",
        "  \\mathbf{L}_k=\n",
        "     \\begin{pmatrix}\n",
        "         1      & 0      &           & \\cdots &        & 0      \\\\ \n",
        "         0      & \\ddots & \\ddots    &        &        &        \\\\ \n",
        "                &        & 1         &        &        &        \\\\ \n",
        "        \\vdots  &        &-l_{k+1,k} &        &        & \\vdots \\\\ \n",
        "                &        & \\vdots    &        & \\ddots & 0      \\\\ \n",
        "         0      &        &-l_{n,k}   &        & 0      & 1\n",
        "     \\end{pmatrix}}$$\n",
        "\n",
        "  * We set\n",
        "  \n",
        "    $${\\mathbf{A}^{(k)}=\\mathbf{L}_k\\mathbf{A}^{(k-1)}, \\;k=1,\\cdots,n -1}$$\n",
        "  \n",
        "    After $n -1$ steps, $~$we eliminated all the matrix elements below the main diagonal, $\\,$so we obtain an upper triangular matrix $\\mathbf{A}^{(n -1)}$. $\\,$We find the decomposition\n",
        "  \n",
        "    $$\\scriptsize\n",
        "  \\begin{aligned}\n",
        "     \\mathbf{A} \n",
        "     &= \\mathbf{L}_1^{-1}\\mathbf{L}_1\\mathbf{A}^{(0)} \n",
        "      =\\mathbf{L}_1^{-1}\\mathbf{A}^{(1)}\n",
        "      = \\mathbf{L}_1^{-1}\\mathbf{L}_2^{-1}\n",
        "        \\mathbf{L}_2\\mathbf{A}^{(1)} \n",
        "      =\\mathbf{L}_1^{-1}\\mathbf{L}_2^{-1}\n",
        "       \\mathbf{A}^{(2)}\\\\ \n",
        "      &\\;\\;\\vdots \\\\\n",
        "      &=\\mathbf{L}_1^{-1}\\cdots\\mathbf{L}_{n -1}^{-1}\n",
        "        \\mathbf{A}^{(n -1)}\n",
        "  \\end{aligned}$$\n",
        "  \n",
        "    Denote the upper triangular matrix $\\mathbf{A}^{(n -1)}$ by $\\mathbf{U}$, $\\,$ and $\\mathbf{L}=\\mathbf{L}_1^{-1}\\cdots\\mathbf{L}_{n -1}^{-1}$\n",
        "\n",
        "  * Because the inverse of a lower triangular matrix $\\mathbf{L}_k$ is again a lower triangular matrix, \n",
        "  and the multiplication of two lower triangular matrices is again a lower triangular matrix, \n",
        "  it follows that $\\mathbf{L}$ is a lower triangular matrix:\n",
        "  \n",
        "    $${\\scriptsize\n",
        "  \\mathbf{L}=\n",
        "     \\begin{pmatrix}\n",
        "         1      & 0      &           & \\cdots &          & 0      \\\\ \n",
        "         l_{2,1}& \\ddots & \\ddots    &        &          &        \\\\ \n",
        "                &        & 1         &        &          &        \\\\ \n",
        "        \\vdots  &        & l_{k+1,k} &        &          & \\vdots \\\\ \n",
        "                &        & \\vdots    &        & 1        & 0      \\\\ \n",
        "         l_{n,1}& \\cdots & l_{n,k}   & \\cdots & l_{n,n-1}& 1\n",
        "     \\end{pmatrix}}$$\n",
        "  \n",
        "    We obtain $\\mathbf{A}=\\mathbf{L}\\mathbf{U}$\n",
        "\n",
        "**NOTE** $\\,$It is clear that in order for this algorithm to work, one needs to have $a_{k,k}^{(k-1)}$ at each step (see the definition of $l_{i,k}$). If this assumption fails at some point, one needs to interchange $k$-th row with another row below it before continuing. This is why an LU decomposition in general looks like   $\\mathbf{P}\\mathbf{A}=\\mathbf{L}\\mathbf{U}$\n",
        "\n",
        "$~$"
      ],
      "id": "c82c38b8"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "def lu_factor(A):\n",
        "    \"\"\"\n",
        "        LU factorization with partial pivoting\n",
        "    \n",
        "        PA = LU    \n",
        "        P(permutation), \n",
        "        L(unit Lower triangular) and \n",
        "        U(upper triangular) \n",
        "    \n",
        "        Return P, L, U\n",
        "    \"\"\"\n",
        "    n = A.shape[0]    \n",
        "    U = A.copy()\n",
        "    P = np.identity(n)\n",
        "    L = np.identity(n)\n",
        "\n",
        "    for k in range(n -1):\n",
        "\n",
        "        # Partial Pivoting\n",
        "        max_row_index = np.argmax(abs(U[k:n,k])) +k\n",
        "        P[[k,max_row_index]] = P[[max_row_index,k]]\n",
        "        U[[k,max_row_index]] = U[[max_row_index,k]]\n",
        "\n",
        "        # LU\n",
        "        L[k+1:,k] = U[k+1:,k] /U[k,k]\n",
        "        U[k+1:,k] = 0.0\n",
        "        U[k+1:,k+1:] -= np.tensordot(L[k+1:,k],\n",
        "                           U[k,k+1:], axes=0)\n",
        "\n",
        "    return P, L, U\n",
        "\n",
        "A = np.array([[7, 3, -1, 2], [3, 8, 1, -4], [-1, 1, 4, -1], \n",
        "             [2, -4, -1, 6]], dtype='float64')\n",
        "P, L, U = lu_factor(A)\n",
        "\n",
        "print('A ='); pprint.pprint(A)\n",
        "print('\\nP ='); pprint.pprint(P)\n",
        "print('\\nL ='); pprint.pprint(L)\n",
        "print('\\nU ='); pprint.pprint(U)"
      ],
      "id": "02129da5",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$"
      ],
      "id": "254c62ca"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "\n",
        "from scipy.linalg import lu\n",
        "\n",
        "A = np.array([[7, 3, -1, 2], [3, 8, 1, -4], [-1, 1, 4, -1],\n",
        "             [2, -4, -1, 6]], dtype='float64')\n",
        "P, L, U = lu(A)\n",
        "\n",
        "print('P =')\n",
        "pprint.pprint(P)\n",
        "print('\\nL =')\n",
        "pprint.pprint(L)\n",
        "print('\\nU =')\n",
        "pprint.pprint(U)"
      ],
      "id": "b7137ddc",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "A_ = sympy.Matrix([[7, 3, -1, 2], [3, 8, 1, -4], [-1, 1, 4, -1],\n",
        "             [2, -4, -1, 6]])\n",
        "L_, U_, _ = A_.LUdecomposition()\n",
        "L_, U_"
      ],
      "id": "6c4b8dad",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "* **Solving Linear Equations**\n",
        "\n",
        "  Given a system of linear equations in matrix form\n",
        "  \n",
        "  $$\\mathbf{A}\\mathbf{x}=\\mathbf{b}$$\n",
        "  \n",
        "  Suppose we have already obtained the LUP decomposition of $\\mathbf{A}$ such that \n",
        "  $\\mathbf{P}\\mathbf{A}=\\mathbf{L}\\mathbf{U}$, $\\,$so\n",
        "  \n",
        "  $$\\mathbf{L}\\mathbf{U}\\mathbf{x}=\\mathbf{P}\\mathbf{b}$$\n",
        "  \n",
        "  In this case the solution is done in two logical steps:\n",
        "\n",
        "  $~$\n",
        "\n",
        "  * First, $\\,$we solve the equation $\\mathbf{L}\\mathbf{y}=\\mathbf{P}\\mathbf{b}$ for $\\mathbf{y}$  \n",
        "  * Second, $\\,$we solve the equation $\\mathbf{U}\\mathbf{x}=\\mathbf{y}$ for $\\mathbf{x}$\n",
        "\n",
        "  * Note that in both cases we are dealing with triangular matrices \n",
        " $\\mathbf{L}$ and $\\mathbf{U}$, \n",
        "  which can be solved directly by forward and backward substitution without using the Gaussian elimination process \n",
        "  (however we do need this process or equivalent to compute the LU decomposition itself)\n",
        "\n",
        "  * The cost of solving a system of linear equations is approximately $\\frac{2}{3}n^{3}$ floating-point operations\n",
        "   \n",
        "  * The above procedure can be repeatedly applied to solve the equation multiple times for different $\\mathbf{b}$. \n",
        "  $\\,$In this case it is faster (and more convenient) to do an LU decomposition of the matrix $\\mathbf{A}$ \n",
        "  once and then solve the triangular matrices for the different $\\mathbf{b}$, rather than using Gaussian \n",
        "  elimination each time\n",
        "  \n",
        "  * The matrices $\\mathbf{L}$ and $\\mathbf{U}$ could be thought to have *encoded* the Gaussian elimination process\n",
        "\n",
        "$~$"
      ],
      "id": "0239dd85"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "\n",
        "def ufsub(L, b):\n",
        "    \"\"\" Unit row oriented forward substitution \"\"\"\n",
        "    y = b.copy()\n",
        "    for i in range(1, L.shape[0]):\n",
        "        y[i] -= np.dot(L[i,:i], y[:i])\n",
        "    return y\n",
        "\n",
        "def bsub(U, y):\n",
        "    \"\"\" Row oriented backward substitution \"\"\"\n",
        "    x = y.copy()\n",
        "    x[-1] /= U[-1,-1]\n",
        "    for i in range(U.shape[0] -2, -1, -1): \n",
        "        x[i] -= np.dot(U[i,i+1:], x[i+1:])\n",
        "        x[i] /= U[i,i]\n",
        "    return x    \n",
        "                    \n",
        "A = np.array([[7, 3, -1, 2], [3, 8, 1, -4], \n",
        "              [-1, 1, 4, -1], [2, -4, -1, 6]], dtype='float64')\n",
        "b = np.array([1, 2, 3, 4], dtype='float64')\n",
        "\n",
        "P, L, U = lu_factor(A)\n",
        "Pb = np.matmul(P, b)\n",
        "\n",
        "y = ufsub(L, Pb)\n",
        "x = bsub(U, y)\n",
        "\n",
        "print('A ='); pprint.pprint(A)\n",
        "print('\\nb =', end=' '); pprint.pprint(b)\n",
        "print('\\nx =', end=' '); pprint.pprint(x)"
      ],
      "id": "e42ffd9b",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "A_ = sympy.Matrix([[7, 3, -1, 2], [3, 8, 1, -4], \n",
        "              [-1, 1, 4, -1], [2, -4, -1, 6]])\n",
        "b_ = sympy.Matrix([1, 2, 3, 4])\n",
        "\n",
        "A_.LUsolve(b_)"
      ],
      "id": "9d3a51c3",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "* **Inverting a Matrix**\n",
        "\n",
        "  In matrix inversion, instead of vector $\\mathbf{b}$, $\\,$we have matrix $\\mathbf{I}_n$ so that we are trying to find a matrix $\\mathbf{X}$\n",
        "  \n",
        "  $$\\mathbf{L}\\mathbf{U}\\mathbf{X}=\\mathbf{I}_n$$\n",
        "  \n",
        "  We can use the same algorithm presented earlier to solve for each column of matrix $\\mathbf{X}$"
      ],
      "id": "f4549076"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "A_.inv(method='LU')"
      ],
      "id": "13d33041",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "* **Computing the Determinant**\n",
        "\n",
        "  Given the LUP decomposition $\\mathbf{A}=\\mathbf{P}^{-1}\\mathbf{L}\\mathbf{U}$ of a square matrix $\\mathbf{A}$, \n",
        "  $\\,$the determinant of $\\mathbf{A}$ can be computed straightforwardly as   \n",
        "  $$\\mathrm{det}\\,\\mathbf{A}=\\mathrm{det}\\,\\mathbf{P}^{-1}\\,\\mathrm{det}\\,\\mathbf{L}\\,\n",
        "  \\mathrm{det}\\,\\mathbf{U}=(-1)^s \\prod_{i=1}^n l_{ii}\\prod_{i=1}^n u_{ii}$$\n",
        "   \n",
        "  where $s$ is the number of row exchanges in the permutation matrix\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Find the LU factorization of the given matrix\n",
        "\n",
        "$$\n",
        "  \\begin{pmatrix}\n",
        "    2 & -2\\\\ \n",
        "    1 & \\phantom{-}2\n",
        "  \\end{pmatrix}, \\;\\; \n",
        "  \\begin{pmatrix}\n",
        "    -1 & 4 \\\\ \n",
        "    \\phantom{-}2 & 2\n",
        "  \\end{pmatrix}, \\;\\;\n",
        "  \\begin{pmatrix}\n",
        "   \\phantom{-}4 & -2 & 1\\\\ \n",
        "   -4 & 1 & 2\\\\ \n",
        "   12 & 1 & 3\n",
        "  \\end{pmatrix}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ Use the LU factorization to solve the given linear system of equations\n",
        "\n",
        "$$\\begin{pmatrix} 2 & -2 \\\\ 1 & \\phantom{-}2\\end{pmatrix}\n",
        "  \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \n",
        "  \\begin{pmatrix} \\phantom{-}1 \\\\-2 \\end{pmatrix}\\\\$$\n",
        "\n",
        "$$\\begin{pmatrix} \n",
        "    \\phantom{-}4 & -2 & 1 \\\\ -4 & \\phantom{-}1 & 2\\\\12 & \\phantom{-}1 & 3\n",
        "  \\end{pmatrix}\n",
        "  \\begin{pmatrix} x_1 \\\\ x_2 \\\\x_3 \\end{pmatrix} = \n",
        "  \\begin{pmatrix} 7 \\\\ 7\\\\28 \\end{pmatrix}$$\n",
        "\n",
        "\n",
        "## Applications {#sec-8-14}\n",
        "\n",
        "### **Cryptography**\n",
        "\n",
        "  Cryptography is the study of making *secret writings* or *codes*. $~$ We will consider a system of encoding and decoding\n",
        "  messages that requires both the sender and the receiver to know:\n",
        "  \n",
        "  * A specified rule of correspondence between a set of symbols and a set of integers; and \n",
        "  * A specified *nonsingular* matrix $\\mathbf{A}$\n",
        "\n",
        "$~$\n",
        "\n",
        "**Example** $\\,$ A correspondence between the twenty-seven integers and the letters of the alphabet and a blank space is given by\n",
        "  \n",
        "\n",
        "$$\\tiny\n",
        " \\left(\\begin{array}{rrrrrrrrrrrrrrrr}\n",
        "  0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 &10 &11 &12 &13 &14 &15  \\\\ \n",
        " \\text{space} & j & k & l & n & m & s & t & u & w & x & g & h & i & o & p     \n",
        " \\end{array}\\right. \\\\ \\\\\n",
        " \\tiny\\left.\\begin{array}{rrrrrrrrrrrr}\n",
        "   &16 &17 &18 &19 &20 &21 &22 &23 &24 &25 &26 \\\\ \n",
        "   &q & r & v & y & z & a & b & c & d & e & f   \n",
        "  \\end{array}\\right)$$\n",
        "  \n",
        "The numerical equivalent of the message **DR JOHN IS A DOUBLE SPY** is \n",
        "  \n",
        "$$\\tiny\\left.\\begin{array}{rrrrrrrrrrrrrrrr}\n",
        "    24 & 17 & 0 & 1 & 14 & 12 & 4 & 0 & 13 & 6 & 0 & 21 & 0 & 24 & 14 \\\\\n",
        "    8 & 22 & 3 & 25 & 0 & 6 & 15 & 19\n",
        "  \\end{array}\\right.$$\n",
        "\n",
        "* The sender will **encode** the message by means of the nonsingular matrix $\\mathbf{A}$ and the receiver will **decode**\n",
        "  the encoded message by means of the matrix $\\mathbf{A}^{-1}$. $~$ We choose to write the numerical message as the $3 \\times 8$ matrix\n",
        "  \n",
        "  $${\\scriptsize\n",
        "  \\mathbf{M}=\n",
        "    \\left(\\begin{array}{rrrrrrrr}\n",
        "      24 & 17 & 0 & 1 & 14 & 12 & 4 & 0 \\\\ \n",
        "      13 & 6 & 0 & 21 & 0 & 24 & 14 & 8 \\\\ \n",
        "      22 & 3 & 25 & 0 & 6 & 15 & 19 & 0 \n",
        "    \\end{array}\\right)}$$\n",
        "  \n",
        "  Note that the last entry $m_{38}$ has been simply padded with a space (the number $0$)\n",
        "\n",
        "* A $3 \\times 8$ matrix allows us\n",
        "  to encode the message by means of a $3 \\times 3$ matrix. The encoding matrix $\\mathbf{A}$ is constructed, so that\n",
        "  \n",
        "  * $\\mathbf{A}$ is nonsingular\n",
        "  * $\\mathbf{A}$ has only integer entries, and\n",
        "  * $\\mathbf{A}^{-1}$ has only integer entries\n",
        "\n",
        "* To accomplish the last criterion, $~$ we need only select the integer entries of $\\mathbf{A}$ in such a manner that \n",
        "  $\\mathrm{det}\\,\\mathbf{A}=\\pm 1$. $~$ We choose\n",
        "      \n",
        "  $${\\scriptsize\n",
        "  \\mathbf{A}=\n",
        "    \\left(\\begin{array}{rrr}\n",
        "        -1 & 0 &-1 \\\\\n",
        "        2 & 3 & 4 \\\\\n",
        "        2 & 4 & 5\n",
        "     \\end{array}\\right)}$$\n",
        "  \n",
        "  and\n",
        "  \n",
        "  $${\\scriptsize\n",
        "  \\mathbf{A}^{-1}=\n",
        "    \\left(\\begin{array}{rrr}\n",
        "        1 & 4 &-3 \\\\\n",
        "        2 & 3 &-2 \\\\\n",
        "       -2 &-4 & 3\n",
        "     \\end{array}\\right)}$$  \n",
        "      \n",
        "  You should verify that $\\mathrm{det}\\,\\mathbf{A}=-1$\n",
        "\n",
        "* The original message is encoded as following:\n",
        "      \n",
        "  $${\\tiny\\mathbf{B}=\\mathbf{A}\\mathbf{M}=\n",
        "    \\left(\\begin{array}{rrrrrrrr}\n",
        "     -46 & -20 & -25 & -1 & -20 & -27 & -23 & 0 \\\\ \n",
        "     175 &  64 & 100 & 65 & 52 & 156 & 126 & 24 \\\\ \n",
        "     210 &  73 & 125 & 86 & 58 & 195 & 159 & 32 \n",
        "    \\end{array}\\right)}$$\n",
        "  \n",
        "  To send the encoded message as letters of the alphabet rather than as numbers, we rewrite $\\mathbf{B}$ as $\\mathbf{B}'$ using integers modulo 27:\n",
        "  \n",
        "  $${\\tiny\\mathbf{B'}=\n",
        "    \\left(\\begin{array}{rrrrrrrr}\n",
        "     8 & 7 & 2 & 26 & 7 & 0 & 4 & 0 \\\\ \n",
        "     13 &  10 & 19 & 11 & 25 & 21 & 18 & 24 \\\\ \n",
        "     21 &  19 & 17 & 5 & 4 & 6 & 24 & 5 \n",
        "    \\end{array}\\right)}$$ \n",
        "  \n",
        "  The encoded message to be sent in letters is\n",
        "  <center>**UTKFT N IXYGEAVDAYRMNSDM**</center>"
      ],
      "id": "f3165771"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "\n",
        "import numpy as np\n",
        "\n",
        "#-- Data for Encoding and Decoding------------------------------------\n",
        "\n",
        "cp = { 0:' ',  1:'j',  2:'k',  3:'l',  4:'n',  5:'m',  6:'s',  7:'t',    \n",
        "       8:'u',  9:'w', 10:'x', 11:'g', 12:'h', 13:'i', 14:'o', 15:'p',  \n",
        "      16:'q', 17:'r', 18:'v', 19:'y', 20:'z', 21:'a', 22:'b', 23:'c', \n",
        "      24:'d', 25:'e', 26:'f' }\n",
        "\n",
        "A = np.array([[-1, 0, -1], [2, 3, 4], [2, 4, 5]])\n",
        "\n",
        "inv_cp =  {v: k for k, v in cp.items()}\n",
        "inv_A = np.rint(np.linalg.inv(A)).astype('int32')\n",
        "\n",
        "print('inv_A = ')\n",
        "print(inv_A)\n",
        "print('det_A =', np.linalg.det(A))"
      ],
      "id": "1c4efce3",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "\n",
        "def convert_to_numeric(message):   \n",
        "    return np.array([inv_cp[m] for m in message])\n",
        "\n",
        "def convert_to_letter(numeric_message):\n",
        "    return ''.join([cp[m] for m in numeric_message])\n",
        "\n",
        "def encoding_message(message):  \n",
        "    \n",
        "    numeric_message = convert_to_numeric(message)\n",
        "    \n",
        "    n_app = (3 -len(numeric_message) % 3) % 3\n",
        "    M = np.append(numeric_message, [0]*n_app).reshape(3, -1)\n",
        "    B = (A @ M) % 27\n",
        "\n",
        "    numeric_message_encoded = B.flatten()\n",
        "    \n",
        "    return convert_to_letter(numeric_message_encoded)"
      ],
      "id": "f4a71162",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "message = 'dr john is a double spy'\n",
        "message_encoded = encoding_message(message)\n",
        "\n",
        "print('Message =', message.upper())\n",
        "print('Encoded message =', message_encoded.upper())"
      ],
      "id": "3ae06251",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "* You should try to imagine the difficulty of decoding the encoded message without prior knowledge. $\\,$Using the original correspondence and $\\mathbf{A}$, $\\,$the decoding is the straightforward computation\n",
        "\n",
        "  $$\\mathbf{M}=\\mathbf{A}^{-1}\\mathbf{B}'$$"
      ],
      "id": "32585257"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "\n",
        "def decoding_message(message_encoded):\n",
        "\n",
        "    B_ = convert_to_numeric(message_encoded).reshape(3, -1)\n",
        "    M_ = (inv_A @ B_) % 27\n",
        "    numeric_message_decoded = M_.flatten()\n",
        "\n",
        "    return convert_to_letter(numeric_message_decoded)\n",
        "\n",
        "\n",
        "message_decoded = decoding_message(message_encoded)\n",
        "\n",
        "print('Decoding message =', message_decoded.upper())"
      ],
      "id": "1b04032d",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "### **An Error-Correcting Code**\n",
        "\n",
        "  We are going to examine briefly the concept of digital communication between a satellite and a computer. As a result, we will deal only with matrices whose entries are binary digits, namely $0$s and $1$s\n",
        "\n",
        "* When addng and multipying such matrices,\n",
        "  $\\,$we will use arithmetic modulo 2. This arithmetic is defined by the addition and multiplication tables\n",
        "\n",
        ":::: {.columns}\n",
        "\n",
        "::: {.column width=\"15%\"}\n",
        "$~$\n",
        ":::\n",
        "\n",
        "::: {.column width=\"30%\"}\n",
        "| + | 0 | 1 |\n",
        "|---|---|---| \n",
        "| **0** | 0 | 1 |\n",
        "| **1** | 1 |<font color='red'> 0 </font>|\n",
        ":::\n",
        "\n",
        "::: {.column width=\"10%\"}\n",
        "$~$\n",
        ":::\n",
        "\n",
        "::: {.column width=\"30%\"}\n",
        "| x | 0 | 1 |\n",
        "|---|---|---| \n",
        "| **0** | 0 | 0 |\n",
        "| **1** | 0 | 1 | \n",
        ":::\n",
        "\n",
        "::: {.column width=\"15%\"}\n",
        "$~$\n",
        ":::\n",
        "\n",
        "::::\n",
        "\n",
        "* In digital communication the messages or words are binary $n$-tuples. $\\,$An $n$-bit word is also said to be a binary string of length $n$. $\\,$By **encoding** a message, $\\,$we mean a process whereby we transform\n",
        "  a word $\\mathbf{W}$ of length $n$ into another word $\\mathbf{C}$ of length $n +m$ by augmenting $\\mathbf{W}$ with $m$ additional bits, $~$called **parity check bits**. $\\,$An encoding/decoding scheme is called a **code**\n",
        "\n",
        "* The **Hamming (7, 4) code** is an encoding/decoding scheme that can detect the presence of a single error\n",
        "  in a received message and can tell which bit must be corrected. In $(7, 4)$ code the encoding process\n",
        "  consists of transforming a 4-bit word \n",
        "  \n",
        "  $$\\mathbf{W}=\\begin{bmatrix} w_1 & w_2 & w_3 & w_4 \\end{bmatrix}$$\n",
        "  \n",
        "  into a 7-bit code word\n",
        "  \n",
        "  $$\\mathbf{C}=\\begin{bmatrix} \\color{green}{c_1} & \\color{green}{c_2} & w_1 & \\color{green}{c_3} & w_2 & w_3 & w_4 \\end{bmatrix}$$\n",
        "  \n",
        "  where $c_1$, $c_2$, and $c_3$ denote the parity check bits and are defined in terms of the information bits $w_1$, $w_2$, $w_3$, and $w_4$\n",
        "  \n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "    c_1 & = w_1 +w_2 +w_4\\\\ \n",
        "    c_2 & = w_1 +w_3 +w_4 \\\\ \n",
        "    c_3 & = w_2 +w_3 +w_4\n",
        "  \\end{aligned} \\tag{C1}\\label{eq:C1}$$ \n",
        "  \n",
        "  We first observe that in modulo 2 arithmatic there are no negative numbers; $\\,$the additive inverse is $1$, not $-1$. $\\,$With this in mind, $\\,$we can write the system \\eqref{eq:C1} in the equivalent form\n",
        "  \n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "     c_3 & + w_2 +w_3 +w_4 = 0\\\\\n",
        "     c_2 & + w_1 +w_3 +w_4 = 0 \\\\        \n",
        "     c_1 & + w_1 +w_2 +w_4 = 0 \n",
        "  \\end{aligned} \\tag{C2}\\label{eq:C2}$$\n",
        " \n",
        "  These are called **parity check equations**\n",
        "\n",
        "* As a matrix product, \\eqref{eq:C2} can be written\n",
        "  \n",
        "  $$\\mathbf{H}\\mathbf{C}^T=\\mathbf{0}$$\n",
        "  \n",
        "  where \n",
        "  \n",
        "  $$\\mathbf{H}=\n",
        "    \\begin{pmatrix}\n",
        "        0 & 0 & 0 & 1 & 1 & 1 & 1\\\\ \n",
        "        0 & 1 & 1 & 0 & 0 & 1 & 1\\\\\n",
        "        1 & 0 & 1 & 0 & 1 & 0 & 1\n",
        "    \\end{pmatrix}$$\n",
        "  \n",
        "  is called the **parity check matrix**. $~$A closer inspection of $\\mathbf{H}$ shows a surprising fact: The columns of $\\mathbf{H}$, left to right, are the numbers $1$ through $7$ written in binary\n",
        "\n",
        "* Let $\\mathbf{R}$ be a $1 \\times 7$ matrix representing the received message. The product\n",
        "  \n",
        "  $$\\mathbf{S}=\\mathbf{H}\\mathbf{R}^T$$\n",
        "  \n",
        "  is called the **syndome** of $\\mathbf{R}$. $\\,$If $\\mathbf{S}=\\mathbf{0}$, $\\,$it is assumed that the transmission is correct and that $\\mathbf{R}$ is the same as the original encoded message $\\mathbf{C}$. $\\,$The decoding of the message is accomplished by simply dropping the \n",
        "  three check bits in $\\mathbf{R}$\n",
        "\n",
        "* Let \n",
        "  \n",
        "  $${\\mathbf{E}=\\begin{bmatrix} e_1 & e_2 & e_3 & e_4 & e_5 & e_6 & e_7 \\end{bmatrix}}$$\n",
        "  \n",
        "  be a *single-error noise* word added to $\\mathbf{C}$ during its transmission\n",
        "\n",
        "* If noise changes the $i$-th bit, $\\,e_i=1$. $\\,$The received message is then $\\mathbf{R}=\\mathbf{C}+\\mathbf{E}$. $\\,$We see that\n",
        "  \n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "     \\mathbf{S}&=\\mathbf{H}\\mathbf{R}^T\n",
        "        =\\mathbf{H}(\\mathbf{C}^T +\\mathbf{E}^T)=\\mathbf{H}\\mathbf{E}^T\\\\[5pt]\n",
        "        &=\\scriptsize e_1 \\begin{pmatrix} 0\\\\ 0\\\\ 1\\end{pmatrix}\n",
        "          +e_2 \\begin{pmatrix} 0\\\\ 1\\\\ 0\\end{pmatrix}\n",
        "          +e_3 \\begin{pmatrix} 0\\\\ 1\\\\ 1\\end{pmatrix}\n",
        "          +e_4 \\begin{pmatrix} 1\\\\ 0\\\\ 0\\end{pmatrix}\n",
        "          +e_5 \\begin{pmatrix} 1\\\\ 0\\\\ 1\\end{pmatrix} \n",
        "          +e_6 \\begin{pmatrix} 1\\\\ 1\\\\ 0\\end{pmatrix}\n",
        "          +e_7 \\begin{pmatrix} 1\\\\ 1\\\\ 1\\end{pmatrix}           \n",
        "    \\end{aligned}$$ \n",
        "   \n",
        "   Hence, if $\\mathbf{S}\\neq\\mathbf{0}$, $\\,$then $\\mathbf{S}$ must be one of \n",
        "   the columns of $\\mathbf{H}$. $\\,$If $\\mathbf{R}$ contains a single error, $\\,$we see that the syndrome itself indicates which bit is in error\n",
        "\n",
        "$~$\n",
        "\n",
        "### **Method of Least Squares**\n",
        "\n",
        "![](figures/ch08_figure06.png){width=\"40%\" fig-align=\"center\"}\n",
        "\n",
        "  When performing experiments we often tabulate data in the form of ordered pairs $(x_1, y_1),$ $(x_2, y_2),$ $\\cdots,$ $(x_n, y_n),$ with each $x_i$ distinct. Given the data, it is then often desirable to predict $y$ from $x$ by finding a mathematical model, that is, a function $f(x)$ that approximates or fits the data\n",
        "\n",
        "* We shall confine our attention to the problem of finding a linear polynomial\n",
        "  $f(x)=ax +b$ that best fits the data $(x_i, y_i)$, $i=1,\\cdots, n$. The procedure\n",
        "  for finding this linear function is known as **the method of least squares**\n",
        "\n",
        "* One way to determine how well the linear function $f(x)=ax +b~$ fits the data is to\n",
        "  measure the vertical distances between the data points $y_i$ and the graphs $f(x_i)$\n",
        "  \n",
        "  $$e_i=|y_i -f(x_i)|, \\;\\;i=1,\\cdots, n$$\n",
        "\n",
        "* An actual approach is to find a linear function $f$ so that the sum of the *squares* of all the $e_i$ values is a minimum\n",
        "  \n",
        "  $$\\min_{a, \\,b} E=\\min_{a, \\,b} \\sum_{i=1}^n \\left[y_i -ax_i -b\\right]^2$$\n",
        "  \n",
        "  Then to find the minimum value of $E$, $\\,$we set the first partial derivatives with respect to\n",
        "  $a$ and $b$ to zero:\n",
        "  \n",
        "  $$\\frac{\\partial E}{\\partial a}=0 \\;\\text{ and }\\; \\frac{\\partial E}{\\partial b}=0$$\n",
        "\n",
        "* The last two conditions yield, in turn,\n",
        "  \n",
        "  $$\n",
        "  \\begin{aligned}\n",
        "        -2 \\sum_{i=1}^n x_i [y_i -a x_i -b] &= 0\\\\ \n",
        "        -2 \\sum_{i=1}^n [y_i -a x_i -b] &= 0\n",
        "  \\end{aligned}$$ \n",
        "\n",
        "\n",
        "  Expanding the sums and rearranging, $~$we find the above system is the same as\n",
        "  \n",
        "  $${\\scriptsize\n",
        "    \\begin{pmatrix}\n",
        "     \\displaystyle\\sum_{i=1}^n x_i^2 & \\displaystyle\\sum_{i=1}^n x_i\\\\ \n",
        "     \\displaystyle\\sum_{i=1}^n x_i   & n\n",
        "    \\end{pmatrix}\n",
        "    \\begin{pmatrix}\n",
        "      a \\\\ b\n",
        "    \\end{pmatrix}=\n",
        "    \\begin{pmatrix}\n",
        "     \\displaystyle \\sum_{i=1}^n x_i y_i\\\\ \\displaystyle \\sum_{i=1}^n y_i \\;\\;\\;\n",
        "    \\end{pmatrix}} \n",
        "  $$\n",
        "\n",
        "  and, in terms of matrices, is  equivalent to \n",
        "    \n",
        "  $$\\mathbf{A}^T\\mathbf{A}\\mathbf{x}=\\mathbf{A}^T\\mathbf{b}$$\n",
        "  \n",
        "  where\n",
        "  \n",
        "  $${\\scriptsize\n",
        "    \\mathbf{A}=\n",
        "    \\begin{pmatrix}\n",
        "     x_1 & 1\\\\ \n",
        "     x_2 & 1\\\\ \n",
        "     \\vdots & \\vdots\\\\ \n",
        "     x_n & 1 \n",
        "    \\end{pmatrix},\n",
        "    \\;\\mathbf{b}=\n",
        "    \\begin{pmatrix}\n",
        "     y_1\\\\\n",
        "     y_2\\\\ \n",
        "     \\vdots\\\\ \n",
        "     y_n\n",
        "    \\end{pmatrix},\n",
        "    \\;\\mathbf{x}=\n",
        "    \\begin{pmatrix}\n",
        "     a \\\\ b\n",
        "    \\end{pmatrix}} \\tag{C3}\\label{eq:C3}\n",
        "  $$ \n",
        "  \n",
        "  Unless the data points all lie on the same vertical line, the matrix $\\mathbf{A}^T\\mathbf{A}$ is nonsingular. Thus \\eqref{eq:C3} has the unique solution\n",
        "  \n",
        "  $$\n",
        "    \\mathbf{x} =\\left(\\mathbf{A}^T \\mathbf{A} \\right)^T \\mathbf{A}^T \\mathbf{b}\n",
        "  $$\n",
        "\n",
        "$~$  \n",
        "\n",
        "**Example** $\\,$ Nonlinear Least Squares: $\\text{ } f(x) = 2.5e^{-1.3x}$"
      ],
      "id": "9ff9ea81"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "from scipy.optimize import curve_fit\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "np.random.seed(1970)\n",
        "\n",
        "def func(x, a, b):\n",
        "    return a *np.exp(-b*x)\n",
        "\n",
        "# Define the data to be fit with some noise\n",
        "xdata = np.linspace(0, 4, 50)\n",
        "ydata = func(xdata, 2.5, 1.3) +0.1 *np.random.normal(size=xdata.size)\n",
        "plt.plot(xdata, ydata, 'ro', label='data')\n",
        "\n",
        "# Fit for the parameters a and b of the function func:\n",
        "popt, pcov = curve_fit(func, xdata, ydata)\n",
        "plt.plot(xdata, func(xdata, *popt), \n",
        "         'b-', label='fit: a=%5.3f, b=%5.3f' % tuple(popt))\n",
        "plt.xlabel('x'), plt.ylabel('y'), plt.legend()\n",
        "plt.show()"
      ],
      "id": "f904b289",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "$~$\n",
        "\n",
        "### **Discrete Compartmental Models**\n",
        "\n",
        "* Strontium 90 is deposited into pastureland by rainfall. To study how this material is cycled through the ecosystem, $~$we divide the system into the compartments:\n",
        "\n",
        "  ![](figures/ch08_figure07.png){width=\"60%\" fig-align=\"center\"}\n",
        "  \n",
        "  Suppose that $\\Delta t=1$ month and the transfer coefficients shown in the figure are measured in fraction/month\n",
        "\n",
        "* Suppose that rainfall has\n",
        "  deposited the strotium 90 into the compartments so that\n",
        "  \n",
        "  $${\\mathbf{x}_0=\n",
        "   \\begin{pmatrix}\n",
        "    20 & \n",
        "    60 & \n",
        "    15 & \n",
        "    20\n",
        "   \\end{pmatrix}^T}$$\n",
        "   \n",
        "  Units might be grams per hectare. Compute the states of the ecosystem over the next 12 months\n",
        "  \n",
        "* From the data in figure, $\\,$we see that transfer matrix $\\mathbf{T}$ is\n",
        "  \n",
        "  $$\\scriptsize\n",
        "    \\mathbf{T}=\n",
        "    \\begin{pmatrix}\n",
        "     0.85 & 0.01 & 0   & 0 \\\\ \n",
        "     0.05 & 0.98 & 0.2 & 0 \\\\ \n",
        "     0.1  & 0    & 0.8 & 0 \\\\ \n",
        "     0    & 0.01 & 0   & 1\n",
        "    \\end{pmatrix}  \n",
        "  $$\n",
        "  \n",
        "  We must compute $\\mathbf{x}_1$, $\\mathbf{x}_2$, $\\cdots$, $\\mathbf{x}_{12}$ by using\n",
        "  the recursion formula $~\\mathbf{x}_{n+1}=\\mathbf{T}\\mathbf{x}_n$\n",
        "\n",
        "$~$"
      ],
      "id": "42ff5606"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# | echo: true\n",
        "T = np.array([[0.85, 0.01, 0.00, 0.00], \n",
        "              [0.05, 0.98, 0.20, 0.00],\n",
        "              [0.10, 0.00, 0.80, 0.00], \n",
        "              [0.00, 0.01, 0.00, 1.00]])\n",
        "x = np.array([20, 60, 15, 20]).T\n",
        "\n",
        "print('-' *47)\n",
        "print('Month     Grasses   Soil      Dead_OM   Streams')\n",
        "print('-' *47)\n",
        "for month in range(13):   \n",
        "    print(f'{month:5d} {x[0]:9.2f} {x[1]:9.2f} {x[2]:9.2f} {x[3]:9.2f}')  \n",
        "    x = T @ x "
      ],
      "id": "879acd1c",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "## Worked Exercises {.unnumbered}\n",
        "\n",
        "**1.** $\\phantom{1}$ Use the inverse of the matrix $\\mathbf{A}$ to solve the system $\\mathbf{Ax}=\\mathbf{b}_i$, where\n",
        "\n",
        "$$\\displaystyle \\mathbf{A}=\\begin{pmatrix}\n",
        " 1 & 2 & 3 \\\\\n",
        " 2 & 3 & 0 \\\\\n",
        " 0 & 1 & 2 \\\\\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "and the vectors $\\mathbf{b}_i$, $i=1,2$ are given by \n",
        "(a) $~\\mathbf{b}_1=\\begin{pmatrix}\n",
        " 1\\\\\n",
        " 1\\\\\n",
        " 1\n",
        "\\end{pmatrix}$, (b) $~\\mathbf{b}_2=\\begin{pmatrix}\n",
        " -2\\\\\n",
        " \\phantom{-}1\\\\\n",
        " \\phantom{-}3\n",
        "\\end{pmatrix}$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "$$\\color{blue}{\\mathbf{A}^{-1} = \\frac{1}{\\det(\\mathbf{A})} \\cdot \\text{adj}(\\mathbf{A}) = \\frac{1}{4} \\begin{pmatrix}\n",
        "\\phantom{-}6 & -1 & -9 \\\\\n",
        "-4 & \\phantom{-}2 & \\phantom{-}6 \\\\\n",
        "\\phantom{-}2 & -1 & -1 \\\\\n",
        "\\end{pmatrix}}$$\n",
        "\n",
        "For $\\mathbf{b}_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$\n",
        "\n",
        "$$\\mathbf{x}_1 = \\mathbf{A}^{-1} \\mathbf{b}_1 \n",
        "= \\frac{1}{4} \n",
        "\\begin{pmatrix}\n",
        "  \\phantom{-}6 & -1 & -9 \\\\\n",
        "  -4 & \\phantom{-}2 & \\phantom{-}6 \\\\\n",
        "  \\phantom{-}2 & -1 & -1 \\\\\n",
        "\\end{pmatrix}\n",
        "\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \n",
        "\\color{blue}{\\begin{pmatrix} -1 \\\\ \\phantom{-}1 \\\\ \\phantom{-}0 \\end{pmatrix}}$$\n",
        "\n",
        "For $\\mathbf{b}_2 = \\begin{pmatrix} -2 \\\\ \\phantom{-}1 \\\\ \\phantom{-}3 \\end{pmatrix}$\n",
        "\n",
        "$$ \\mathbf{x}_2 = \\frac{1}{4} \\begin{pmatrix}\n",
        "\\phantom{-}6 & -1 & -9 \\\\\n",
        "-4 & \\phantom{-}2 & \\phantom{-}6 \\\\\n",
        "\\phantom{-}2 & -1 & -1 \\\\\n",
        "\\end{pmatrix}\n",
        "\\begin{pmatrix} -2 \\\\ \\phantom{-}1 \\\\ \\phantom{-}3 \\end{pmatrix} = \\color{blue}{\\begin{pmatrix} -10 \\\\ \\phantom{-}7 \\\\ -2 \\end{pmatrix}}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**2.** $\\phantom{1}$ Use the given LU-factorization\n",
        "\n",
        "$$\\mathbf{A} = \\begin{pmatrix}\n",
        " 1 & 1 & 1 \\\\\n",
        " 1 & 2 & 2\\\\\n",
        " 1&  2 & 3 \\\\\n",
        "\\end{pmatrix} =\n",
        "\\begin{pmatrix}\n",
        " 1 & 0 & 0 \\\\\n",
        " 1 & 1 & 0 \\\\\n",
        " 1 & 1 & 1 \\\\\n",
        "\\end{pmatrix} \n",
        "\\begin{pmatrix}\n",
        " 1 & 1 & 1 \\\\\n",
        " 0 & 1& 1 \\\\\n",
        " 0 & 0 & 1 \\\\\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "to solve the linear system $\\mathbf{Ax}=\\mathbf{b_i}$ for the given column matrix $\\mathbf{b}_i$, $i=1,2,3,4$\n",
        "\n",
        "$(a)$ $~\\mathbf{b}_1=\\begin{pmatrix}\n",
        " 2\\\\\n",
        " 4\\\\\n",
        " 1\n",
        "\\end{pmatrix}$, $(b)$ $~\\mathbf{b}_2=\\begin{pmatrix}\n",
        " -4\\\\\n",
        " \\phantom{-}7\\\\\n",
        " 10\n",
        "\\end{pmatrix}$, $(c)$ $~\\mathbf{b}_3=\\begin{pmatrix}\n",
        " \\phantom{-}\\frac{1}{2}\\\\\n",
        " \\phantom{-}\\frac{3}{4}\\\\\n",
        " -\\frac{1}{2}\n",
        "\\end{pmatrix}$, $(d)$ $~\\mathbf{b}_4=\\begin{pmatrix}\n",
        " \\phantom{-}30\\\\\n",
        " -42\\\\\n",
        " -18\n",
        "\\end{pmatrix}$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "To solve $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$, we use the factorization:\n",
        "\n",
        "\n",
        "$$\\mathbf{A}\\mathbf{x} = \\mathbf{L}\\mathbf{U}\\mathbf{x} = \\mathbf{b}$$\n",
        "\n",
        "* <font color='red'>Step 1: Solve $\\mathbf{L}\\mathbf{y} = \\mathbf{b}$ (forward substitution)\n",
        "</font>\n",
        "* <font color='red'>Step 2: Solve $\\mathbf{U}\\mathbf{x} = \\mathbf{y}$ (backward substitution)\n",
        "</font>\n",
        "\n",
        "We will apply this for each given $\\mathbf{b}_i$\n",
        "\n",
        "\n",
        "**(a)** $~\\mathbf{b}_1 = \\begin{pmatrix} 2 \\\\ 4 \\\\ 1 \\end{pmatrix}$\n",
        "\n",
        "**Step 1:** $~$Solve $\\mathbf{L}\\mathbf{y} = \\mathbf{b}_1$\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        "1 & 0 & 0 \\\\\n",
        "1 & 1 & 0 \\\\\n",
        "1 & 1 & 1\n",
        "\\end{pmatrix}\n",
        "\\begin{pmatrix}\n",
        "y_1 \\\\ y_2 \\\\ y_3\n",
        "\\end{pmatrix} =\n",
        "\\begin{pmatrix}\n",
        "2 \\\\ 4 \\\\ 1\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "\n",
        "* $y_1 = 2$\n",
        "* $y_1 + y_2 = 4 \\Rightarrow y_2 = 2$\n",
        "* $y_1 + y_2 + y_3 = 1 \\Rightarrow  y_3 = -3$\n",
        "\n",
        "\n",
        "So:\n",
        "\n",
        "$$\\mathbf{y} = \\begin{pmatrix} \\phantom{-}2 \\\\ \\phantom{-}2 \\\\ -3 \\end{pmatrix}$$\n",
        "\n",
        "**Step 2:** $~$Solve $\\mathbf{U}\\mathbf{x} = \\mathbf{y}$\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        "1 & 1 & 1 \\\\\n",
        "0 & 1 & 1 \\\\\n",
        "0 & 0 & 1\n",
        "\\end{pmatrix}\n",
        "\\begin{pmatrix}\n",
        "x_1 \\\\ x_2 \\\\ x_3\n",
        "\\end{pmatrix} =\n",
        "\\begin{pmatrix}\n",
        "\\phantom{-}2 \\\\ \\phantom{-}2 \\\\ -3\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "Back substitution:\n",
        "\n",
        "* $x_3 = -3$\n",
        "* $x_2 + x_3 = 2 \\Rightarrow x_2 = 5$\n",
        "* $x_1 + x_2 + x_3 = 2 \\Rightarrow  x_1 = 0$\n",
        "\n",
        "$$\\color{red}{\\mathbf{x}_1 = \\begin{pmatrix} \\phantom{-}0 \\\\ \\phantom{-}5 \\\\ -3 \\end{pmatrix}}$$\n",
        "\n",
        "**(b)** $~\\mathbf{b}_2=\\begin{pmatrix}\n",
        " -4\\\\\n",
        " \\phantom{-}7\\\\\n",
        " 10\n",
        "\\end{pmatrix}$\n",
        "\n",
        "**Step 1:** $~\\mathbf{L}\\mathbf{y} = \\mathbf{b}_2$\n",
        "\n",
        "* $y_1 = -4$\n",
        "* $y_1 + y_2 = 7 \\Rightarrow y_2 = 11$\n",
        "* $y_1 + y_2 + y_3 = 10 \\Rightarrow  y_3 = 3$\n",
        "\n",
        "$$\\mathbf{y} = \\begin{pmatrix} -4 \\\\ \\phantom{-}11 \\\\ \\phantom{-}3 \\end{pmatrix}$$\n",
        "\n",
        "**Step 2:** $~\\mathbf{U}\\mathbf{x} = \\mathbf{y}$\n",
        "\n",
        "* $x_3 = 3$\n",
        "* $x_2 + x_3 = 11 \\Rightarrow x_2 = 8$\n",
        "* $x_1 + x_2 + x_3 = -4 \\Rightarrow x_1 = -15$\n",
        "\n",
        "$$\\color{red}{\\mathbf{x}_2 = \\begin{pmatrix} -15 \\\\ \\phantom{-}8 \\\\ \\phantom{-}3 \\end{pmatrix}}\n",
        "$$\n",
        "\n",
        "**(c)** $\\mathbf{b}_3 = \\begin{pmatrix} \\phantom{-}\\frac{1}{2} \\\\ \\phantom{-}\\frac{3}{4} \\\\ -\\frac{1}{2} \\end{pmatrix}$\n",
        "\n",
        "**Step 1:**\n",
        "\n",
        "* $y_1 = \\frac{1}{2}$\n",
        "* $y_1 + y_2 = \\frac{3}{4} \\Rightarrow y_2 = \\frac{1}{4}$\n",
        "* $y_1 + y_2 + y_3 = -\\frac{1}{2} \\Rightarrow  y_3 = -\\frac{5}{4}$\n",
        "\n",
        "$$\\mathbf{y} = \\begin{pmatrix} \\phantom{-}\\frac{1}{2} \\\\ \\phantom{-}\\frac{1}{4} \\\\ -\\frac{5}{4} \\end{pmatrix}$$\n",
        "\n",
        "**Step 2:**\n",
        "\n",
        "* $x_3 = -\\frac{5}{4}$\n",
        "* $x_2 + x_3 = \\frac{1}{4} \\Rightarrow x_2 = \\frac{3}{2}$\n",
        "* $x_1 + x_2 + x_3 = \\frac{1}{2} \\Rightarrow  x_1 = \\frac{1}{4}$\n",
        "\n",
        "$$\\color{red}{\\mathbf{x}_3 = \\begin{pmatrix} \\phantom{-}\\frac{1}{4} \\\\ \\phantom{-}\\frac{3}{2} \\\\ -\\frac{5}{4} \\end{pmatrix}}$$\n",
        "\n",
        "**(d)** $\\mathbf{b}_4 = \\begin{pmatrix} \\phantom{-}30 \\\\ -42 \\\\ -18 \\end{pmatrix}$\n",
        "\n",
        "**Step 1:**\n",
        "\n",
        "* $y_1 = 30$\n",
        "* $y_1 + y_2 = -42 \\Rightarrow y_2 = -72$\n",
        "* $y_1 + y_2 + y_3 = -18 \\Rightarrow y_3 = 24$\n",
        "\n",
        "$$\\mathbf{y} = \\begin{pmatrix} \\phantom{-}30 \\\\ -72 \\\\ \\phantom{-}24 \\end{pmatrix}$$\n",
        "\n",
        "**Step 2:**\n",
        "\n",
        "* $x_3 = 24$\n",
        "* $x_2 + x_3 = -72 \\Rightarrow x_2 = -96$\n",
        "* $x_1 + x_2 + x_3 = 30 \\Rightarrow  x_1 = 102$\n",
        "\n",
        "$$\\color{red}{\\mathbf{x}_4 = \\begin{pmatrix} \\phantom{-}102 \\\\ -96 \\\\ \\phantom{-}24 \\end{pmatrix}}\n",
        "$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**3.** $~$Consider the matrix\n",
        "\n",
        "$$\\mathbf{A}=\\begin{pmatrix}\n",
        " 3 & 0 & 1\\\\ \n",
        " 0 & 1 & 0\\\\ \n",
        " 1 & 0 & 1\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "(a) Find an orthogonal matrix $\\mathbf{P}$ that diagonalizes $\\mathbf{A}$ and the diagonal matrix $\\mathbf{D}$\n",
        "\n",
        "(b) Calculate the eigenvalues and eigenvectors of the matrix\n",
        "\n",
        "$$3\\mathbf{A}^2 +4\\mathbf{A}^{-1} -7\\mathbf{I}$$\n",
        "\n",
        "**Solution (a)**\n",
        "\n",
        "Compute $\\det(\\mathbf{A} - \\lambda \\mathbf{I})$:\n",
        "\n",
        "$$\\mathbf{A} - \\lambda \\mathbf{I} =\n",
        "\\begin{pmatrix}\n",
        "3 - \\lambda & 0 & 1 \\\\\n",
        "0 & 1 - \\lambda & 0 \\\\\n",
        "1 & 0 & 1 - \\lambda\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "Use cofactor expansion along the 2nd row:\n",
        "\n",
        "$$\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = (1 -\\lambda)(\\lambda^2 -4\\lambda +2) = 0$$\n",
        "\n",
        "So the eigenvalues are:\n",
        "\n",
        "$$\\color{blue}{\\lambda_1 = 1,\\quad \\lambda_2 = 2 + \\sqrt{2},\\quad \\lambda_3 = 2 - \\sqrt{2}}$$\n",
        "\n",
        "\n",
        "Let’s find eigenvectors for each eigenvalue. We’ll normalize them at the end.\n",
        "\n",
        "* For $\\lambda = 1$,\n",
        "\n",
        "    Solve $(\\mathbf{A} - \\mathbf{I}) \\mathbf{v}_1 = \\mathbf{0}$:\n",
        "    \n",
        "    $$ \\mathbf{A} - \\mathbf{I} = \\begin{pmatrix}\n",
        "    2 & 0 & 1 \\\\\n",
        "    0 & 0 & 0 \\\\\n",
        "    1 & 0 & 0\n",
        "    \\end{pmatrix} \\; \\Rightarrow \\;\n",
        "    \\color{blue}{\\mathbf{v}_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}}$$\n",
        "\n",
        "* For $\\lambda = 2 + \\sqrt{2}$,\n",
        "\n",
        "    Solve $(\\mathbf{A} - \\lambda \\mathbf{I}) \\mathbf{v}_2 = \\mathbf{0}$:\n",
        "    \n",
        "    This yields:\n",
        "    \n",
        "    $$\\color{blue}{\\mathbf{v}_2 = \\begin{pmatrix}\n",
        "    1 \\\\\n",
        "    0 \\\\\n",
        "    -1 + \\sqrt{2}\n",
        "    \\end{pmatrix}}$$\n",
        "    \n",
        "    Normalize:\n",
        "    \n",
        "    $$ \\|\\mathbf{v}_2\\| = \\sqrt{1^2 + (-1 + \\sqrt{2})^2} = \\sqrt{4 - 2\\sqrt{2}}$$\n",
        "    \n",
        "    Let’s denote the normalized vector as $\\color{blue}{\\mathbf{u}_2 = \\mathbf{v}_2 /\\| \\mathbf{v_2}\\|}$\n",
        "\n",
        "* For $\\lambda = 2 - \\sqrt{2}$,\n",
        "\n",
        "    Similarly:\n",
        "    \n",
        "    $$\\color{blue}{\\mathbf{v}_3 = \\begin{pmatrix}\n",
        "    1 \\\\\n",
        "    0 \\\\\n",
        "    -1 - \\sqrt{2}\n",
        "    \\end{pmatrix}}$$\n",
        "    \n",
        "    $$ \\|\\mathbf{v}_3\\| = \\sqrt{1^2 + (1 + \\sqrt{2})^2} = \\sqrt{4 + 2\\sqrt{2}}$$\n",
        "    \n",
        "    Normalize to get $\\color{blue}{\\mathbf{u}_3 = \\mathbf{v}_3 /\\| \\mathbf{v_3}\\|}$\n",
        "\n",
        "Let:\n",
        "\n",
        "$$ \\color{blue}{\\mathbf{P} = \\begin{pmatrix} \\mathbf{v}_1 & \\mathbf{u}_2 & \\mathbf{u}_3 \\end{pmatrix}, \\quad\n",
        "\\mathbf{D} = \\begin{pmatrix}\n",
        "1 & 0 & 0 \\\\\n",
        "0 & 2 + \\sqrt{2} & 0 \\\\\n",
        "0 & 0 & 2 - \\sqrt{2}\n",
        "\\end{pmatrix}}$$\n",
        "\n",
        "**Solution (b)**\n",
        "\n",
        "Let’s use the fact that if $\\mathbf{v}$ is an eigenvector of $\\mathbf{A}$ with eigenvalue $\\lambda$, then:\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        "&\\mathbf{A}^2 \\mathbf{v} = \\lambda^2 \\mathbf{v} \\\\\n",
        "&\\mathbf{A}^{-1} \\mathbf{v} = \\lambda^{-1} \\mathbf{v} \\\\\n",
        "&\\mathbf{I} \\mathbf{v} = \\mathbf{v}\n",
        "\\end{aligned}$$\n",
        "\n",
        "So:\n",
        "\n",
        "$$\\color{blue}{\\left( 3\\mathbf{A}^2 + 4\\mathbf{A}^{-1} - 7\\mathbf{I} \\right) \\mathbf{v} = \\left( 3\\lambda^2 + 4\\lambda^{-1} - 7 \\right) \\mathbf{v}}$$\n",
        "\n",
        "So the eigenvalues of this new matrix are:\n",
        "\n",
        "$$ \\mu_i = 3\\lambda_i^2 + \\frac{4}{\\lambda_i} - 7$$\n",
        "\n",
        "This matrix shares the same set of eigenvectors with matrix $\\mathbf{A}$\n",
        "\n",
        "Now compute for each $\\lambda_i$:\n",
        "\n",
        "$$ \\begin{aligned}\n",
        "\\color{blue}{\\mu_1} &= 3(1)^2 + \\frac{4}{1} - 7 = 3 + 4 - 7 = 0 \\\\\n",
        "\\color{blue}{\\mu_2} &= 3(6 + 4\\sqrt{2}) + 4 \\cdot \\frac{2 - \\sqrt{2}}{2} - 7 = 15 + 10\\sqrt{2} \\\\\n",
        " \\color{blue}{\\mu_3} &= 3(6 - 4\\sqrt{2}) + 4 \\cdot \\frac{2 + \\sqrt{2}}{2} - 7 = 15 - 10\\sqrt{2}\n",
        " \\end{aligned}$$\n",
        "\n",
        " $~$\n",
        "\n",
        "**4.** $\\phantom{1}$ Simplify the following equation of conic section in two-dimensional space, and give the corresponding coordinate tranformation:\n",
        "\n",
        "$$16 x^2 + 24xy +9y^2 -3x +4y =0$$\n",
        "\n",
        "and plot the transformed conic section\n",
        "\n",
        "**Solution**\n",
        "\n",
        "We diagonalized the quadratic part:\n",
        "\n",
        "$$\\color{red}{\\mathbf{A} = \\begin{pmatrix} 16 & 12 \\\\ 12 & 9 \\end{pmatrix}}$$\n",
        "\n",
        "The eigenvalues of this matrix give the coefficients of the conic in the rotated $(u,v)$ coordinate system, and the eigenvectors provide the rotation matrix\n",
        "\n",
        "**Eigenvalues:**\n",
        "\n",
        "$$\\color{red}{\\lambda_1 = 0, \\quad \\lambda_2 = 25}$$\n",
        "\n",
        "These are the new coefficients of the quadratic terms in the rotated coordinate system. That is, the conic becomes:\n",
        "\n",
        "$$\\color{red}{0 \\cdot u^2 + 25v^2 + \\text{(linear terms in } u, v) = 0}$$\n",
        "\n",
        "**Eigenvectors (columns of rotation matrix):**\n",
        "\n",
        "$$\\color{red}{\\mathbf{P} = \\begin{pmatrix}\n",
        "\\phantom{-}\\frac{3}{5} & -\\frac{4}{5} \\\\\n",
        " -\\frac{4}{5} &  -\\frac{3}{5}\n",
        "\\end{pmatrix}}$$\n",
        "\n",
        "This gives the coordinate transformation from $(u, v)$ to $(x, y)$:\n",
        "\n",
        "$$\\color{red}{\\mathbf{x} = \\mathbf{P}\\mathbf{y}}, \\quad \\mathbf{x}=\\begin{pmatrix} x \\\\ y\\end{pmatrix}, \n",
        "\\quad \\mathbf{y}=\\begin{pmatrix} u \\\\ v\\end{pmatrix}$$\n",
        "\n",
        "The linear terms come from substituting $x = \\frac{3}{5}u - \\frac{4}{5}v$, $y = -\\frac{4}{5}u - \\frac{3}{5}v$ into the original equation’s linear part:\n",
        "\n",
        "$$-3x + 4y = -3(\\frac{3}{5}u - \\frac{4}{5}v) + 4(-\\frac{4}{5}u - \\frac{3}{5}v)= -5u$$\n",
        "\n",
        "So, the full rotated equation becomes:\n",
        "\n",
        "$$\\color{red}{5v^2 - u = 0}$$\n",
        "\n",
        "This is a parabola that opens along the $u$-axis with its vertex at the origin in the $(u, v)$ coordinate system"
      ],
      "id": "eecc9752"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "import numpy as np\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "# Define v values\n",
        "v_vals = np.linspace(-2, 2, 400)\n",
        "\n",
        "# Compute corresponding u values from u = 5 *v^2\n",
        "u_vals = 5 *v_vals**2\n",
        "\n",
        "# Plot the parabola in (u, v) coordinates\n",
        "plt.figure(figsize=(8, 6))\n",
        "\n",
        "plt.plot(u_vals, v_vals, label=r'$5v^2 -u = 0$', color='purple')\n",
        "plt.gca().set_aspect('equal')\n",
        "\n",
        "plt.title(\"Conic Section in Rotated Coordinates (u, v)\")\n",
        "plt.xlabel(\"u\")\n",
        "plt.ylabel(\"v\")\n",
        "plt.grid(True)\n",
        "plt.legend()\n",
        "plt.show()"
      ],
      "id": "fa573827",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "# Step 1: Define the (u, v) parabola\n",
        "v_vals = np.linspace(-2, 2, 400)\n",
        "u_vals = 5 *v_vals**2  # From u = 5v^2\n",
        "\n",
        "# Step 2: Rotation matrix (from previous eigenvectors)\n",
        "P = np.array([[ 0.6, -0.8],\n",
        "              [-0.8, -0.6]])\n",
        "\n",
        "# Step 3: Stack u and v into coordinate array\n",
        "UV = np.vstack((u_vals, v_vals))  # Shape (2, N)\n",
        "\n",
        "# Step 4: Transform back to original (x, y) \n",
        "# using inverse rotation: [x, y]^T = P @ [u, v]^T\n",
        "XY = P @ UV\n",
        "x_vals, y_vals = XY[0, :], XY[1, :]\n",
        "\n",
        "# Step 5: Plot the result in original (x, y) coordinates\n",
        "plt.figure(figsize=(8, 6))\n",
        "\n",
        "plt.plot(x_vals, y_vals, label=\"Conic in (x, y)\", color='darkgreen')\n",
        "plt.gca().set_aspect('equal')\n",
        "\n",
        "plt.title(\"Original Conic in (x, y) Coordinates (Back-Transformed)\")\n",
        "plt.xlabel(\"x\")\n",
        "plt.ylabel(\"y\")\n",
        "plt.grid(True)\n",
        "plt.legend()\n",
        "plt.show()"
      ],
      "id": "fff2d4b8",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "**5.** $~$ Find the inverse of the given matrix or show that no inverse exists\n",
        "\n",
        "$$\\begin{pmatrix}\n",
        " \\phantom {-} 1 & \\phantom {-}2 & \\phantom {-}3 & \\phantom {-}1\\\\ \n",
        " -1& \\phantom {-}0 & \\phantom {-}2 &\\phantom {-}1 \\\\ \n",
        " \\phantom {-}2&  \\phantom {-}1&  -3& \\phantom {-}0\\\\ \n",
        " \\phantom {-}1& \\phantom {-}1 & \\phantom {-}2 & \\phantom {-}1\n",
        "\\end{pmatrix}$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "$$\\begin{aligned}\n",
        " \\mathbf{A} &= \\begin{pmatrix}\n",
        " \\phantom {-} 1 & \\phantom {-}2 & \\phantom {-}3 & \\phantom {-}1\\\\ \n",
        " -1& \\phantom {-}0 & \\phantom {-}2 &\\phantom {-}1 \\\\ \n",
        " \\phantom {-}2&  \\phantom {-}1&  -3& \\phantom {-}0\\\\ \n",
        " \\phantom {-}1& \\phantom {-}1 & \\phantom {-}2 & \\phantom {-}1\n",
        "\\end{pmatrix} \\\\ \n",
        " &\\Downarrow \\\\ \n",
        " \\left ( \\mathbf{A} \\;| \\;\\mathbf{I} \\right ) \\;\\;\n",
        "&\\overset{\\text{row operations}}{\\longrightarrow}  \\left ( \\mathbf{I} \\;|\\; \\mathbf{A}^{-1} \\right ) \\\\\n",
        " &\\Downarrow \\\\ \n",
        " \\mathbf{A}^{-1} &=\n",
        " \\begin{pmatrix}\n",
        "  -\\frac{1}{2} & -\\frac{2}{3} & -\\frac{1}{6} & \\phantom {-}\\frac{7}{6}\\\\ \n",
        "  \\phantom {-}1& \\phantom {-}\\frac{1}{3} &  \\phantom {-}\\frac{1}{3}  &-\\frac{4}{3}  \\\\ \n",
        " \\phantom {-}0& -\\frac{1}{3}&  -\\frac{1}{3}&  \\phantom {-}\\frac{1}{3}\\\\ \n",
        "  -\\frac{1}{2}& \\phantom {-}1 & \\phantom {-}\\frac{1}{2} & \\phantom {-}\\frac{1}{2}\n",
        "\\end{pmatrix} \n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**6.** $~$ Use Cramer's rule to determine the solution of the system\n",
        "\n",
        "$$\\begin{matrix}\n",
        " (2-k) x_1&  +  & kx_2 & = &4 \\\\ \n",
        " k x_1 & + & (3-k) x_2  & = &3 \n",
        "\\end{matrix}$$\n",
        "\n",
        "For what value(s) of $k$ is the system inconsistent?\n",
        "\n",
        "**Solution**\n",
        "\n",
        "$$\\begin{aligned}\n",
        " \\mathbf{A } &=\\begin{pmatrix}\n",
        "2-k & k \\\\ \n",
        "k & 3-k \n",
        "\\end{pmatrix},\\;\\;\\mathbf{b}=\\begin{pmatrix}\n",
        "4\\\\3\n",
        "\\end{pmatrix} \\\\ \n",
        " &\\Downarrow \\\\ \n",
        " \\left |  \\mathbf{A } \\right |&=\\begin{vmatrix}\n",
        "2-k & k \\\\ \n",
        "k & 3-k \n",
        "\\end{vmatrix}=-5k+6 \\\\ \n",
        " \\left |  \\mathbf{A }_1 \\right |&=\\begin{vmatrix}\n",
        "4 & k \\\\ \n",
        "3 & 3-k \n",
        "\\end{vmatrix}=-7k+12, \\;\\; \\left |  \\mathbf{A}_2 \\right |=\\begin{vmatrix}\n",
        "2-k & 4 \\\\ \n",
        "k & 3 \n",
        "\\end{vmatrix}=-7k+6 \\\\\n",
        " &\\Downarrow \\\\ \n",
        " x_1 &=\\frac{12-7k}{6-5k}, \\;\\;x_2=\\frac{6-7k}{6-5k} \\;\\;\\;\\;\\text{when}\\;\\;k\\neq\\frac{6}{5}\n",
        "\\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**7.** $~$ Simplify the following equations of quadric surfaces in three-dimensional space, and give the corresponding coordinate tranformations:\n",
        "\n",
        "$$x^2 -2y^2 +z^2 +6xy -2yz +8x +2y -12z -3 = 0$$\n",
        "\n",
        "**Solution** \n",
        "\n",
        "$$\\begin{aligned}\n",
        " \\mathbf{A }=\\begin{pmatrix}\n",
        " 1& \\phantom{-}3 &\\phantom{-}0 \\\\ \n",
        " 3& -2 &-1 \\\\ \n",
        " 0& -1 & \\phantom{-}1\n",
        "\\end{pmatrix}&, \\;   \\mathbf{x}=\\begin{pmatrix}\n",
        "x\\\\y \\\\z\n",
        "\\end{pmatrix} \\\\ \n",
        " &\\Downarrow \\\\\n",
        " \\mathbf{x}^T \\mathbf{A}\\mathbf{x} +&\\begin{pmatrix}\n",
        " 8 & 2 & -12 \n",
        "\\end{pmatrix}\\mathbf{x}=3 \\\\\n",
        " &\\Downarrow \\\\\n",
        "|\\mathbf{A} -\\lambda \\mathbf{I} | = 0 \\;\\; \\Rightarrow \\;\\; & \\lambda_1=-4, \\;\\lambda_2=1, \\;\\lambda_3=3 \\\\ \n",
        "\\lambda_1=-4 \\;\\;&\\rightarrow \\;\\; \\mathbf{k}_1 =\\frac{1}{\\sqrt{35}}  \\begin{pmatrix}\n",
        "-3\\\\\\phantom{-}5\\\\\\phantom{-}1 \\end{pmatrix}\\\\\n",
        "\\lambda_2=1 \\;\\;&\\rightarrow \\;\\; \\mathbf{k}_2 =\\frac{1}{\\sqrt{10}}  \\begin{pmatrix}\n",
        "1\\\\0\\\\3 \\end{pmatrix}\\\\\n",
        "\\lambda_3=3 \\;\\;&\\rightarrow \\;\\; \\mathbf{k}_3 =\\frac{1}{\\sqrt{14}}  \\begin{pmatrix}\n",
        "-3\\\\-2\\\\\\phantom{-}1 \\end{pmatrix}\\\\\n",
        " &\\Downarrow \\\\\n",
        "\\mathbf{P} =\\begin{pmatrix}\n",
        " \\mathbf{k}_1 &  \\mathbf{k}_2 &  \\mathbf{k}_3\n",
        "\\end{pmatrix} \\;\\; &\\Rightarrow \\;\\; \\mathbf{x} = \\mathbf{P}\\mathbf{y}\\\\\n",
        " &\\Downarrow \\\\ \n",
        "  \\mathbf{y}^T  \\mathbf{P}^T \\mathbf{A} \\mathbf{P} \\mathbf{y} & +\n",
        "  \\begin{pmatrix}\n",
        " 8 & 2 & -12 \n",
        "\\end{pmatrix} \\mathbf{P} \\mathbf{y} =3\\\\\n",
        "\\end{aligned}$$\n",
        "\n",
        "$$\\begin{aligned}\n",
        " &\\Downarrow \\\\ \n",
        " \\mathbf{y}^T \n",
        "\\begin{pmatrix}\n",
        " -4 &  \\phantom{-}0  &  \\phantom{-}0\\\\ \n",
        " \\phantom{-}0 &  \\phantom{-}1 &  \\phantom{-}0\\\\ \n",
        "  \\phantom{-}0 &  \\phantom{-}0 &  \\phantom{-}3 \n",
        "\\end{pmatrix}  \\mathbf{y} &-\n",
        "\\begin{pmatrix}\n",
        " \\frac{26}{\\sqrt{35}} & \\frac{28}{\\sqrt{10}} & \\frac{40}{\\sqrt{14}}\n",
        "\\end{pmatrix}  \\mathbf{y}= 3\\\\ \n",
        " &\\Downarrow \\\\ \n",
        "{\\scriptsize -4\\left( y_1 + \\frac{13}{4\\sqrt{35}} \\right )^2} \n",
        " &{\\scriptsize +\\left( y_2 - \\frac{14}{\\sqrt{10}} \\right )^2 +3 \\left( y_3 - \\frac{20}{3\\sqrt{14}} \\right )^2 =\\frac{2597}{84}} \\\\\n",
        " &\\Downarrow \\\\\n",
        "-\\frac{(y_1 +0.5494)^2}{2.7801^2} &+ \\frac{(y_2 -4.4272)^2}{5.5603^2} + \\frac{(y_3 -1.7817)^2}{3.2102^2} \\approx 1 \\\\\n",
        " &\\Downarrow \\\\\n",
        " \\mathbf{z} &=  \\mathbf{y} +\\begin{pmatrix}\n",
        "\\phantom{-}0.5494 \\\\ -4.4272 \\\\ -1.7817\n",
        "\\end{pmatrix} \\\\\n",
        " &\\Downarrow \\\\\n",
        "-\\frac{z_1^2}{2.7801^2} &+ \\frac{z_2^2}{5.5603^2} + \\frac{z_3^2}{3.2102^2} \\approx 1 \\\\\n",
        " &\\Downarrow \\\\\n",
        " \\mathbf{x} &= \\mathbf{P}\\left[\\mathbf{z} -\\begin{pmatrix}\n",
        "\\phantom{-}0.5494 \\\\ -4.4272 \\\\ -1.7817\n",
        "\\end{pmatrix} \\right]\n",
        " \\end{aligned}$$\n",
        "\n",
        "$~$\n",
        "\n",
        "**8.** $~$ Simplify the following equations of quadric surfaces in three-dimensional space, and give the corresponding coordinate tranformations:\n",
        "\n",
        "$$5x^2 + 6y^2 +7z^2 -4xy +4yz -10x +8y +14z -6=0$$\n",
        "\n",
        "**Solution**\n",
        "\n",
        "$$\\begin{aligned}\n",
        " \\mathbf{A }=\\begin{pmatrix}\n",
        " \\phantom{-}5 &-2 &\\phantom{-}0 \\\\ \n",
        "-2& \\phantom{-}6  &\\phantom{-}2 \\\\ \n",
        "  \\phantom{-}0& \\phantom{-}2  & \\phantom{-}7\n",
        "\\end{pmatrix}&, \\;   \\mathbf{x}=\\begin{pmatrix}\n",
        "x\\\\y \\\\z\n",
        "\\end{pmatrix} \\\\ \n",
        " &\\Downarrow \\\\\n",
        " \\mathbf{x}^T \\mathbf{A}\\mathbf{x} +&\\begin{pmatrix}\n",
        " -10 & 8 & 14 \n",
        "\\end{pmatrix}\\mathbf{x}=6 \\\\\n",
        " &\\Downarrow \\\\\n",
        "|\\mathbf{A} -\\lambda \\mathbf{I} | = 0 \\;\\; \\Rightarrow \\;\\; & \\lambda_1=3, \\;\\lambda_2=6, \\;\\lambda_3=9 \\\\ \n",
        "\\lambda_1=3 \\;\\;&\\rightarrow \\;\\; \\mathbf{k}_1 =\\frac{1}{3}  \\begin{pmatrix}\n",
        "\\phantom{-}2\\\\\\phantom{-}2\\\\-1 \\end{pmatrix}\\\\\n",
        "\\lambda_2=6 \\;\\;&\\rightarrow \\;\\; \\mathbf{k}_2 =\\frac{1}{3}  \\begin{pmatrix}\n",
        "\\phantom{-}2\\\\-1\\\\\\phantom{-}2 \\end{pmatrix}\\\\\n",
        "\\lambda_3=9 \\;\\;&\\rightarrow \\;\\; \\mathbf{k}_3 =\\frac{1}{3}  \\begin{pmatrix}\n",
        "-1 \\\\ \\phantom{-}2 \\\\ \\phantom{-}2 \\end{pmatrix}\\\\\n",
        " &\\Downarrow \\\\ \n",
        "\\mathbf{P} =\\begin{pmatrix}\n",
        " \\mathbf{k}_1 &  \\mathbf{k}_2 &  \\mathbf{k}_3\n",
        "\\end{pmatrix} \\;\\; &\\Rightarrow \\;\\; \\mathbf{x} = \\mathbf{P}\\mathbf{y} \n",
        "\\end{aligned}$$\n",
        "\n",
        "$$\n",
        "\\begin{aligned}\n",
        " &\\Downarrow \\\\ \n",
        " \\mathbf{y}^T \n",
        "\\begin{pmatrix}\n",
        " 3 & 0  & 0\\\\ \n",
        " 0 & 6 & 0\\\\ \n",
        " 0 & 0 & 9 \n",
        "\\end{pmatrix}  \\mathbf{y} &+\n",
        "\\begin{pmatrix}\n",
        " 6 &  0 & 18 \n",
        "\\end{pmatrix} \\mathbf{y} = 6\\\\ \n",
        " &\\Downarrow \\\\ \n",
        " 3(y_1^2 +2y_1 +1) +6y_2^2 &+9(y_3^2 +2y_3+1) =18 \\\\\n",
        " &\\Downarrow \\\\ \n",
        "\\frac{(y_1 +1)^2}{6} +\\frac{y_2^2}{3} &+\\frac{(y_3+1)^2}{2} = 1 \\\\\n",
        " &\\Downarrow \\\\\n",
        " \\mathbf{z} &=  \\mathbf{y} +\\begin{pmatrix}\n",
        "\\phantom{-} 1 \\\\ \\phantom{-} 0 \\\\ \\phantom{-} 1\n",
        "\\end{pmatrix} \\\\\n",
        " &\\Downarrow \\\\\n",
        "\\frac{z_1^2}{6} &+ \\frac{z_2^2}{3} + \\frac{z_3^2}{2} = 1 \\\\\n",
        " &\\Downarrow \\\\\n",
        " \\mathbf{x} &= \\mathbf{P}\\left[\\mathbf{z} -\\begin{pmatrix}\n",
        "\\phantom{-} 1 \\\\ \\phantom{-} 0 \\\\ \\phantom{-}1\n",
        "\\end{pmatrix} \\right]\n",
        "\\end{aligned}\n",
        "$$"
      ],
      "id": "7889d097"
    }
  ],
  "metadata": {
    "kernelspec": {
      "name": "python3",
      "language": "python",
      "display_name": "Python 3 (ipykernel)",
      "path": "/opt/miniconda3/share/jupyter/kernels/python3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}